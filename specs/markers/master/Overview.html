<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional+edit//EN" "xhtml1-transitional+edit.dtd">
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:edit="http://xmlns.grorg.org/SVGT12NG/">
<head>
  <title>SVG Markers</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
  <link rel="stylesheet" title="Default" type="text/css" href="style/default_svg.css"/>
  <link rel="alternate stylesheet" title="No issues/annotations" type="text/css" href="style/default_no_issues.css"/>
</head>
<body>

<div class="head">
  <p><a href="http://www.w3.org/"><img height="39" width="77" alt="W3C" src="http://www.w3.org/Icons/w3c_home"/></a></p>
  <h1 id="pagetitle">SVG Markers</h1>
  <h2 id="pagesubtitle">W3C <edit:maturity/> <em><edit:date/></em></h2>
  <dl>
    <dt>This version:</dt>
    <dd><edit:thisversion/></dd>
    <dt>Latest version:</dt>
    <dd><edit:latestversion/></dd>
    <edit:includelatesteditorsdraft/>
    <!--
    <dt>Previous version:</dt>
    <dd><edit:previousversion/></dd>
    -->
    <dt>GitHub repository:</dt>
    <dd><a href="https://github.com/w3c/svgwg/tree/main/specs/markers">https://github.com/w3c/svgwg/tree/main/specs/markers</a></dd>
    <dt>Feedback:</dt>
    <dd><a href="mailto:www-svg@w3.org" class='url'>www-svg@w3.org</a> with subject line “<code>[svg-markers] … <i>message topic</i> …</code>” (<a href="http://lists.w3.org/Archives/Public/www-svg/">archive</a>)</dd>
    <dt class="top-editors">Editor:</dt>
    <dd>Cameron McCormack, Mozilla Corporation &lt;<a href="mailto:cam@mcc.id.au" class='url'>cam@mcc.id.au</a>&gt;</dd>
  </dl>
  <edit:copyright/>
</div>

<hr/>

<h2 id="abstract">Abstract</h2>

<p>This specification defines SVG markers, a feature for placing re-usable
graphical elements along the outline of an SVG shape.</p>

<h2 id="status">Status of This Document</h2>

<p><em>This section describes the status of this document at the time of its
publication. Other documents may supersede this document. A list of current W3C
publications and the latest revision of this technical report can be found in
the <a href="http://www.w3.org/TR/">W3C technical reports index</a> at http://www.w3.org/TR/</em>.</p>

<p>This document is the <edit:date/> <strong><edit:maturity/></strong> of <edit:shorttitle/>.
The purpose of this specification is to define a number of improved SVG marker
features.</p>

<p class="note">This specification is an early draft that largely contains
features that were dropped during the development of SVG 2.
In the future, this specification will supercede the
<a href="https://www.w3.org/TR/SVG2/painting.html#Markers">SVG 2 Markers definition</a>,
however at this time the <a href="https://www.w3.org/TR/SVG2/painting.html#Markers">SVG 2 Markers definition</a>
must be considered the normative definition.</p>

<p>Comments on this <edit:maturity/> are welcome.
Comments can be sent to <a href="mailto:www-svg@w3.org" class='url'>www-svg@w3.org</a>,
the public email list for issues related to vector graphics on the Web. This list is
<a href="http://lists.w3.org/Archives/Public/www-svg/">archived</a> and
senders must agree to have their message publicly archived from their
first posting. To subscribe send an email to
<a href="mailto:www-svg-request@w3.org" class='url'>www-svg-request@w3.org</a> with
the word <code>subscribe</code> in the subject line.</p>

<p>This document has been produced by the
<a href="http://www.w3.org/Graphics/SVG/WG">W3C SVG Working Group</a> as part of
the <a href="http://www.w3.org/Graphics/Activity">Graphics Activity</a> within
the <a href="http://www.w3.org/Interaction/">W3C Interaction Domain</a>. The
goals of the W3C SVG Working Group are discussed in the
<a href="https://www.w3.org/Graphics/SVG/svg-2019.html">W3C SVG Charter</a>.
The W3C SVG Working Group maintains a public Web page,
<a href="http://www.w3.org/Graphics/SVG/" class='url'>http://www.w3.org/Graphics/SVG/</a>,
that contains further background information. The authors of
this document are the SVG Working Group participants.</p>

<p>This document was produced by a group operating under the
<a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 W3C Patent Policy</a>.
W3C maintains a <a rel="disclosure" href="http://www.w3.org/2004/01/pp-impl/19480/status">public list of any patent disclosures</a>
made in connection with the deliverables of the group; that page also includes
instructions for disclosing a patent. An individual who has actual knowledge of
a patent which the individual believes contains
<a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential Claim(s)</a>
must disclose the information in accordance with
<a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6 of the W3C Patent Policy</a>.</p>

<p>Publication as a <edit:maturity/> does not imply endorsement by the W3C Membership.
This is a draft document and may be updated, replaced or obsoleted by other documents
at any time. It is inappropriate to cite this document as other than work in progress.</p>

<p>A list of current W3C Recommendations and other technical documents can be found at
<a href="http://www.w3.org/TR/" class='url'>http://www.w3.org/TR/</a>. W3C publications
may be updated, replaced, or obsoleted by other documents at any time.</p>

<p>This document is governed by the
<a id="w3c_process_revision" href="http://www.w3.org/2014/Process-20140801/">1 August 2014 W3C Process Document</a>.</p>

<!--
<h2 id="feedback" edit:toc="no">How to read this document and give feedback</h2>

<p>This draft of SVG Integration introduces new normative prose for
integrating the SVG language into other markup languages. One of
the goals is that this specification can be re-used more easily by
other specifications that want to have well-defined interaction and
interoperability with SVG. Future drafts of this specification may
introduce syntax and markup for the SVG language that may not be
backwards compatible with older SVG User Agents, and the use of this
syntax should be accompanied by a fallback using the <a>'switch'</a>
element.</p>
-->

<nav id="toc">
  <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>

<edit:fulltoc/>
  <script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script>
</nav>

<h2 id="intro">Introduction</h2>

<p><em>This section is non-normative.</em></p>

<edit:with element='marker'>

<p>A <dfn id='TermMarker'>marker</dfn> is a graphical object that is painted at particular positions along
any <a>shape</a> element.</p>

<ul>
  <li>The <a>'marker-start'</a> and <a>'marker-end'</a> properties
  can be used to place markers at the first and last vertex, and the
  <a>'marker-mid'</a> property can be used to place markers at every
  other vertex (aside from the first and last).  The <a>'marker-start'</a> and
  <a>'marker-end'</a> can be used for example to add arrowheads to paths.
  Markers placed using these properties are known as
  <dfn id="TermVertexMarker">vertex markers</dfn>.</li>

  <li>The <a>'marker-segment'</a> property can be used to place markers
  at the center of every path segment.  These markers are known as
  <dfn id="TermSegmentMarker">segment markers</dfn>.</li>

  <li>The <a>'marker-pattern'</a> property can be used to define
  a regular repeating pattern of markers to place along the length of the
  path.  Markers placed with <a>'marker-pattern'</a> are known as
  <dfn id="TermRepeatingMarker">repeating markers</dfn>.</li>

  <li>A child <a>'marker element'</a> element with a <a>'position'</a> attribute
  can be used to place a marker at a particular location along the path.
  Such markers are known as <dfn id="TermPositionedMarker">positioned
  markers</dfn>.</li>
</ul>

<p>The graphics for a marker are defined by a <a>'marker element'</a> element.
The <a>'marker-start'</a>, <a>'marker-end'</a>, <a>'marker-mid'</a>,
<a>'marker-segment'</a> and <a>'marker-pattern'</a> properties, together known
as the <dfn id="TermMarkerProperties">marker properties</dfn>, reference
<a>'marker element'</a> elements.</p>

<p>Markers can be animated, and as with <a>'use'</a> elements, the animated
effects will show on all current uses of the markers within the document.</p>

<p>Markers on a given element are painted in the following order, from
bottom to top:</p>

<ul>
  <li>any marker specified by <a>'marker-start'</a></li>

  <li>alternating <a>'marker-mid'</a> and <a>'marker-segment'</a> markers,
  in order of their position along the path</li>

  <li>any <a>repeating markers</a>, in order of their position along
  the path</li>

  <li>any marker specified by <a>'marker-end'</a></li>

  <li>any <a>positioned markers</a>, in document order of the
  <a>'marker element'</a> element children</li>
</ul>

<h3 id="placement">Module interactions</h3>

<p>This module replaces and extends the definition of markers in
SVG 2 (the "Markers" section in the "Painting: Filling, Stroking and Marker Symbols"
chapter). <a href='#ref-SVG2'>[SVG2]</a></p>

<h2 id="MarkerElement">The <span class="element-name">'marker'</span> element</h2>

<edit:elementsummary name='marker'/>

<p>The <a>'marker element'</a> element defines the graphics that are to
be used for drawing markers on a <a>shape</a>.</p>

<p id="MarkerAttributes"><em>Attribute definitions:</em></p>

<dl class="attrdef-list">
  <dt>

<table class="propdef attrdef">
  <tr>
    <th>Name</th>
    <th>Value</th>
    <th>Initial value</th>
    <th>Animatable</th>
  </tr>
  <tr>
    <td><dfn id="MarkerUnitsAttribute">markerUnits</dfn></td>
    <td>strokeWidth | userSpaceOnUse</td>
    <td>strokeWidth</td>
    <td>yes</td>
  </tr>
</table>

</dt>
<dd>

<p>The <a>'markerUnits'</a> attribute defines the coordinate system for
attributes <a>'markerWidth'</a>, <a>'markerHeight'</a> and the
contents of the <a>'marker element'</a>.  Values have the
following meanings:</p>

<dl>
  <dt><span class="attr-value">strokeWidth</span></dt>
  <dd><a>'markerWidth'</a>, <a>'markerHeight'</a> and the contents
  of the <a>'marker element'</a> have values in a coordinate system
  which has a single unit equal to the size in user units of the
  current stroke width (see the <a>'stroke-width'</a> property) of
  the element referencing the marker.</dd>

  <dt><span class="attr-value">userSpaceOnUse</span></dt>
  <dd><a>'markerWidth'</a>, <a>'markerHeight'</a> and the contents
  of the <a>'marker element'</a> have values in the current
  user coordinate system in place for the element
  referencing the marker.</dd>
</dl>

</dd>
<dt>

<table class="propdef attrdef">
  <tr>
    <th>Name</th>
    <th>Value</th>
    <th>Initial value</th>
    <th>Animatable</th>
  </tr>
  <tr>
    <td><dfn id="MarkerWidthAttribute">markerWidth</dfn>,
    <dfn id="MarkerHeightAttribute">markerHeight</dfn></td>
    <td><a>&lt;length&gt;</a> | <a>&lt;percentage&gt;</a> | <a>&lt;number&gt;</a></td>
    <td>3</td>
    <td>yes</td>
  </tr>
</table>

</dt>
<dd>

<p>The <a>'markerWidth'</a> and <a>'markerHeight'</a> attributes
represent the size of the viewport into which the marker is to
be fitted according to the <a>'viewBox'</a> and <a>'preserveAspectRatio'</a>
attributes.  A value of zero for either
attribute results in nothing being rendered for the marker.  A negative value
for either attribute is an error (see
<a href="[SVG2]/implnote.html#ErrorProcessing">Error processing</a>).</p>

</dd>
<dt>

<table class="propdef attrdef">
  <tr>
    <th>Name</th>
    <th>Value</th>
    <th>Initial value</th>
    <th>Animatable</th>
  </tr>
  <tr>
    <td><dfn id="MarkerElementRefXAttribute">refX</dfn></td>
    <td><a>&lt;length&gt;</a> | <a>&lt;percentage&gt;</a> | <a>&lt;number&gt;</a> | left | center | right</td>
    <td>0</td>
    <td>yes</td>
  </tr>
  <tr>
    <td><dfn id="MarkerElementRefYAttribute">refY</dfn></td>
    <td><a>&lt;length&gt;</a> | <a>&lt;percentage&gt;</a> | <a>&lt;number&gt;</a> | top | center | bottom</td>
    <td>0</td>
    <td>yes</td>
  </tr>
</table>

</dt>
<dd>

    <p class="annotation">
      We will add top/center/bottom, left/center/right keywords to
      refX/refY on marker/symbol. Resolved at
      <a href="http://www.w3.org/2014/08/26-svg-minutes.html#item07">London
      F2F</a>. Values inspired by
      <a href="http://www.w3.org/TR/css3-background/#the-background-position">'background-position'</a>.
    </p>

<p>The <a>'refX'</a> and <a>'refY'</a> attributes define the reference
point of the marker, which is to be placed exactly at the marker's
position on the <a>shape</a>.  They are interpreted as being in the
coordinate system of the marker contents, after application of the
<a>'viewBox'</a> and <a>'preserveAspectRatio'</a> attributes.</p>

</dd>
<dt>

<table class="propdef attrdef">
  <tr>
    <th>Name</th>
    <th>Value</th>
    <th>Initial value</th>
    <th>Animatable</th>
  </tr>
  <tr>
    <td><dfn id="OrientAttribute">orient</dfn></td>
    <td>auto | auto-start-reverse | <a>&lt;angle&gt;</a> | <a>&lt;number&gt;</a></td>
    <td>0</td>
    <td>yes&#160;(non-additive)</td>
  </tr>
</table>

</dt>
<dd>

<p>The <a>'orient'</a> attribute indicates how the marker
is rotated when it is placed at its position on the <a>shape</a>.
Values have the following meaning:</p>

<dl>
  <dt><span class="attr-value">'auto'</span></dt>
  <dd>
    <p>The marker is oriented such that its positive x-axis
    is pointing in the direction of the path at the point it
    is placed.</p>

    <p>If the marker is a <a>segment marker</a>, then
    the direction the marker is oriented in is, if considering the
    incoming and outgoing directions as unit vectors, the
    direction of the sum of these two vectors.  If this sum
    is zero, then the marker is oriented in the incoming direction.</p>

    <p>If the marker is on the first or last vertex of a closed subpath, then the
    incoming direction taken from the final path segment and the outgoing
    direction is taken from:</p>

    <ul>
      <li>the first path segment of the <em>following</em> subpath,
      if the following subpath does not begin with a
      <a href="[SVG2]/paths.html#PathDataMovetoCommands">'moveto'</a> command, and</li>
      <li>the first path segment of the <em>current</em> subpath,
      if the following subpath does begin with a
      <a href="[SVG2]/paths.html#PathDataMovetoCommands">'moveto'</a> command
      or if there is no following subpath.</li>
    </ul>
  </dd>
</dl>

<dl class="ready-for-wider-review">
  <dt><span class="attr-value">'auto-start-reverse'</span></dt>
  <dd>
    <p>If placed by <a>'marker-start'</a>, the marker is oriented
    180° different from the orientation that would be used if
    <span class="attr-value">'auto'</span> where specified.  For
    all other markers, <span class="attr-value">'auto-start-reverse'</span>
    means the same as <span class="attr-value">'auto'</span>.</p>

    <p class="note">This allows a single arrowhead marker to be defined
    that can be used for both the start and end of a path, i.e. which points
    outwards from both ends.</p>
  </dd>
</dl>

<dl>
  <dt><span class="attr-value"><a>&lt;angle&gt;</a></span></dt>
  <dt><span class="attr-value"><a>&lt;number&gt;</a></span></dt>
  <dd>
    <p>The marker is oriented such that the specified angle is
    that measured between the <a>shape</a>'s positive x-axis
    and the marker's positive x-axis.  A <a>&lt;number&gt;</a> value
    specifies an angle in degrees.</p>
    <p class="note">For example, if a value of <span class="attr-value">'45'</span>
    is given, then the marker's positive x-axis would be pointing down and right
    in the <a>shape</a>'s coordinate system.</p>
  </dd>
</dl>

</dd>

<dt>
<table class="propdef attrdef">
  <tr>
    <th>Name</th>
    <th>Value</th>
    <th>Initial value</th>
    <th>Animatable</th>
  </tr>
  <tr>
    <td><dfn id="PositionAttribute">position</dfn></td>
    <td><a>&lt;length&gt;</a> | <a>&lt;percentage&gt;</a> | <a>&lt;number&gt;</a></td>
    <td>as&#160;if&#160;not&#160;specified</td>
    <td>yes</td>
  </tr>
</table>

</dt>
<dd>
<p>If the <a>'marker element'</a> element is a child of a <a>shape</a>,
then the presence of a <a>'position'</a> attribute indicates that the marker is
a <a>positioned marker</a> and that it will be painted at the specified
distance along the path.  If the value is negative or greater than the length
of the path, then no marker will be painted.  If this attribute is specified on
a <a>'marker element'</a> that is not a child of a <a>shape</a>, then
it has no effect beyond being exposed in the DOM.</p>

<p class="issue" data-issue="3">Should a negative or greater than path length value be
an "in error" / "unsupported" value?</p>

</dd>
<dt>

<table class="propdef attrdef">
  <tr>
    <th>Name</th>
    <th>Value</th>
    <th>Initial value</th>
    <th>Animatable</th>
  </tr>
  <tr>
    <td><dfn id="HrefAttribute">href</dfn></td>
    <td>URL <a href="[SVG2]/types.html#attribute-url" class="syntax">[URL]</a></td>
    <td>as&#160;if&#160;not&#160;specified</td>
    <td>yes</td>
  </tr>
</table>

</dt>
<dd>
<p>When a <a>'marker element'</a> element is being used as a <a>positioned marker</a>,
the <a>'href'</a> attribute indicates that the <a>'marker element'</a>
referenced by the attribute is to be used as the definition of the marker.  The
graphical content of the referencing <a>'marker element'</a> element and any of
its attributes that affect marker processing are ignored.  Authors must not
place any child graphical content in the referencing <a>'marker element'</a> or
specify the <a>'viewBox'</a>, <a>'preserveAspectRatio'</a>, <a>'refX'</a>,
<a>'refY'</a>, <a>'markerUnits'</a>, <a>'markerWidth'</a>, <a>'markerHeight'</a>
or <a>'orient'</a> attributes on it.</p>

<p class="issue" data-issue="4">We should say something about referencing <a>'marker element'</a>
elements that have an <a>'href'</a> with the <a>marker properties</a>.
I suspect we should just allow this.  Whether we want to allow the full
element-referencing thing that you can do with gradients, with selective
overriding of attributes, I'm not sure.</p>

</dd>
</dl>

<!--
<style>
hr.break { border: none; margin: 2em 0 }
hr.break:before { display: block; text-align: center; content: "*\a0\a0\a0\a0*\a0\a0\a0\a0*"; }
</style>
<hr class="break"/>
-->

<p>The contents of the <a>'marker element'</a> are relative to a new
coordinate system. The <a>'markerUnits'</a> attribute determines an initial
scale factor for transforming the graphics in the marker into the user
coordinate system for the referencing element. An additional set of
transformations might occur if there is a <a>'viewBox'</a> attribute, in
which case the coordinate system for the contents of the <a>'marker element'</a>
will be transformed due to the processing of attributes <a>'viewBox'</a>
and <a>'preserveAspectRatio'</a>. If there is no <a>'viewBox'</a>
attribute, then the assumed default value for the <a>'viewBox'</a>
attribute has the origin of the viewBox coincident with the origin
of the viewport and the width/height of the viewBox the same as the
width/height of the viewport.</p>

<p>The <a href="[SVG2]/styling.html#UAStyleSheet">user agent style sheet</a> sets
the <a>'overflow'</a> property for <a>'marker element'</a> elements to
<span class="prop-value">hidden</span>, which causes a rectangular clipping
path to be created at the bounds of marker's viewport.  Unless the
<a>'overflow'</a> property is overridden, any graphics within the marker which
goes outside of the marker's viewport will be clipped.</p>

<p><a>Properties</a> inherit into the
<a>'marker element'</a> element from its ancestors; properties do <em>not</em>
inherit from the element referencing the <a>'marker element'</a> element.
<span class="ready-for-wider-review">Note however that by using the <span class="prop-value">context-stroke</span>
value for the <a>'fill'</a> or <a>'stroke'</a> on elements in its definition,
a single marker can be designed to match the style of the element referencing
the marker.</span></p>

<p><a>'marker element'</a> elements are only rendered directly
when they are used as children of a <a>shape</a>
and have a <a>'position'</a> attribute specified.  This causes the
marker to be painted as a <a>positioned marker</a>.  All other
<a>'marker element'</a> elements are not rendered directly
and must be referenced by one of the <a>marker properties</a>
to be rendered.  The <a>'display'</a> property does not apply to the
<a>'marker element'</a> element; thus, <a>'marker element'</a> elements are not
directly rendered even if the <a>'display'</a> property is
set to a value other than <span class="prop-value">none</span>, and
<a>'marker element'</a> elements are available for referencing even when the
<a>'display'</a> property on the <a>'marker element'</a> element or any of its
ancestors is set to <span class="prop-value">none</span>.  <a>'marker element'</a>
elements that are used as <a>positioned markers</a> can simultaneously be referenced
by the <a href='#TermMarkerProperties'>marker properties</a> to be used as
<a>segment markers</a> and <a>repeating markers</a>.</p>

<p><a href="[SVG2]/interact.html#EventAttributes">Event attributes</a> and
<a href="[SVG2]/svgdom.html#EventListeners">event listeners</a> attached
to the contents of a <a>'marker element'</a> element are not processed;
only the rendering aspects of <a>'marker element'</a> elements are
processed.</p>

<p class="issue" data-issue="5">Make interaction work on <a>positioned markers</a>.</p>

<p class="issue" data-issue="12">Interaction on child markers and the shape could be affected by <a>'paint-order'</a>.</p>

<p class="issue" data-issue="13">Should there be a way of addressing in <a>'paint-order'</a> the individual types
of markers – vertex &amp; segment, repeating, positioned – given they are currently
specified to render in that order?</p>

<div class="example">
  <p>The following example shows the use of <a>positioned markers</a> to
  place symbols at particular distances along a path.</p>

  <pre><![CDATA[
<svg xmlns="http://www.w3.org/2000/svg"
     width="600" height="200" viewBox="0 0 600 200">

   <defs>
     <marker id="Square" markerWidth="10" markerHeight="10"
             refX="5" refY="5" orient="auto">
       <path d="M 5,1 L 9,5 5,9 1,5 z" fill="#6a9100"/>
     </marker>
     <marker id="Circle" markerWidth="10" markerHeight="10"
             refX="5" refY="5" orient="auto">
       <circle cx="5" cy="5" r="2" fill="dodgerblue"/>
     </marker>
   </defs>

   <path d="M 100,50 C 100,250 500,-50 300,150"
         fill="none" stroke="deeppink" stroke-width="3">
     <marker href="#Square" position="0"/>
     <marker href="#Square" position="100%"/>
     <marker href="#Circle" position="50px"/>
     <marker href="#Circle" position="calc(100% - 50px)"/>
     <marker refX="5" refY="5" position="50%">
       <!-- the cross -->
       <path d="M 3,3 L 7,7 M 3,7 L 7,3"
             fill="none" stroke="black" stroke-width="2"/>
     </marker>
   </path>
</svg>
]]></pre>

  <div class="figure">
    <img class="bordered" src="images/markers-positioned.svg"
         alt="Image showing the use of positioned markers."/>
    <p class="caption">Child <a>'marker element'</a> elements are used to position
    two square and two circular markers.  The cross marker is defined inline
    and does not need an ID.</p>
  </div>
</div>

<h2 id="MarkerReferences">Referencing <span class="element-name">'marker'</span> elements</h2>

<p>A number of marker properties allow specifying a <a>'marker element'</a> using a <a>&lt;marker-ref&gt;</a> value.</p>

<div class="definition">
  <dfn id="DataTypeMarkerRef">&lt;marker-ref&gt;</dfn> =<br/>
  <div style="margin-left: 2em">
    <a>&lt;url&gt;</a> |<br/>
    child |<br/>
    <a>&lt;child-selector&gt;</a>
  </div>
</div>

<p>where:</p>

<div class="definition">
  <dfn id="DataTypeChildSelector">&lt;child-selector&gt;</dfn> =
  <div style="margin-left: 4em">select(<a>compound selector</a>#)</div>
</div>

<p>Values have the following meaning</p>

<dl>
  <dt><span class='prop-value'>&lt;url&gt;</span></dt>
  <dd>Indicates that the <a>'marker element'</a> element referenced
  by the <a>&lt;url&gt;</a> value will be used.
  If the <a href="[SVG2]/linking.html#URLReference">URL reference</a> is not valid
  (e.g., it points to an object that is undefined or the object is not
  a <a>'marker element'</a> element), then the marker reference is also not
  valid.</dd>

  <dt><span class='prop-value'>child</span></dt>
  <dd>Indicates that the last child <a>'marker element'</a> element of the
  element where the property is specified will be used.
  If there is no such element, then the reference is not valid.</dd>

  <dt><span class='prop-value'>&lt;child-selector&gt;</span></dt>
  <dd>Indicates that the first matching descendent <a>'marker element'</a>
  specified by the <a>&lt;child-selector&gt;</a>, applied in the context of the
  element where the property is specified, will be used.
  If no element matches any of the selectors contained in the
  <a>&lt;child-selector&gt;</a>, or the first match is not a <a>'marker
  element'</a>, then the reference is not valid.</dd>
</dl>

<h2 id="VertexMarkerProperties">Vertex markers: the <span class="property">'marker-start'</span>,
<span class="property">'marker-mid'</span> and <span class="property">'marker-end'</span>
properties</h2>

<table class="propdef">
  <tr>
    <th>Name:</th>
    <td><dfn id="MarkerStartProperty">marker-start</dfn>,
        <dfn id="MarkerMidProperty">marker-mid</dfn>,
        <dfn id="MarkerEndProperty">marker-end</dfn></td>
  </tr>
  <tr>
    <th>Value:</th>
    <td>none | <a>&lt;marker-ref&gt;</a></td>
  </tr>
  <tr>
    <th>Initial:</th>
    <td>none</td>
  </tr>
  <tr>
    <th>Applies to:</th>
    <td><a>shape</a> elements</td>
  </tr>
  <tr>
    <th>Inherited:</th>
    <td>yes</td>
  </tr>
  <tr>
    <th>Percentages:</th>
    <td>N/A</td>
  </tr>
  <tr>
    <th>Media:</th>
    <td>visual</td>
  </tr>
  <tr>
    <th>Computed&#160;value:</th>
    <td>as specified, but with <a>&lt;url&gt;</a> values (that are part of
    a <a>&lt;marker-ref&gt;</a>) made absolute</td>
  </tr>
  <tr>
    <th><a>Animatable</a>:</th>
    <td>yes</td>
  </tr>
</table>

<p>The <a>'marker-start'</a> and <a>'marker-end'</a> properties are used
to specify the marker that will be drawn at the first and last vertices
of the given <a>shape</a>, respectively.  <a>'marker-mid'</a>
is used to specify the marker that will be drawn at all other vertices
(i.e., every vertex except the first and last).
Possible values for <a>'marker-start'</a>, <a>'marker-mid'</a> and
<a>'marker-end'</a> are:</p>

<dl>
  <dt><span class='prop-value'>none</span></dt>
  <dd>Indicates that no marker symbol will be drawn at the given
  vertex or vertices.</dd>

  <dt><span class='prop-value'>&lt;marker-ref&gt;</span></dt>
  <dd>Indicates that the <a>'marker element'</a> element referenced
  by the <a>&lt;marker-ref&gt;</a> value will be drawn at the given vertex or
  vertices.
  If the reference is not valid, then no marker will be drawn at the given
  vertex or vertices.</dd>
</dl>

<p>For <a>'polygon'</a> elements, the last vertex is the same as the first
vertex, and for <a>'path'</a> elements that end with a closed subpath, the last
vertex is the same as the first vertex of that final subpath.
In this case, if the value of <a>'marker-end'</a> is not
<span class="prop-value">none</span>, then it is possible that two markers
will be rendered on that final vertex.</p>

<p class="note">Note that <a>'marker-start'</a> and <a>'marker-end'</a>
refer to the first and last vertex of the entire path, not each subpath.</p>

<div class="ready-for-wider-review">
<div class="example">
  <p>The following example shows a triangular marker symbol used as a
  <a>vertex marker</a> to form an arrowhead at the end of two paths.</p>

  <edit:includefile href='images/marker.svg'/>

  <div class="figure">
    <img class="bordered" src="images/marker-rendering.svg"
         alt="Image showing the use of an automatically oriented marker."/>
    <p class="caption">The triangle is placed at the end of the path and
    oriented automatically so that it points in the right direction.
    The use of <span class="prop-value">context-stroke</span> ensures
    the fill of the triangle matches the stroke of each <a>'path'</a>.</p>
  </div>
</div>
</div>

<h2 id="SegmentMarkers">Segment markers: the <span class="property">'marker-segment'</span>
property</h2>

<table class="propdef">
  <tr>
    <th>Name:</th>
    <td><dfn id="MarkerSegmentProperty">marker-segment</dfn></td>
  </tr>
  <tr>
    <th>Value:</th>
    <td>none | <a>&lt;marker-ref&gt;</a></td>
  </tr>
  <tr>
    <th>Initial:</th>
    <td>none</td>
  </tr>
  <tr>
    <th>Applies to:</th>
    <td><a>shape</a> elements</td>
  </tr>
  <tr>
    <th>Inherited:</th>
    <td>yes</td>
  </tr>
  <tr>
    <th>Percentages:</th>
    <td>N/A</td>
  </tr>
  <tr>
    <th>Media:</th>
    <td>visual</td>
  </tr>
  <tr>
    <th>Computed&#160;value:</th>
    <td>as specified, but with <a>&lt;url&gt;</a> values (that are part of
    a <a>&lt;marker-ref&gt;</a>) made absolute</td>
  </tr>
  <tr>
    <th><a>Animatable</a>:</th>
    <td>yes</td>
  </tr>
</table>

<p class="note">This is a new feature, which allows markers symbols to
be placed at the center of path edges, as is common in for example
line graphs.</p>

<p>The <a>'marker-segment'</a> property is used to specify the marker that will
be drawn at the center of each length path segment.  Possible values
are:</p>

<dl>
  <dt><span class='prop-value'>none</span></dt>
  <dd>Indicates that no marker symbol will be drawn at the given
  vertex or vertices.</dd>

  <dt><span class='prop-value'>&lt;marker-ref&gt;</span></dt>
  <dd>Indicates that the <a>'marker element'</a> element referenced
  by the <a>&lt;marker-ref&gt;</a> value will be drawn at the center
  of each path segment.
  If the reference is not valid, then no marker will be drawn at the path
  segment centers.</dd>
</dl>

<div class="example">
  <p>The following example shows the use of both <a>vertex markers</a> and
  <a>segment markers</a> to construct a line graph.</p>

  <pre><![CDATA[
<svg xmlns="http://www.w3.org/2000/svg" width="400" height="200">

  <marker id="Circle" markerWidth="8" markerHeight="8" refX="4" refY="4"
          markerUnits="userSpaceOnUse">
    <circle cx="4" cy="4" r="3" fill="deeppink"/>
  </marker>

  <marker id="Cross" markerWidth="10" markerHeight="10" refX="0" refY="0"
          viewBox="-5 -5 10 10" markerUnits="userSpaceOnUse"
          fill="none">
    <path d="M -4,-4 L 4,4 M -4,4 L 4,-4" stroke="white" stroke-width="4"/>
    <path d="M -4,-4 L 4,4 M -4,4 L 4,-4" stroke="black" stroke-width="2"/>
  </marker>

  <!-- grid lines -->
  <path stroke="#888" d="M 40,20 360,20 M 40,40 360,40 M 40,60 360,60
                         M 40,80 360,80 M 40,100 360,100 M 40,120 360,120
                         M 40,140 360,140 M 40,160 360,160 M 40,180 360,180"/>

  <!-- the graph line -->
  <polyline points="50,100 100,20 150,50 200,130 250,80 300,170 350,100"
            fill="none" stroke="deeppink" stroke-width="2"
            marker="url(#Circle)" marker-segment="url(#Cross)"/>
</svg>
]]></pre>

  <div class="figure">
    <img class="bordered" src="images/markers-segment.svg"
         alt="Image showing the use of segment markers."/>
    <p class="caption">Segment markers are used to place crosses at the center
    of each line segment in the line graph.</p>
  </div>
</div>

<h2 id="RepeatingMarkers">Repeating markers: the <span class="property">'marker-pattern'</span>
property</h2>

<table class="propdef">
  <tr>
    <th>Name:</th>
    <td><dfn id="MarkerPatternProperty">marker-pattern</dfn></td>
  </tr>
  <tr>
    <th>Value:</th>
    <td><a>&lt;marker-gap&gt;</a>? <a>&lt;marker-ref-group&gt;</a> [ <a>&lt;marker-gap&gt;</a> <a>&lt;marker-ref-group&gt;</a> ]* <a>&lt;marker-gap&gt;</a>?</td>
  </tr>
  <tr>
    <th>Initial:</th>
    <td>none</td>
  </tr>
  <tr>
    <th>Applies to:</th>
    <td><a>shape</a> elements</td>
  </tr>
  <tr>
    <th>Inherited:</th>
    <td>yes</td>
  </tr>
  <tr>
    <th>Percentages:</th>
    <td>refer to the length of the path</td>
  </tr>
  <tr>
    <th>Media:</th>
    <td>visual</td>
  </tr>
  <tr>
    <th>Computed&#160;value:</th>
    <td>as specified, but with <a>&lt;url&gt;</a> values (that are part of
    a <a>&lt;marker-ref&gt;</a>) made absolute</td>
  </tr>
  <tr>
    <th><a>Animatable</a>:</th>
    <td>yes</td>
  </tr>
</table>

<p>where:</p>

<div class="definition">
  <dfn id="DataTypeMarkerGap">&lt;marker-gap&gt;</dfn> =
  <div style="margin-left: 4em"><a>&lt;length&gt;</a> | <a>&lt;percentage&gt;</a> | <a>&lt;number&gt;</a></div>
</div>

<div class="definition">
  <dfn id="DataTypeMarkerRefGroup">&lt;marker-ref-group&gt;</dfn> =
  <div style="margin-left: 4em">none | <a>&lt;marker-ref&gt;</a>+</div>
</div>

<p class="note">This is a new feature, which allows markers to be
placed at positions unrelated to the segments used to form the path.</p>

<p>The <a>'marker-pattern'</a> property is used to specify a pattern
of markers and gaps to be repeated along the length of the <a>shape</a>.
Values have the following meanings:</p>

<dl>
  <dt><span class="prop-value">none</span></dt>
  <dd>Indicates that no marker will be painted at the current
  position along the path.</dd>

  <dt><span class="prop-value"><a>&lt;marker-gap&gt;</a></span></dt>
  <dd>Indicates the length of a gap in the repeated
  pattern of markers.</dd>

  <dt><span class="prop-value"><a>&lt;marker-ref&gt;</a></span></dt>
  <dd>A reference to a <a>'marker element'</a> that will be placed at the
  current position along the path.  If the reference is not valid, then no
  marker for that <a>&lt;marker-ref&gt;</a> will be painted.</dd>
</dl>

<p>If a value other than <span class="prop-value">none</span> is given,
and the sum of the <a>&lt;length&gt;</a>s, <a>&lt;percentage&gt;</a>s
and <a>&lt;number&gt;</a>s is not positive, then it is an <a>invalid value</a>.</p>

<p>Unlike <a>vertex markers</a>, the orientation of an <span class="attr-value">orient="auto"</span>
<a>repeating marker</a> that happens to lie on a vertex does not take into
account the incoming and outgoing directions.  Instead, it is simply oriented
such that its positive x-axis is aligned with the direction of the path
at its position.</p>

<div class="example">
  <p>The following example shows the use of the <a>'marker-pattern'</a> property
  to specify a repeating pattern of two different markers spaced along a
  path.</p>

  <pre><![CDATA[
<svg xmlns="http://www.w3.org/2000/svg" width="600" height="200">

  <marker id="DoubleDash" markerWidth="8" markerHeight="12" refX="0" refY="0"
          viewBox="-4 -6 8 12" markerUnits="userSpaceOnUse" orient="auto">
    <rect x="-3" y="-5" width="2" height="10"/>
    <rect x="1" y="-5" width="2" height="10"/>
  </marker>
  <marker id="SingleDash" markerWidth="4" markerHeight="12" refX="0" refY="0"
          viewBox="-2 -6 4 12" markerUnits="userSpaceOnUse" orient="auto">
    <rect x="-1" y="-5" width="2" height="10"/>
  </marker>

  <path d="M 50,100 S 100,132 150,86 200,173 250,76 300,81
                      350,136 400,87 450,166 500,87 550,96"
        stroke="deeppink" stroke-width="2" fill="none"
        marker-pattern="40 url(#DoubleDash) 40 url(#SingleDash)"/>
</svg>
]]></pre>

  <div class="figure">
    <img class="bordered" src="images/markers-repeating.svg"
         alt="Image showing the use of repeating markers."/>
    <p class="caption">Markers specified with the <a>'marker-pattern'</a> property
    are placed along the path at fixed distances, not relative to the path
    vertices.</p>
  </div>
</div>

<h2 id="MarkerShorthand">Marker shorthand: the <span class="property">'marker'</span>
property</h2>

<table class="propdef">
  <tr>
    <th>Name:</th>
    <td><dfn id="MarkerProperty">marker</dfn></td>
  </tr>
  <tr>
    <th>Value:</th>
    <td style="white-space: nowrap">
      <div>
        [ none | <a>&lt;marker-ref&gt;</a> ]{1,4}
        [ / <a class="property" href="#MarkerPatternProperty">&lt;‘marker-pattern’&gt;</a> ]?
      </div>
      <div style="margin-left: 2em">
        | <a>&lt;marker-ref&gt;</a>{0,4} [ <a>&lt;length&gt;</a> | <a>&lt;percentage&gt;</a> | <a>&lt;number&gt;</a> ] [ <a>&lt;length&gt;</a> | <a>&lt;percentage&gt;</a> | <a>&lt;number&gt;</a> | <a>&lt;marker-ref&gt;</a> ]*
      </div>
    </td>
  </tr>
  <tr>
    <th>Initial:</th>
    <td>not defined for shorthand properties</td>
  </tr>
  <tr>
    <th>Applies to:</th>
    <td><a>shape</a> elements</td>
  </tr>
  <tr>
    <th>Inherited:</th>
    <td>yes</td>
  </tr>
  <tr>
    <th>Percentages:</th>
    <td>N/A</td>
  </tr>
  <tr>
    <th>Media:</th>
    <td>visual</td>
  </tr>
  <tr>
    <th>Computed&#160;value:</th>
    <td>see individual properties</td>
  </tr>
  <tr>
    <th><a>Animatable</a>:</th>
    <td>yes</td>
  </tr>
</table>

<p>The <a>'marker property'</a> property sets values for the
<a>'marker-start'</a>, <a>'marker-mid'</a>, <a>'marker-end'</a>,
<a>'marker-segment'</a> and <a>'marker-pattern'</a> properties.
Values for have the following meanings:</p>

<dl>
  <dt><span class="prop-value">none | <a>&lt;marker-ref&gt;</a></span></dt>
  <dd>Sets <a>'marker-start'</a>, <a>'marker-mid'</a> and <a>'marker-end'</a>
  to the specified value, and sets <a>'marker-segment'</a> and
  <a>'marker-pattern'</a> to <span class="prop-value">none</span>.</dd>

  <dt><span class="prop-value">[ none | <a>&lt;marker-ref&gt;</a> ]{2}</span></dt>
  <dd>Sets <a>'marker-start'</a> and <a>'marker-end'</a> to the two
  values specified, and sets <a>'marker-mid'</a>, <a>'marker-segment'</a> and
  <a>'marker-pattern'</a> to <span class="prop-value">none</span>.</dd>

  <dt><span class="prop-value">[ none | <a>&lt;marker-ref&gt;</a> ]{3}</span></dt>
  <dd>Sets <a>'marker-start'</a>, <a>'marker-mid'</a> and <a>'marker-end'</a> to
  the three values specified, and sets <a>'marker-segment'</a> and
  <a>'marker-pattern'</a> to <span class="prop-value">none</span>.</dd>

  <dt><span class="prop-value">[ none | <a>&lt;marker-ref&gt;</a> ]{4}</span></dt>
  <dd>Sets <a>'marker-start'</a>, <a>'marker-segment'</a>, <a>'marker-mid'</a>
  and <a>'marker-end'</a> to the four <a>&lt;marker-ref&gt;</a> values
  specified, and sets <a>'marker-pattern'</a> to
  <span class="prop-value">none</span>.</dd>

  <dt><span class="prop-value">[ none | <a>&lt;marker-ref&gt;</a> ]{1,4} / <a class="property" href="#MarkerPatternProperty">&lt;‘marker-pattern’&gt;</a></span></dt>
  <dd>Sets <a>'marker-start'</a>, <a>'marker-segment'</a>, <a>'marker-mid'</a>
  and <a>'marker-end'</a> to the four <a>&lt;marker-ref&gt;</a> values
  specified before the slash, and sets <a>'marker-pattern'</a> to
  the value after the slash.</dd>

  <dt>anything else</dt>
  <dd>Sets <a>'marker-start'</a>, <a>'marker-segment'</a>, <a>'marker-mid'</a>
  and <a>'marker-end'</a> to <span class="prop-value">none</span>,
  and sets <a>'marker-pattern'</a> to the specified value.</dd>
</dl>

<h2 id="MarkerKnockout">Knocking out the stroke: the
<span class="property">'marker-knockout-left'</span> and
<span class="property">'marker-knockout-right'</span> properties</h2>

<p class="issue" data-issue="6">The marker knockout properties are still under heavy development
and are subject to change. Feedback on how authors might prefer to specify marker
knockout shapes is welcome.</p>

<table class="propdef">
  <tr>
    <th>Name:</th>
    <td><dfn id="MarkerKnockoutLeftProperty">marker-knockout-left</dfn>, <dfn id="MarkerKnockoutRightProperty">marker-knockout-right</dfn></td>
  </tr>
  <tr>
    <th>Value:</th>
    <td><a>&lt;knockout-offset&gt;</a> | <a>&lt;knockout-shape&gt;</a> [ at <a>&lt;knockout-offset&gt;</a> ]?</td>
  </tr>
  <tr>
    <th>Initial:</th>
    <td>0</td>
  </tr>
  <tr>
    <th>Applies to:</th>
    <td><a>'marker element'</a></td>
  </tr>
  <tr>
    <th>Inherited:</th>
    <td>no</td>
  </tr>
  <tr>
    <th>Percentages:</th>
    <td>see prose</td>
  </tr>
  <tr>
    <th>Media:</th>
    <td>visual</td>
  </tr>
  <tr>
    <th>Computed&#160;value:</th>
    <td>as specified</td>
  </tr>
  <tr>
    <th><a>Animatable</a>:</th>
    <td>yes</td>
  </tr>
</table>

<p>where:</p>

<div class="definition">
  <dfn id="DataTypeKnockoutOffset">&lt;knockout-offset&gt;</dfn> =
  <div style="margin-left: 4em">[ <a>&lt;length&gt;</a> | <a>&lt;percentage&gt;</a> | <a>&lt;number&gt;</a> ]</div>
</div>

<div class="definition">
  <dfn id="DataTypeKnockoutShape">&lt;knockout-shape&gt;</dfn> =
  <div style="margin-left: 4em">[ <a>&lt;length&gt;</a> | <a>&lt;percentage&gt;</a> | <a>&lt;number&gt;</a> ] inverted? circle |</div>
  <div style="margin-left: 4em">[ <a>&lt;length&gt;</a> | <a>&lt;percentage&gt;</a> | <a>&lt;number&gt;</a> ]{2} inverted? ellipse |</div>
  <div style="margin-left: 4em">[ <a>&lt;length&gt;</a> | <a>&lt;percentage&gt;</a> | <a>&lt;number&gt;</a> ]{1,2} inverted? [ rectangle | triangle ]</div>
</div>

<p class="note">This is a new feature, which allows authors to specify
parts of a stroke that should be clipped away when a marker is
placed on a path.  This helps with arrowheads, where the stroke
must not be visible behind the pointy end, and with hollow markers
as seen in metro maps, where the center of a marker is transparent
and the stroke should not show through.</p>

<p>When specified on a <a>'marker element'</a> element, the
<a>'marker-knockout-left'</a> and <a>'marker-knockout-right'</a> properties
together specify a shape to clip away when when painting the stroke of an
element that uses the marker.  <a>'marker-knockout-left'</a> specifies the
left side of the shape and <a>'marker-knockout-right'</a> the right side.
These two sides are joined together with straight lines.</p>

<p>The <a>&lt;knockout-offset&gt;</a> part of the value, if specified,
is the offset from the marker position, outwards, along the tangent,
that the knockout shape side is placed at.  This is the <em>knockout shape
side position</em>.  If it is omitted, then the offset is assumed to be zero.
The value can be negative.  Percentage values refer to the width of the marker
contents viewport.</p>

<p>The <a>&lt;knockout-shape&gt;</a> part of the value, if specified,
is the left or right side of the knockout shape.  Values have the
following meanings:</p>

<dl>
  <dt><span class="prop-value">[ <a>&lt;length&gt;</a> | <a>&lt;percentage&gt;</a> | <a>&lt;number&gt;</a> ]{2} inverted? ellipse</span></dt>
  <dd>
    <p>The knockout shape side is an arc.  The lengths or percentages specified
    are the x-radius and y-radius of the ellipse from which the arc is taken.
    A length is interpreted as being in the marker contents coordinate system.
    If the first value is a percentage, then it refers to the width of the
    marker contents viewport, and if the second value is a percentage then
    it refers to the height of the marker contents viewport.</p>

    <p>If the <span class="prop-value">inverted</span> keyword is not specified,
    then the arc is constructed by placing the center of the ellipse at the knockout
    shape side position.  First we consider only the 180° arc of the ellipse which
    points in the direction of the start of the start of the path, if this is
    the left knockout shape side, or the end of the path if this is the right knockout
    shape side.  If the y-radius is less than or equal to half of the stroke width of
    the path the marker is on, then this 180° arc is the final knockout shape side.
    Otherwise, we intersect the arc with the two lines that are offset, by half
    of the stroke width, from the tangent to the marker orientation.
    The resulting arc with its start and end points on these two lines is the
    final knockout shape side.</p>

    <p>If the <span class="prop-value">inverted</span> keyword <em>is</em> specified,
    then the arc is constructed by placing the center of the ellipse at a distance
    of two times its x-radius along the tangent to the marker orientation,
    in the direction of the start of the path if this is the left knockout shape
    side, or the end of the path if this is the right knockout shape side.
    We consider only the 180° arc of the ellipse that is pointing in the opposite
    direction.  If the y-radius is less or equal to half of the stroke width
    of the path the marker is on, then this 180° arc is the final knockout shape
    side.  Otherwise, we intersect the arc with the two lines that are offset,
    by half of the stroke width, from the tangent to the marker orientation.
    The resulting arc with its side and end points on these two lines
    is the final knockout shape side.</p>
  </dd>

  <dt><span class="prop-value">[ <a>&lt;length&gt;</a> | <a>&lt;percentage&gt;</a> | <a>&lt;number&gt;</a> ] inverted? circle</span></dt>
  <dd>
    <p>The knockout shape side is an arc.  The shape is computed in the same
    way as the <span class="prop-value">ellipse</span> shape, but with
    both radii of the ellipse being the specified length or percentage,
    and with a percentage referring to the size of the marker contents viewport.</p>
  </dd>

  <dt><span class="prop-value">[ <a>&lt;length&gt;</a> | <a>&lt;percentage&gt;</a> | <a>&lt;number&gt;</a> ]{1,2} inverted? rectangle</span></dt>
  <dd>
    <p>The knockout shape side comprises one or two rectangles.  These
    rectangles are aligned such that their top and bottom edges are
    parallel to the tangent to the marker orientation.
    The length or percentage is a width and the second, if specified,
    is a height.  Percentage values here refer to the width and height
    of the marker contents viewport, respectively.</p>

    <p>If the <span class="prop-value">inverted</span> keyword is not specified,
    then the knockout shape side is a single rectangle.  The width of the
    rectangle is the specified width value.  The height of the rectangle is the maximum
    of the stroke width of the path on which the marker exists and the specified
    height value, if it is specified.  If it is not specified, then the height of the
    rectangle is just the stroke width.
    The rectangle is posisioned such that the center of its right hand edge
    is positioned at the knockout shape side position
    and the extent of its width is in the direction of the start of the path,
    if this is the left knockout shape side, or the end of the path if this
    is the right knockout shape side.</p>

    <p>If the <span class="prop-value">inverted</span> keyword is specified,
    then the knockout shape side comprises two rectangles.  If the specified
    height is greater than or equal to the stroke width, then the height
    of these rectangles is zero; otherwise, their heights are half of the
    difference between the stroke width and the specified height.  The
    top edge of one of the rectangles is half of the stroke width away
    from the marker orientation tangent line, with its bottom edge closer to the tangent line.
    The other rectangle has its bottom edge half of the stroke width
    away from the tangent line and its top edge closer to the tangent line.
    The right edges of the rectangles are aligned with each other and
    also with the line perpendicular to the marker orientation tangent line.
    The extent of the widths of the rectangles is in the direction
    of the start of the path, if this is the left knockout shape side,
    or the end of the path if this is the right knockout shape side.</p>
  </dd>

  <dt><span class="prop-value">[ <a>&lt;length&gt;</a> | <a>&lt;percentage&gt;</a> | <a>&lt;number&gt;</a> ]{1,2} inverted? rectangle</span></dt>
  <dd>
    <p>The knockout shape side comprises one or two rectangles.  These
    rectangles are aligned such that their top and bottom edges are
    parallel to the tangent to the marker orientation.
    The length or percentage is a width and the second, if specified,
    is a height.  Percentage values here refer to the width and height
    of the marker contents viewport, respectively.</p>

    <p>If the <span class="prop-value">inverted</span> keyword is not specified,
    then the knockout shape side is a single rectangle.  The width of the
    rectangle is the specified width value.  The height of the rectangle is the maximum
    of the stroke width of the path on which the marker exists and the specified
    height value, if it is specified.  If it is not specified, then the height of the
    rectangle is just the stroke width.
    The rectangle is posisioned such that the center of its right hand edge
    is positioned at the knockout shape side position
    and the extent of its width is in the direction of the start of the path,
    if this is the left knockout shape side, or the end of the path if this
    is the right knockout shape side.</p>

    <p>If the <span class="prop-value">inverted</span> keyword is specified,
    then the knockout shape side comprises two rectangles.  If the specified
    height is greater than or equal to the stroke width, then the height
    of these rectangles is zero; otherwise, their heights are half of the
    difference between the stroke width and the specified height.  The
    top edge of one of the rectangles is half of the stroke width away
    from the marker orientation tangent line, with its bottom edge closer to the tangent line.
    The other rectangle has its bottom edge half of the stroke width
    away from the tangent line and its top edge closer to the tangent line.
    The right edges of the rectangles are aligned with each other and
    also with the line perpendicular to the marker orientation tangent line.
    The extent of the widths of the rectangles is in the direction
    of the start of the path, if this is the left knockout shape side,
    or the end of the path if this is the right knockout shape side.</p>
  </dd>

  <dt><span class="prop-value">[ <a>&lt;length&gt;</a> | <a>&lt;percentage&gt;</a> | <a>&lt;number&gt;</a> ]{1,2} inverted? triangle</span></dt>
  <dd>
    <p class="issue" data-issue="7">...</p>
  </dd>
</dl>

<p class="issue" data-issue="8">A diagram showing the construction of these shapes
would be helpful.</p>

<p class="issue" data-issue="9">Need to define how the two shape sides are joined together.
It's taking the top and bottom points from both shapes, drawing vertical
lines to the edge of the stroke shape, then drawing two horizontal lines
to join them together.</p>

<p>The two knockout shape sides must not intersect, although they may
touch.  If they do intersect, then no knockout is performed for that
marker when painting the stroke.</p>

<p class="note">For example, using <span class="prop-value">8px inverted
triangle at -4px</span> for <a>'marker-knockout-left'</a> and
<span class="prop-value">8px triangle</span> for <a>'marker-knockout-right'</a>
is allowed, as the two straight lines that form the left shape side do not intersect
with either of the two straight lines that form the right shape side.
However, using <span class="prop-value">8px triangle at -4px</span> for
both properties would obviously cause an intersection, and so would not
be allowed.</p>

<div class="figure">
  <img class="bordered" src="images/knockout-shapes.svg" style="max-width: none"
       alt="Image showing various marker knockout shapes."/>
  <p class="caption">An illustration of the use of inverted and non-inverted circle,
  rectangle and triangle knockout shapes, at both 0px and 10px offsets.
  The value beneath each pink stroke is used for both <a>'marker-knockout-left'</a>
  and <a>'marker-knockout-right'</a>.  (The marker itself here has no
  content and does not render anything.)</p>
</div>

<div class="issue" data-issue="10">
  <p>While this is nice for straight line segments, if the
  path is curved at the marker position then it might be preferable to
  have the knockout shapes aligned with the tangent at the knockout shape
  side position, rather than with the marker orientation.  Especially
  if the knockout is being used as a fancy dash pattern.  Then we would
  likely want to join the left and right sides of the shape with a curved
  shape (along the stroke) and not just a rectangle.  If we allow this,
  then computing that shape is going to be hard, and will mean that
  determining whether the left and right sides of the knockout shape
  intersect, and determining what the intersections of all of the knockout shapes
  on a path are, is also going to be hard.  Perhaps that can be handled by
  extending dashing line caps with these shapes rather than here?  Regardless of
  whether it is handled by marker knockouts or new line caps, it's going
  to be non-trivial to compute the right shapes.</p>

  <p>Another thing to note is that knockouts here are like setting up
  a clipping path to remove parts of the stroke when it's painted.  That
  means that if the stroke intersects itself over the knockout areas,
  it's going to be knocked out of all bits of the stroke that go
  through those areas.  That may or may not be fine depending on
  your use cases.</p>
</div>

<h2 id="MarkerAlgorithm">Details on how markers are rendered</h2>

    <p class="issue" data-issue="2">This needs to reference a definition for how
    directionality of a given start/mid/end vertex is calculated.
    Part of that (which should be moved somewhere more appropriate) is in
    the <a href="[SVG2]/paths.html#PathElementImplementationNotes">path element implementation notes</a>.
    Some wording from SVG 1.1 appears to have been lost, compare with <a href="http://www.w3.org/TR/SVG11/painting.html#OrientAttribute">this</a>.
	<br/><br/>
    Here's an example that is a bit unclear currently:
    <code style="white-space:pre">
&lt;svg>
  &lt;marker id="m" orient="auto" overflow="visible">
    &lt;rect x="-1" y="-0.5" width="1" height="1" fill="green"/>
  &lt;/marker>
  &lt;path d="M50,0C50,50 50,100 50,100" marker-end="url(#m)" stroke-width="100" stroke="red"/>
&lt;/svg>
	</code>
	<br/>
	The second control point and the endpoint coincide, should this mean that the direction of the endpoint is a) <em>unknown [aka default to 0 degrees]</em> or
	b) <em>that you have to look at the previous segment(s)/command(s) until a direction can be established</em>?
    </p>

<p>For each marker that is drawn, a temporary new user coordinate
system is established so that the marker will be positioned and sized
correctly, as follows:</p>

<ul>
  <li>The axes of the temporary new user coordinate system are aligned
  according to the <a>'orient'</a> attribute on the
  <a>'marker element'</a> element and the slope of the curve at the given vertex.
  (Note: if there is a discontinuity at a vertex, the slope is the
  average of the slopes of the two segments of the curve that join
  at the given vertex. If a slope cannot be determined, the slope is
  assumed to be zero.)</li>

  <li>A temporary new coordinate system is established by attribute
  <a>'markerUnits'</a>. If <a>'markerUnits'</a> equals
  <span class="attr-value">'strokeWidth'</span>, then the temporary new
  user coordinate system is the result of scaling the current
  user coordinate system by the current value of property
  <a>'stroke-width'</a>. If <a>'markerUnits'</a> equals
  <span class="attr-value">'userSpaceOnUse'</span>, then no extra scale
  transformation is applied.</li>

  <li>An additional set of transformations might occur if the
  <a>'marker element'</a> element includes a <a>'viewBox'</a> attribute, in
  which case additional transformations are set up to produce the necessary
  result due to attributes <a>'viewBox'</a> and <a>'preserveAspectRatio'</a>.</li>

  <li>If the <a>'overflow'</a> property on the <a>'marker element'</a> element
  indicates that the marker needs to be clipped to its viewport, then an
  implicit clipping path is established at the bounds of the viewport.</li>
</ul>

<p>The rendering effect of a marker is as if the contents of the
referenced <a>'marker element'</a> element were deeply cloned
into a separate non-exposed DOM tree for each instance of the
marker. Because the cloned DOM tree is non-exposed, the SVG DOM
does not show the cloned instance of the marker.</p> <p>For user
agents that support <a href="[SVG2]/styling.html">Styling
with CSS</a>, the conceptual deep cloning of the referenced
<a>'marker element'</a> element into a non-exposed DOM tree also
copies any property values resulting from
the CSS cascade and
property inheritance on the referenced element and its contents. CSS 2.1
selectors can be applied to the original (i.e., referenced) elements
because they are part of the formal document structure. CSS 2.1 selectors
cannot be applied to the (conceptually) cloned DOM tree because its
contents are not part of the formal document structure.</p>

<p>For illustrative purposes, we'll repeat the marker example shown earlier:</p>

<pre>
&lt;?xml version="1.0" standalone="no"?&gt;
&lt;svg width="4in" height="2in"
     viewBox="0 0 4000 2000"
     xmlns="http://www.w3.org/2000/svg"&gt;
  &lt;defs&gt;
    &lt;marker id="Triangle"
      viewBox="0 0 10 10" refX="0" refY="5"
      markerUnits="strokeWidth"
      markerWidth="4" markerHeight="3"
      orient="auto"&gt;
      &lt;path d="M 0 0 L 10 5 L 0 10 z" /&gt;
    &lt;/marker&gt;
  &lt;/defs&gt;
  &lt;rect x="10" y="10" width="3980" height="1980"
       fill="none" stroke="blue" stroke-width="10" /&gt;
  &lt;desc&gt;Placing an arrowhead at the end of a path.
  &lt;/desc&gt;
  &lt;path d="M 1000 750 L 2000 750 L 2500 1250"
        fill="none" stroke="black" stroke-width="100"
        marker-end="url(#Triangle)"  /&gt;
&lt;/svg&gt;
</pre>

<p>The rendering effect of the above file will be visually identical to
the following:</p>

<pre>
&lt;?xml version="1.0" standalone="no"?&gt;
&lt;svg width="4in" height="2in"
     viewBox="0 0 4000 2000"
     xmlns="http://www.w3.org/2000/svg"&gt;
  &lt;desc&gt;File which produces the same effect
      as the marker example file, but without
      using markers.
  &lt;/desc&gt;
  &lt;rect x="10" y="10" width="3980" height="1980"
       fill="none" stroke="blue" stroke-width="10" /&gt;
  &lt;!-- The path draws as before, but without the marker properties --&gt;
  &lt;path d="M 1000 750 L 2000 750 L 2500 1250"
        fill="none" stroke="black" stroke-width="100"  /&gt;
  &lt;!-- The following logic simulates drawing a marker
       at final vertex of the path. --&gt;
  &lt;!-- First off, move the origin of the user coordinate system
       so that the origin is now aligned with the end point of the path. --&gt;
  <strong>&lt;g transform="translate(2500,1250)" &gt;</strong>
    &lt;!-- Rotate the coordinate system 45 degrees because
         the marker specified orient="auto" and the final segment
         of the path is going in the direction of 45 degrees. --&gt;
    <strong>&lt;g transform="rotate(45)" &gt;</strong>
      &lt;!-- Scale the coordinate system to match the coordinate system
           indicated by the 'markerUnits' attributes, which in this case has
           a value of 'strokeWidth'. Therefore, scale the coordinate system
           by the current value of the 'stroke-width' property, which is 100. --&gt;
      <strong>&lt;g transform="scale(100)" &gt;</strong>
        &lt;!-- Translate the coordinate system by
             (-refX*viewBoxToMarkerUnitsScaleX, -refY*viewBoxToMarkerUnitsScaleY)
             in order that (refX,refY) within the marker will align with the vertex.
             In this case, we use the default value for preserveAspectRatio
             ('xMidYMid meet'), which means find a uniform scale factor
             (i.e., viewBoxToMarkerUnitsScaleX=viewBoxToMarkerUnitsScaleY)
             such that the viewBox fits entirely within the viewport ('meet') and
             is center-aligned ('xMidYMid'). In this case, the uniform scale factor
             is markerHeight/viewBoxHeight=3/10=.3. Therefore, translate by
             (-refX*.3,-refY*.3)=(0*.3,-5*.3)=(0,-1.5). --&gt;
        <strong>&lt;g transform="translate(0,-1.5)" &gt;</strong>
          &lt;!-- There is an implicit clipping path because the user agent style
               sheet says that the 'overflow' property for markers has the value
               'hidden'. To achieve this, create a clipping path at the bounds
               of the viewport. Note that in this case the viewport extends
               0.5 units to the left and right of the viewBox due to
               a uniform scale factor, different ratios for markerWidth/viewBoxWidth
               and markerHeight/viewBoxHeight, and 'xMidYMid' alignment --&gt;
          <strong>&lt;clipPath id="cp1" &gt;
            &lt;rect x="-0.5" y="0" width="4" height="3" /&gt;
          &lt;/clipPath&gt;</strong>
          <strong>&lt;g clip-path="url(#cp1)" &gt;</strong>
            &lt;!-- Scale the coordinate system by the uniform scale factor
                 markerHeight/viewBoxHeight=3/10=.3 to set the coordinate
                 system to viewBox units. --&gt;
            <strong>&lt;g transform="scale(.3)" &gt;</strong>
              &lt;!-- This 'g' element carries all property values that result from
                   cascading and inheritance of properties on the original 'marker' element.
                   In this example, neither fill nor stroke was specified on the 'marker'
                   element or any ancestors of the 'marker', so the initial values of
                   "black" and "none" are used, respectively. --&gt;
             <strong>&lt;g fill="black" stroke="none" &gt;</strong>
                &lt;!-- Expand out the contents of the 'marker' element. --&gt;
                <strong>&lt;path d="M 0 0 L 10 5 L 0 10 z" /&gt;</strong>
              <strong>&lt;/g&gt;</strong>
            <strong>&lt;/g&gt;</strong>
          <strong>&lt;/g&gt;</strong>
        <strong>&lt;/g&gt;</strong>
      <strong>&lt;/g&gt;</strong>
    <strong>&lt;/g&gt;</strong>
  <strong>&lt;/g&gt;</strong>
&lt;/svg&gt;
</pre>
<p class="view-as-svg"><a href="images/marker-simulated.svg">View this example as SVG (SVG-enabled browsers only)</a></p>

</edit:with>


<h2 id="idl">IDL</h2>

<h3 id="InterfaceSVGMarkableElement" data-dfn-type="interface" data-lt="SVGMarkableElement">Mixin SVGMarkableElement</h3>

<p>The <a>SVGMarkableElement</a> interface is implemented on all
<a>shape</a> elements, and provides access to the markers that are placed on
the element's path.</p>

<pre class="idl">interface mixin <b>SVGMarkableElement</b> {
  readonly attribute <a>SVGMarkerList</a> <a href="#__svg__SVGMarkableElement__markers">markers</a>;

  long <a href="#__svg__SVGMarkableElement__getMarkerIndexFromPoint">getMarkerIndexFromPoint</a>(<a>DOMPoint</a> point);
};

<a>SVGLineElement</a> includes <a>SVGMarkableElement</a>;
<a>SVGPathElement</a> includes <a>SVGMarkableElement</a>;
<a>SVGPolygonElement</a> includes <a>SVGMarkableElement</a>;
<a>SVGPolylineElement</a> includes <a>SVGMarkableElement</a>;</pre>

<dl class="interface">
  <dt class="attributes-header">Attributes:</dt>
  <dd>
    <dl class="attributes">
      <dt id="__svg__SVGMarkableElement__markers" class="attribute first-child"><b>markers</b><span class="idl-type-parenthetical"> (readonly <a>SVGMarkerList</a>)</span></dt>
      <dd class="attribute">The list of markers on this element.</dd>
    </dl>
  </dd>
  <dt class="operations-header">Operations:</dt>
  <dd>
    <dl class="attributes">
      <dt id="__svg__SVGMarkableElement__getMarkerIndexFromPoint" class="operation first-child">long <b>getMarkerIndexFromPoint</b>(<a>DOMPoint</a> point)</dt>
      <dd class="operation">Returns the index into the <a>SVGMarkerList</a> of the marker that is at
      the specified point.  Normal hit testing rules apply; the value of the
      <a>'pointer-events'</a> property on the elements that comprise the markers,
      as well as its value on this element, is honored, and the top-most marker
      is selected when there are multiple markers whose content is at the given
      point.
        <dl class="operation">
          <dt class="parameters-header">Parameters</dt>
          <dd>
            <ol class="parameters">
              <li class="parameter first-child">
                <div><a>DOMPoint</a> <var>point</var></div>
                <div>The point to check for intersection with the markers
                on this element.  The <a>DOMPoint</a> is interpreted as a
                point in the local coordinate system of this element.</div>
              </li>
            </ol>
          </dd>
          <dt class="returns-header">Returns</dt>
          <dd>The index into this element's <a>SVGMarkerList</a> of the marker
          at the given point, or -1 if there is no such marker.</dd>
        </dl>
      </dd>
    </dl>
  </dd>
</dl>

<h3 id="InterfaceSVGMarkerElement">Interface SVGMarkerElement</h3>

<edit:with element="marker">

The <a>SVGMarkerElement</a> interface corresponds to the
<a>'marker element'</a> element.

<pre class="idl">interface <b>SVGMarkerElement</b> : <a>SVGElement</a> {

  // Marker Unit Types
  const unsigned short <a href="#__svg__SVGMarkerElement__SVG_MARKERUNITS_UNKNOWN">SVG_MARKERUNITS_UNKNOWN</a> = 0;
  const unsigned short <a href="#__svg__SVGMarkerElement__SVG_MARKERUNITS_USERSPACEONUSE">SVG_MARKERUNITS_USERSPACEONUSE</a> = 1;
  const unsigned short <a href="#__svg__SVGMarkerElement__SVG_MARKERUNITS_STROKEWIDTH">SVG_MARKERUNITS_STROKEWIDTH</a> = 2;

  // Marker Orientation Types
  const unsigned short <a href="#__svg__SVGMarkerElement__SVG_MARKER_ORIENT_UNKNOWN">SVG_MARKER_ORIENT_UNKNOWN</a> = 0;
  const unsigned short <a href="#__svg__SVGMarkerElement__SVG_MARKER_ORIENT_AUTO">SVG_MARKER_ORIENT_AUTO</a> = 1;
  const unsigned short <a href="#__svg__SVGMarkerElement__SVG_MARKER_ORIENT_ANGLE">SVG_MARKER_ORIENT_ANGLE</a> = 2;
  const unsigned short <a href="#__svg__SVGMarkerElement__SVG_MARKER_ORIENT_AUTO_START_REVERSE">SVG_MARKER_ORIENT_AUTO_START_REVERSE</a> = 3;

  readonly attribute <a>SVGAnimatedLength</a> <a href="#__svg__SVGMarkerElement__refX">refX</a>;
  readonly attribute <a>SVGAnimatedLength</a> <a href="#__svg__SVGMarkerElement__refY">refY</a>;
  readonly attribute <a>SVGAnimatedEnumeration</a> <a href="#__svg__SVGMarkerElement__markerUnits">markerUnits</a>;
  readonly attribute <a>SVGAnimatedLength</a> <a href="#__svg__SVGMarkerElement__markerWidth">markerWidth</a>;
  readonly attribute <a>SVGAnimatedLength</a> <a href="#__svg__SVGMarkerElement__markerHeight">markerHeight</a>;
  readonly attribute <a>SVGAnimatedEnumeration</a> <a href="#__svg__SVGMarkerElement__orientType">orientType</a>;
  readonly attribute <a>SVGAnimatedAngle</a> <a href="#__svg__SVGMarkerElement__orientAngle">orientAngle</a>;
           attribute DOMString <a href="#__svg__SVGMarkerElement__orient">orient</a>;

  undefined <a href="#__svg__SVGMarkerElement__setOrientToAuto">setOrientToAuto</a>();
  undefined <a href="#__svg__SVGMarkerElement__setOrientToAngle">setOrientToAngle</a>(<a>SVGAngle</a> angle);
};

<a>SVGMarkerElement</a> includes <a>SVGFitToViewBox</a>;</pre>

<dl class="interface">
  <dt class="constants-header">Constants in group “Marker Unit Types”:</dt>
  <dd>
    <dl class="constants">
      <dt id="__svg__SVGMarkerElement__SVG_MARKERUNITS_UNKNOWN" class="constant first-child"><b>SVG_MARKERUNITS_UNKNOWN</b><span class="idl-type-parenthetical"> (unsigned short)</span></dt>
      <dd class="constant">
        <div>The marker unit type is not one of othe other predefined types. It is invalid to
        attempt to define a new value of this type or to attempt to switch an
        existing value to this type.</div>
      </dd>
      <dt id="__svg__SVGMarkerElement__SVG_MARKERUNITS_USERSPACEONUSE" class="constant"><b>SVG_MARKERUNITS_USERSPACEONUSE</b><span class="idl-type-parenthetical"> (unsigned short)</span></dt>
      <dd class="constant">
        <div>The value of attribute <a>'markerUnits'</a> is
        <span class="attr-value">'userSpaceOnUse'</span>.</div>
      </dd>
      <dt id="__svg__SVGMarkerElement__SVG_MARKERUNITS_STROKEWIDTH" class="constant"><b>SVG_MARKERUNITS_STROKEWIDTH</b><span class="idl-type-parenthetical"> (unsigned short)</span></dt>
      <dd class="constant">
        <div>The value of attribute <a>'markerUnits'</a> is
        <span class="attr-value">'strokeWidth'</span>.</div>
      </dd>
    </dl>
  </dd>
  <dt class="constants-header">Constants in group “Marker Orientation Types”:</dt>
  <dd>
    <dl class="constants">
      <dt id="__svg__SVGMarkerElement__SVG_MARKER_ORIENT_UNKNOWN" class="constant first-child"><b>SVG_MARKER_ORIENT_UNKNOWN</b><span class="idl-type-parenthetical"> (unsigned short)</span></dt>
      <dd class="constant">
        <div>The marker orientation is not one of the predefined types. It is invalid to
        attempt to define a new value of this type or to attempt to switch an
        existing value to this type.</div>
      </dd>
      <dt id="__svg__SVGMarkerElement__SVG_MARKER_ORIENT_AUTO" class="constant"><b>SVG_MARKER_ORIENT_AUTO</b><span class="idl-type-parenthetical"> (unsigned short)</span></dt>
      <dd class="constant">
        <div>Attribute <a>'orient'</a> has value
        <span class="attr-value">'auto'</span>.</div>
      </dd>
      <dt id="__svg__SVGMarkerElement__SVG_MARKER_ORIENT_AUTO_START_REVERSE" class="constant"><b>SVG_MARKER_ORIENT_AUTO_START_REVERSE</b><span class="idl-type-parenthetical"> (unsigned short)</span></dt>
      <dd class="constant">
        <div>Attribute <a>'orient'</a> has value
        <span class="attr-value">'auto-start-reverse'</span>.</div>
      </dd>
      <dt id="__svg__SVGMarkerElement__SVG_MARKER_ORIENT_ANGLE" class="constant"><b>SVG_MARKER_ORIENT_ANGLE</b><span class="idl-type-parenthetical"> (unsigned short)</span></dt>
      <dd class="constant">
        <div>Attribute <a>'orient'</a> has an angle value.</div>
      </dd>
    </dl>
  </dd>
  <dt class="attributes-header">Attributes:</dt>
  <dd>
    <dl class="attributes">
      <dt id="__svg__SVGMarkerElement__refX" class="attribute first-child"><b>refX</b><span class="idl-type-parenthetical"> (readonly <a>SVGAnimatedLength</a>)</span></dt>
      <dd class="attribute">
        <div>Corresponds to attribute <a>'refX'</a> on the given
        <a>'marker element'</a> element.</div>
      </dd>
      <dt id="__svg__SVGMarkerElement__refY" class="attribute"><b>refY</b><span class="idl-type-parenthetical"> (readonly <a>SVGAnimatedLength</a>)</span></dt>
      <dd class="attribute">
        <div>Corresponds to attribute <a>'refY'</a> on the given
        <a>'marker element'</a> element.</div>
      </dd>
      <dt id="__svg__SVGMarkerElement__markerUnits" class="attribute"><b>markerUnits</b><span class="idl-type-parenthetical"> (readonly <a>SVGAnimatedEnumeration</a>)</span></dt>
      <dd class="attribute">
        <div>Corresponds to attribute <a>'markerUnits'</a> on the given
        <a>'marker element'</a> element.  One of the Marker Unit Types
        defined on this interface.</div>
      </dd>
      <dt id="__svg__SVGMarkerElement__markerWidth" class="attribute"><b>markerWidth</b><span class="idl-type-parenthetical"> (readonly <a>SVGAnimatedLength</a>)</span></dt>
      <dd class="attribute">
        <div>Corresponds to attribute <a>'markerWidth'</a> on the given
        <a>'marker element'</a> element.</div>
      </dd>
      <dt id="__svg__SVGMarkerElement__markerHeight" class="attribute"><b>markerHeight</b><span class="idl-type-parenthetical"> (readonly <a>SVGAnimatedLength</a>)</span></dt>
      <dd class="attribute">
        <div>Corresponds to attribute <a>'markerHeight'</a> on the given
        <a>'marker element'</a> element.</div>
      </dd>
      <dt id="__svg__SVGMarkerElement__orientType" class="attribute"><b>orientType</b><span class="idl-type-parenthetical"> (readonly <a>SVGAnimatedEnumeration</a>)</span></dt>
      <dd class="attribute">
        <div>Corresponds to attribute <a>'orient'</a> on the given
        <a>'marker element'</a> element.  One of the Marker Orientation
        Types defined on this interface.  If the <a>'orient'</a>
        attribute is set to <span class="attr-value">'auto-start-rotate'</span>,
        then the value of orientType is SVG_MARKER_ORIENT_UNKNOWN.</div>
      </dd>
      <dt id="__svg__SVGMarkerElement__orientAngle" class="attribute"><b>orientAngle</b><span class="idl-type-parenthetical"> (readonly <a>SVGAnimatedAngle</a>)</span></dt>
      <dd class="attribute">
        <div>Corresponds to attribute <a>'orient'</a> on the given
        <a>'marker element'</a> element.  If <a>markerUnits</a> is
        SVG_MARKER_ORIENT_ANGLE, the angle value for attribute <a>'orient'</a>;
        otherwise, it will be set to zero.</div>
      </dd>
    </dl>
    <dl class="attributes">
      <dt id="__svg__SVGMarkerElement__orient" class="attribute"><b>orient</b><span class="idl-type-parenthetical"> (DOMString)</span></dt>
      <dd class="attribute">
        <div>Corresponds to attribute <a>'orient'</a> on the
        given <a>'marker element'</a> element.  This attribute
        simply reflects the value of the <a>'orient'</a>
        content attribute.</div>
      </dd>
    </dl>
  </dd>
  <dt class="operations-header">Operations:</dt>
  <dd>
    <dl class="attributes">
      <dt id="__svg__SVGMarkerElement__setOrientToAuto" class="operation first-child">undefined <b>setOrientToAuto</b>()</dt>
      <dd class="operation">
        <div>Sets the value of attribute <a>'orient'</a> to
        <span class="attr-value">'auto'</span>.</div>
      </dd>
      <dt id="__svg__SVGMarkerElement__setOrientToAngle" class="operation">undefined <b>setOrientToAngle</b>(<a>SVGAngle</a> <var>angle</var>)</dt>
      <dd class="operation">
        <div>Sets the value of attribute <a>'orient'</a> to the given angle.</div>
        <dl class="operation">
          <dt class="parameters-header">Parameters</dt>
          <dd>
            <ol class="parameters">
              <li class="parameter first-child">
                <div><a>SVGAngle</a> <var>angle</var></div>
                <div>The angle value to use for attribute <a>'orient'</a>.</div>
              </li>
            </ol>
          </dd>
        </dl>
      </dd>
    </dl>
  </dd>
</dl>

<h3 id="InterfaceSVGMarkerInstance">Interface SVGMarkerInstance</h3>

<p>The <a>SVGMarkerInstance</a> interface is used to represent an instance
of a marker that is on a <a>shape</a>.  An <a>SVGMarkerInstance</a>
can represent any kind of marker, including <a>positioned markers</a>.</p>
<p class="issue" data-issue="11">What should we do about liveness?  If it is live, we
could have it know what index it is for, and always return information
about the marker at that index (and return null for the element if
that index is no longer valid).</p>

<pre class="idl">interface <b>SVGMarkerInstance</b> {
  readonly attribute <a>SVGMarkerElement</a> element;
  readonly attribute float position;
  readonly attribute <a>DOMPointReadOnly</a> point;
  readonly attribute float angle;
};</pre>

<dl class="interface">
  <dt class="attributes-header">Attributes:</dt>
  <dd>
    <dl class="attributes">
      <dt id="__svg__SVGMarkerInstance__element" class="attribute first-child"><b>element</b><span class="idl-type-parenthetical"> (readonly <a>SVGMarkerElement</a>)</span></dt>
      <dd class="attribute">The <a>'marker element'</a> element that defines
      the marker.  If the marker is a <a>vertex marker</a>, <a>segment marker</a>
      or <a>repeating marker</a>, then this will be the <a>'marker element'</a>
      element that the relevant marker property referenced.  If the marker is
      a <a>positioned marker</a>, then this will be the child <a>'marker element'</a>
      element of the <a>shape</a>.</dd>
      <dt id="__svg__SVGMarkerInstance__position" class="attribute"><b>position</b><span class="idl-type-parenthetical"> (readonly float)</span></dt>
      <dd class="attribute">The distance along the <a>equivalent path</a> of the
      <a>shape</a> that the marker is positioned at.</dd>
      <dt id="__svg__SVGMarkerInstance__point" class="attribute"><b>point</b><span class="idl-type-parenthetical"> (readonly <a>DOMPointReadOnly</a>)</span></dt>
      <dd class="attribute">The point, in the local coordinate system of the
      <a>shape</a>, that the marker is positioned at.
      The <a>DOMPointReadOnly</a> object is read only.</dd>
      <dt id="__svg__SVGMarkerInstance__angle" class="attribute"><b>angle</b><span class="idl-type-parenthetical"> (readonly float)</span></dt>
      <dd class="attribute">The orientation of the marker relative to a
      vector pointing in the direction of the positive y-axis of the
      <a>shape</a>'s local coordinate system.</dd>
    </dl>
  </dd>
</dl>

<h3 id="InterfaceSVGMarkerList">Interface SVGMarkerList</h3>

<p>The <a>SVGMarkerList</a> interface is used to expose the list of markers that
are painted on a given <a>shape</a>.  This list includes all
<a>vertex markers</a>, <a>segment markers</a>, <a>repeating markers</a> and
<a>positioned markers</a>.  The list of <a>SVGMarkerInstance</a> objects
is maintained in the order that the markers are painted.</p>
<p>The <a href="http://heycam.github.io/webidl/#dfn-supported-property-indices">supported property indices</a>
of an <a>SVGMarkerList</a> object is all non-negative integers less than
the length of the list.</p>

<pre class="idl">interface <b>SVGMarkerList</b> {
  readonly attribute unsigned long <a href="#__svg__SVGMarkerList__length">length</a>;
  getter <a>SVGMarkerInstance</a>? <a href="#__svg__SVGMarkerList__item">item</a>(unsigned long index);
};</pre>

<dl class="interface">
  <dt class="attributes-header">Attributes:</dt>
  <dd>
    <dl class="attributes">
      <dt id="__svg__SVGMarkerList__length" class="attribute first-child"><b>length</b><span class="idl-type-parenthetical"> (readonly unsigned long)</span></dt>
      <dd class="attribute">The number of markers on this element.</dd>
    </dl>
  </dd>
  <dt class="operations-header">Operations:</dt>
  <dd>
    <dl class="attributes">
      <dt id="__svg__SVGMarkerList__item" class="operation first-child"><a>SVGMarkerInstance</a>? <b>item</b>(unsigned long <var>index</var>)</dt>
      <dd class="operation">Gets the <a>SVGMarkerInstance</a> at the given position in the
      list of markers on this element.
        <dl class="operation">
          <dt class="parameters-header">Parameters</dt>
          <dd>
            <ol class="parameters">
              <li class="parameter first-child">
                <div>unsigned long <var>index</var></div>
                <div>The index of the <a>SVGMarkerInstance</a> to return.</div>
              </li>
            </ol>
          </dd>
          <dt class="returns-header">Returns</dt>
          <dd>Returns the <a>SVGMarkerInstance</a> at position <var>index</var>
          in the list of markers on this element, or null if <var>index</var>
          is out of range.</dd>
        </dl>
      </dd>
    </dl>
  </dd>
</dl>

</edit:with>


<h2 id="refs">References</h2>

<h3 id="normrefs">Normative references</h3>

<dl>
  <dt id="ref-RFC2119"><strong class="normref">[RFC2119]</strong></dt>
  <dd><cite><a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a></cite>,
  S. Bradner, March 1997.
  <br />Available at http://tools.ietf.org/html/rfc2119.</dd>

<!--
  <dt id="ref-SVG11"><strong class="normref">[SVG11]</strong></dt>
  <dd><cite class="w3crec"><a href="http://www.w3.org/TR/2003/REC-SVG11-20030114/">Scalable Vector Graphics (SVG) 1.1</a></cite>,
  J. Ferraiolo, <span class="ruby"><span class="rb">&#x85E4;&#x6CA2; &#x6DF3;</span><span class="rp">(</span><span class="rt"><span class="familyname">Fujisawa</span> Jun</span><span class="rp">)</span></span>, D. Jackson, eds.
  World Wide Web Consortium, 14 January 2003.
  <br />This edition of SVG 1.1 is http://www.w3.org/TR/2003/REC-SVG11-20030114/.
  <br />The <a href="http://www.w3.org/TR/SVG11/">latest edition of SVG 1.1</a> is available at http://www.w3.org/TR/SVG11/.</dd>
-->

  <dt id="ref-SVG2"><strong class="normref">[SVG2]</strong></dt>
  <dd><cite class="w3cwd"><a href="http://www.w3.org/TR/2015/WD-SVG2-20150409/">Scalable Vector Graphics (SVG) 2</a></cite>,
  N. Andronikos, T. Bah, A. Bellamy-Royds, B. Birtles, C. Concolato, E. Dahlström, C. Lilley, C. McCormack, D. Schepers, D. Schulze, R. Schwerdtfeger, S. Takagi, J. Watt, eds.
  World Wide Web Consortium, 09 April 2015.
  <br />This edition of SVG 2 is http://www.w3.org/TR/2015/WD-SVG2-20150409/.
  <br />The <a href="http://www.w3.org/TR/SVG2/">latest edition of SVG 2</a> is available at http://www.w3.org/TR/SVG2/.</dd>
</dl>

<!--
<h3 id="nonnormrefs">Non-normative references</h3>

<dl>
</dl>
-->

<h2 id="ChangesSinceSVG2">Changes since SVG 2</h2>

<ul>
  <li>Added the <a>'marker-segment'</a>, <a>'marker-pattern'</a>,
  <a>'marker-knockout-left'</a> and <a>'marker-knockout-right'</a> properties.</li>

  <li>Extended the <a>'marker property'</a> shorthand so that it can set values for
  <a>'marker-start'</a>, <a>'marker-mid'</a>, <a>'marker-end'</a>, <a>'marker-segment'</a>
  and <a>'marker-pattern'</a>.</li>

  <li>Added the <a>SVGMarkableElement</a>, <a>SVGMarkerInstance</a> and
  <a>SVGMarkerList</a> interfaces for access to the list of markers on an
  element.</li>
</ul>


<!--
<h2 id="Acknowledgments">Acknowledgments</h2>

<p>...</p>
-->

</body>
</html>
