<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional+edit//EN" "xhtml1-transitional+edit.dtd">
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:edit="http://xmlns.grorg.org/SVGT12NG/">
<head>
  <title>Document Structure</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport"           content="width=device-width, initial-scale=1, shrink-to-fit=no"/>

  <!-- Style sheets for local dev. Will be standardized in processing.
  Add attribute data-keep="" to any extra stylesheet link you do not want removed
  (or use <style>), and include it before here. -->
  <link rel="stylesheet" href="style/svg.css" type="text/css" />
  <link rel="stylesheet" href="style/W3C-ED.css" type="text/css" />
</head>
<body>

<h1>Document Structure</h1>

<h2 id="NewDocument">Defining an SVG document fragment: the <span class='element-name'>'svg'</span> element</h2>

<edit:with element='svg'>

<h3 id="NewDocumentOverview">Overview</h3>

<p>An <a>SVG document fragment</a> consists of any number of SVG elements
contained within an <a>'svg'</a> element.</p>

<p>An SVG document fragment can range from an empty fragment (i.e.,
no content inside of the <a>'svg'</a> element), to a very simple SVG
document fragment containing a single SVG <a>graphics element</a>
such as a <a>'rect'</a>, to a complex, deeply nested collection of
<a>container elements</a> and <a>graphics elements</a>.</p>

<p>An SVG document fragment can stand by itself as a self-contained
file or resource, in which case the SVG document fragment is an <a>SVG
document</a>, or it can be embedded inline as a fragment within a parent
HTML or XML document.</p>

<p id="EmbeddedSVGExample">The following example shows simple SVG
content embedded inline as a fragment within a parent XML document.
Note the use of XML namespaces to indicate that the <a>'svg'</a> and
<a>'ellipse'</a> elements belong to the <a>SVG namespace</a>:</p>

<pre class='xml'><![CDATA[
<?xml version="1.0" standalone="yes"?>
<parent xmlns="http://example.org"
        xmlns:svg="http://www.w3.org/2000/svg">
   <!-- parent contents here -->
   <svg:svg width="4cm" height="8cm">
      <svg:ellipse cx="2cm" cy="4cm" rx="2cm" ry="1cm" />
   </svg:svg>
   <!-- ... -->
</parent>
]]></pre>

<p>This example shows a slightly more complex (i.e., it contains
multiple rectangles) stand-alone, self-contained SVG document:</p>

<edit:example href='images/struct/StandAlone01.svg' image='no'/>

<p><a>'svg'</a> elements can appear in the middle of SVG content. This
is the mechanism by which SVG document fragments can be embedded within
other SVG document fragments.</p>

<p>Another use for <a>'svg'</a> elements within the middle
of SVG content is to establish a new SVG viewport. (See
<a href="coords.html#EstablishingANewSVGViewport">Establishing a new
SVG viewport</a>.)</p>

<h3 id="Namespace">Namespace</h3>

<p>When SVG is parsed as a XML, for compliance with the
<a href="https://www.w3.org/TR/2006/REC-xml-names-20060816/"><cite>Namespaces in XML</cite></a> Recommendation
[<a href="refs.html#ref-xml-names">xml-names</a>], an SVG namespace
declaration must be provided so that all SVG elements are identified
as belonging to the SVG namespace.</p>

<p>When using the HTML syntax, the namespace is provided automatically by the HTML parser.</p>

<pre class='html'><![CDATA[
<html>
<svg viewBox="0 0 100 100">
  <circle cx="50" cy="50" r="50" fill="green">
</svg>
</html>
]]></pre>

<p>As the example shows there's no need to have an <span class='attr-name'>'xmlns'</span>
  attribute declaring that the element is in the SVG namespace when using the HTML parser.
  The HTML parser will automatically create the SVG elements in the proper namespace.
</p>

<p class="issue" data-issue="1">This section should talk about how a document's behavior
is defined in terms of the DOM, and also explain how the HTML parser can
create SVG fragments.</p>

<p>The SVG 2 namespace is <code>http://www.w3.org/2000/svg</code>,
which is the same as for earlier versions of SVG.</p>

<p>The following are possible ways to
provide a namespace declaration when SVG is parsed as XML. An <span class='attr-name'>'xmlns'</span>
attribute without a namespace prefix could be specified on an
<a>'svg'</a> element, which means that SVG is the default namespace
for all elements within the scope of the element with the <span class='attr-name'>'xmlns'</span> attribute:</p>

<pre class='xml'><![CDATA[
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
  <rect x="10" y="10" width="80" height="80" fill="green" />
</svg>
]]></pre>

<p>If a namespace prefix is specified on the <span class='attr-name'>'xmlns'</span>
attribute (e.g., <code class='xml'>xmlns:svg="http://www.w3.org/2000/svg"</code>),
then the corresponding namespace is not the default namespace, so an
explicit namespace prefix must be assigned to the elements:</p>

<pre class='xml'><![CDATA[
<svg:svg xmlns:svg="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
  <svg:rect x="10" y="10" width="80" height="80" fill="green" />
</svg:svg>
]]></pre>

<p>Namespace prefixes can be specified on ancestor elements (illustrated
in the <a href="#EmbeddedSVGExample">above example</a>). For more
information, refer to the <a href="https://www.w3.org/TR/2006/REC-xml-names-20060816/"><cite>Namespaces in XML</cite></a> Recommendation
[<a href="refs.html#ref-xml-names">xml-names</a>].</p>

<h3 id="Definitions">Definitions</h3>

<dl class="definitions">
  <dt><dfn id="TermStructuralElement" data-dfn-type="dfn" data-export="">structural element</dfn></dt>
  <dd>The structural elements are those which define the primary
  structure of an SVG document.  Specifically, the following
  elements are structural elements:
  <edit:elementcategory name='structural'/>.</dd>

  <dt><dfn id="TermStructurallyExternalElement" data-dfn-type="dfn" data-export="">structurally external element</dfn></dt>
  <dd>Elements that define its structure by reference to an external resource.
  Specifically, the following elements are structurally external elements when
  they have an <span class="attr-name">'href'</span> attribute:
  <edit:elementcategory name='structurally external'/>.</dd>

  <dt><dfn id="TermCurrentSVGDocumentFragment" data-dfn-type="dfn" data-export="">current SVG document fragment</dfn></dt>
  <dd>The document sub-tree which starts with the outermost
  ancestor <a>'svg'</a> element of a given SVG
  element, with the requirement that all container elements
  between the outermost <a>'svg'</a> and the given element are
  all elements in the SVG namespace.</dd>

  <dt><dfn id="TermOutermostSVGElement" data-dfn-type="dfn" data-export="">outermost svg element</dfn></dt>
  <dd>The furthest <a>'svg'</a> ancestor element that remains in the
  <a>current SVG document fragment</a>.</dd>

  <dt><dfn id="TermSVGDocumentFragment" data-dfn-type="dfn" data-export="">SVG document fragment</dfn></dt>
  <dd>A document sub-tree which starts with an <a>'svg'</a>
  element which is either the root element of the document or whose parent
  element is not in the SVG namespace.
  An SVG document fragment can consist of a stand-alone SVG document,
  or a fragment of a parent document enclosed by an <a>'svg'</a>
  element.
  Howevere, an <a>'svg'</a> element that is a direct child of another SVG-namespaced element
  is not the root of an SVG document fragment.
  </dd>

  <dt><dfn id="TermSVGElements" data-dfn-type="dfn" data-export="">SVG elements</dfn></dt>
  <dd>Any element in the <a>SVG namespace</a>.</dd>

  <dt id="TermGraphicsElement"><dfn id="graphics-element" data-dfn-type="dfn" data-export="">graphics element</dfn></dt>
  <dd>One of the element types that can cause graphics to be
  drawn onto the target canvas. Specifically:
  <edit:elementcategory name='graphics'/>.</dd>

  <dt id="TermGraphicsReferencingElement"><dfn id="graphics-referencing-element" data-dfn-type="dfn" data-export="">graphics referencing element</dfn></dt>
  <dd>A graphics element which uses a reference to a different
  document or element as the source of its graphical content.
  Specifically: <edit:elementcategory name='graphics referencing'/>.</dd>

</dl>

<h3 id="SVGElement">The <span class='element-name'>'svg'</span> element</h3>

<div class="annotation svg2-requirement">
  <table>
    <tr>
      <th>SVG 2 Requirement:</th>
      <td>Support transforming <a>'svg'</a> elements.</td>
    </tr>
    <tr>
      <th>Resolution:</th>
      <td><a href="http://www.w3.org/2011/10/28-svg-irc#T00-23-44">We will allow <span class='attr-name'>'transform'</span> on <span class='element-name'>'svg'</span> in SVG 2.</a></td>
    </tr>
    <tr>
      <th>Purpose:</th>
      <td>To allow transforms on nested <a>'svg'</a> elements, in line with author expectations.</td>
    </tr>
    <tr>
      <th>Owner:</th>
      <td>Dirk (no action)</td>
    </tr>
    <tr>
      <th>Status:</th>
      <td>Done</td>
    </tr>
  </table>
</div>

<edit:elementsummary name='svg'/>
<p>
  The <a>'x'</a> and <a>'y'</a> attributes specify the
  top-left corner of the rectangular region into which an
  embedded <a>'svg'</a> element is placed.  On an <a>outermost svg element</a>,
  these attributes have no effect.
</p>

<p>
  For <a>outermost svg elements</a>,
  the <a>'width property'</a> and <a>'height property'</a> attributes specify
  the intrinsic size of the SVG document fragment.
  For embedded <a>'svg'</a> elements, they specify the size
  of the rectangular region into which the <a>'svg'</a> element
  is placed.
  In either case, a computed style of <span class="prop-value">auto</span>
  is treated equivalent to <span class="prop-value">100%</span>.
</p>

<p><em>Attribute definitions:</em></p>

<dl class="attrdef-list">
  <dt>
    <table class="attrdef def">
      <tr>
        <th>Name</th>
        <th>Value</th>
        <th>Initial value</th>
        <th>Animatable</th>
      </tr>
      <tr>
        <td><dfn id="SVGElementZoomAndPanAttribute" data-dfn-type="element-attr" data-dfn-for="svg" data-export="">zoomAndPan</dfn></td>
        <td>disable | magnify</td>
        <td>magnify</td>
        <td>no</td>
      </tr>
    </table>
  </dt>
  <dd>
    <p>Specifies whether the user agent should supply a means to zoom
    and pan the SVG content.  See the definition of <a>'zoomAndPan'</a>
    for details.</p>
  </dd>
</dl>

<p>If an SVG document is likely to be referenced as a component
of another document, the author will often want to include a
<a>'viewBox'</a> attribute on the <a>outermost svg element</a> of the
referenced document. This attribute provides a convenient way to design
SVG documents to scale-to-fit into an arbitrary SVG viewport.</p>

<p id="SVGElementEventHandlerAttributes">The <a>'svg'</a> element exposes as <a>event handler content attributes</a> a number of the <a>event handlers</a> of the <a>Window</a> object. It also mirrors their <a>event handler IDL attributes</a>.</p>

<p>The <a href="interact.html">onblur</a>, <a>'onerror'</a>, <a href="interact.html">onfocus</a>, <a>'onload'</a>, and <a>'onscroll'</a> <a>event handlers</a> of the <a>Window</a> object, exposed on the <a>'svg'</a> element,
replace the generic <a>event handlers</a> with the same names normally supported by <a>SVG elements</a>.</p>

</edit:with>

<h2 id="Groups">Grouping: the <span class='element-name'>'g'</span> element</h2>

<h3 id="GroupsOverview">Overview</h3>

<dl class="definitions">
  <dt id="TermContainerElement"><dfn id="container-element" data-dfn-type="dfn" data-export="">container element</dfn></dt>
  <dd>An element which can have <a>graphics elements</a> and other
  container elements as child elements. Specifically:
  <edit:elementcategory name='container'/>.</dd>
</dl>

<p>The <a>'g'</a> element is a <a>container element</a> for grouping together
related <a>graphics elements</a>.</p>

<p>A group of elements, as well as individual objects, can be given
a name using the <a>'id'</a> attribute. Named groups are needed for
several purposes such as animation and re-usable objects.</p>

<p>An example:</p>

<edit:example href='images/struct/grouping01.svg' image='no' link='yes'/>

<p>A <a>'g'</a> element can contain other <a>'g'</a> elements nested
within it, to an arbitrary depth.</p>


<h3 id="GElement">The <span class='element-name'>'g'</span> element</h3>

<edit:elementsummary name='g'/>

<h2 id="UnknownElement">Unknown elements</h2>

<div class="annotation svg2-requirement">
  <table>
    <tr>
      <th>SVG 2 Requirement:</th>
      <td>Have unknown elements treated as <a>'g'</a> for the purpose of rendering.</td>
    </tr>
    <tr>
      <th>Resolution:</th>
      <td><ul><li>
        <a href="http://www.w3.org/2012/01/13-svg-irc#T00-25-54">Accept having unknown elements treated as <span class='element-name'>'g'</span> for the purpose of rendering.</a></li>
        <li><a href="https://www.w3.org/2016/06/30-svg-minutes.html">Treat unknown elements as tspan when inside text. Presentation and inherited style apply, but nothing text-specific.</a>
        </li></ul></td>
    </tr>
    <tr>
      <th>Purpose:</th>
      <td>To allow fallbacks without the use of <a>'switch'</a>, and to align with the behavior of unknown elements in HTML.</td>
    </tr>
    <tr>
      <th>Owner:</th>
      <td>Nobody (no action)</td>
    </tr>
    <tr>
      <th>Status:</th>
      <td></td>
    </tr>
  </table>
</div>

<edit:elementsummary name='unknown'/>

<p class="issue" data-issue="70">Treating unknown elements as a generic container element, resulting in the
rendering of their child trees, and assigning the SVGUnknownElement interface to
unknown elements are both at risk, with no known implementations.</p>

<p>Unknown elements are all elements that are in the SVG namespace that are not
defined by this specification or any SVG module. The <a>SVGUnknownElement</a>
interface must be used for unknown elements.</p>

<p>Unknown elements in the SVG namespace are <a>renderable elements</a> and <a>container elements</a>.
They must render as if the unknown element
were replaced with a <a>'g'</a> element or <a>'tspan'</a>, according to context.
Any global attribute or property that is valid on any SVG graphics element
is also valid on unknown elements, and must be processed as normal.
This includes conditional processing attributes, ARIA attributes, data attributes,
and the <a>'lang'</a>, <a>'id'</a>, <a>'class'</a>, <a>'tabindex'</a> and <a>'style attribute'</a>.
Styles specified on unknown elements must be inherited by
their child elements according to the normal rules for inheritance for each style property.
</p>

<p>Known and unknown elements in other namespaces that occur as a child of any
SVG element except <a>'foreignObject'</a>, must not render unless
explicitly stated otherwise in this specification.</p>

<p>Known elements in the SVG namespace that occur in places where SVG's content
model doesn't explicitly allow it must not render unless
explicitly stated otherwise in this specification.</p>

<p>Consequently, in the following example:</p>
<ul>
<li>the <a>'path'</a> element inside the unknown <span class="element-name">'mysteryElement'</span> must render</li>
<li><span class="element-name">'hideElement'</span> and its contents must not render</li>
<li>the <a>'text'</a> element must not render the string contained
in the inner <a>'text'</a> element</li>
<li>the <a>'path'</a> element inside of <span class="element-name">'gradientExtension'</span>
must not render since the <a>'linearGradient'</a> element isn't directly rendered</li>
<li>regardless of whether the user agent supports XHTML or not,
the <span class="element-name">'div'</span> element and its contents must not render</li>
</ul>

<edit:example href='images/struct/unknownelms01.svg' image='no' link='yes'/>

<h2 id="Head">Defining content for reuse, and the <span class='element-name'>'defs'</span> element</h2>

<h3 id="Overview">Overview</h3>

<p>SVG allows a graphical object to be defined for later reuse.
To do this, SVG makes extensive use of the <a>URL reference</a>
construct [<a href="refs.html#ref-rfc3987">rfc3987</a>].
For example, to fill a rectangle with a linear gradient, a
<a>'linearGradient'</a> element may be defined with an
<a>'id'</a> property that may be referenced in the value for
the rectangle's <a>'fill'</a> property, as in the following:</p>

<pre class='xml'><![CDATA[
<linearGradient id="MyGradient">...</linearGradient>
<rect style="fill:url(#MyGradient)"/>
]]></pre>

<p>Some types of element, such as gradients, will not by themselves produce a graphical result. They can therefore be placed anywhere convenient. However, sometimes it is desired to define a graphical object and prevent it from being directly rendered. it is only there to be referenced elsewhere. To do this, and to allow convenient grouping defined content, SVG provides the <span class='element-name'>'defs'</span> element.</p>

<p>It is recommended that, where possible, referenced elements be defined
prior to the elements that use them, in document order.
Collecting all referenced elements
inside of a single <a>'defs'</a> element
near the top of the file
can make the markup easier to read and understand.
</p>

<h3 id="DefsElement">The <span class='element-name'>'defs'</span> element</h3>

<edit:elementsummary name='defs'/>

<p>The <a>'defs'</a> element is a container element for
<a href="struct.html#Head">referenced elements</a>. For understandability and
<a href="access.html">accessibility</a> reasons, it is recommended
that, whenever possible, referenced elements be defined inside
of a <a>'defs'</a>.</p>

<p>The content model for <a>'defs'</a> is the same as for the
<a>'g'</a> element; thus, any element that can be a child of a
<a>'g'</a> can also be a child of a <a>'defs'</a>, and vice versa.</p>

<p>Elements that are descendants of a <a>'defs'</a> are not rendered directly;
the <a>'display'</a> value for the <a>'defs'</a> element
must always be set to <span class="prop-value">none</span>
by the <a>user agent style sheet</a>,
and this declaration must have importance over any other CSS rule or presentation attribute.
Note, however, that the descendants of a <a>'defs'</a> are
always present in the source tree and thus can always be
referenced by other elements; thus, the value of the <a>'display'</a>
property on the <a>'defs'</a> element does not
prevent those elements from being referenced by other elements.</p>


<div class="ready-for-wider-review">
<h2 id="SymbolElement">The <span class='element-name'>'symbol'</span> element</h2>

<p>The <a>'symbol'</a> element is used to define graphical templates
which can be instantiated by a <a>'use'</a> element but which are not rendered
directly.</p>

<p>A <a>'symbol'</a> establishes a nested coordinate system
  for the graphics it contains.
  When a symbol is instantiated
  as the <a>referenced element</a> of a <a>'use'</a> element,
  it is therefore rendered very similarly to a nested <a>'svg'</a> element.</p>

<edit:elementsummary name='symbol'/>

<p>The <a>'x'</a>, <a>'y'</a>, <a>'width'</a>, and <a>'height'</a> geometry properties
  have the same effect as on an <a>'svg'</a> element,
  when the <a>'symbol'</a> is instantiated by a <a>'use'</a> element.
  In particular, if <a>'width'</a> and <a>'height'</a>
  compute to <span class="prop-value">auto</span>
  (and are not over-ridden by values on the instantiating <a>'use'</a> element),
  then they will be treated as a value of <span class="prop-value">100%</span>.
</p>

<p class="note">
  New in SVG 2.
  Allowing geometry properties to be specified on a symbol
  provides a more consistent rendering model,
  and allows authors to set a default size for each symbol
  (which may still be over-ridden by attributes on the <a>'use'</a> element).
</p>

<edit:with element='symbol'>

<h3 id="SymbolAttributes">Attributes</h3>

<dl class="attrdef-list">
  <dt>
    <table class="attrdef def">
      <tr>
        <th>Name</th>
        <th>Value</th>
        <th>Initial value</th>
        <th>Animatable</th>
      </tr>
      <tr>
        <td><dfn data-dfn-type="element-attr" data-dfn-for="symbol" id="SymbolElementRefXAttribute">refX</dfn></td>
        <td><a>&lt;length&gt;</a> | left | center | right</td>
        <td>(none)</td>
        <td>yes</td>
      </tr>
      <tr>
        <td><dfn data-dfn-type="element-attr" data-dfn-for="symbol" id="SymbolElementRefYAttribute">refY</dfn></td>
        <td><a>&lt;length&gt;</a> | top | center | bottom</td>
        <td>(none)</td>
        <td>yes</td>
      </tr>
    </table>
  </dt>
  <dd>
    <p class="note">
      New in SVG 2. Added to make it easier to align symbols to a
      particular point, as is often done in maps. Similar to the
      matching attributes on <a>'marker element'</a>.
    </p>

    <p class="annotation">
      Add refX/refY to symbol element. Resolved at
      <a href="http://www.w3.org/2014/04/08-svg-minutes.html#item12">Leipzig F2F</a>.
      Status: Done.
    </p>
    <p class="annotation">
      We will add top/center/bottom, left/center/right keywords to
      refX/refY on marker/symbol. Resolved at
      <a href="http://www.w3.org/2014/08/26-svg-minutes.html#item07">London
      F2F</a>. Values inspired by
      <a href="https://www.w3.org/TR/css3-background/#the-background-position">'background-position'</a>.
      Status: Done.
    </p>

    <p>
      The <a>'refX'</a> and <a>'refY'</a> attributes define the
      reference point of the symbol which is to be placed exactly at
      the symbol's <span class="prop-value">x,y</span> positioning coordinate,
      as defined by the cumulative effect of the <a>'x'</a> and <a>'y'</a>
      properties and any transformations on the <a>'symbol'</a>
      and its <a>host</a> <a>'use'</a> element.
    </p>
    <p>
      Keyword values have the same meaning as for the
      <a>'marker/refX'</a> and <a>'marker/refY'</a> attributes on the <a>'marker element'</a> element,
      resolving to 0%, 50%, or 100% in the applicable direction.
    </p>
    <p>
      Unlike other positioning attributes,
      <a>'refX'</a> and <a>'refY'</a>
      are interpreted as being in the coordinate system of the
      symbol contents, after application of the <a>'viewBox'</a>
      and <a>'preserveAspectRatio'</a> attributes.
      If one or both of the attributes is not specified,
      no adjustment is made in the corresponding dimension,
      and the top or left side of the symbol's rectangular viewport region
      (regardless of the <a>'viewBox'</a> coordinates)
      is positioned at the <span class="prop-value">x,y</span> point.
    </p>

    <p class="note">
      For backwards compatibility,
      the behavior when <a>'refX'</a> and <a>'refY'</a>
      are not specified on a <a>'symbol'</a>
      is different from when they are specified with a value of <span class="attr-value">0</span>,
      and therefore different from the behavior
      when equivalent attributes are not specified on a <a>'marker element'</a>.
    </p>

  </dd>
</dl>

<h3 id="SymbolNotes">Notes on symbols</h3>

<p>The use of <a>'symbol'</a> elements for graphics that are used multiple
times in the same document adds structure and semantics.
Closely related to the <a>'symbol'</a> element are the
<a>'marker element'</a> and <a>'pattern'</a> elements;
all three define a container of graphical content
that can be rendered repeatedly at various positions and scales in the SVG.
However, while <a>re-used graphics</a> in a pattern and marker
provide a graphical effect on another element,
the content in a <a>'symbol'</a> will be embedded
as fully interactive content, within a <a>use-element shadow tree</a>.
</p>

<p>The <a href="styling.html#UAStyleSheet">user agent style sheet</a> sets
the <a>'overflow'</a> property for <a>'symbol element'</a> elements to
<span class="prop-value">hidden</span>, which causes a rectangular clipping
path to be created at the bounds of symbol's SVG viewport.  Unless the
<a>'overflow'</a> property is overridden, any graphics within the symbol which
goes outside of the symbol's SVG viewport will be clipped.</p>

<p><a>'symbol'</a> elements must never be rendered directly;
their only usage is as something that can be referenced
using the <a>'use'</a> element.
<!--
The <a>'display'</a> property does not apply
to the <a>'symbol'</a> element; thus, <a>'symbol'</a> elements are
not directly rendered even if the <a>'display'</a> property is set to a
value other than <span class="prop-value">none</span>, and <a>'symbol'</a>
elements are available for referencing even when the
<a>'display'</a> property on the <a>'symbol'</a> element or any of its
ancestors is set to <span class="prop-value">none</span>.
-->
The user agent must set the
<a>'display'</a> property on the <a>'symbol'</a> element
to <span class="prop-value">none</span>,
as part of the <a>user agent style sheet</a>,
and this declaration must have importance over any other CSS rule or presentation attribute.
</p>

<p>The generated <a>instance</a> of a <a>'symbol'</a>
that is the direct <a>referenced element</a> of a <a>'use'</a> element
must always have a computed value of <span class="prop-value">inline</span>
for the <a>'display'</a> property.
In other words, it must be rendered whenever the host <a>'use'</a> element is rendered.
The <a>user agent style sheet</a> again defines this
declaration to have importance over any other CSS rule or presentation attribute.
Any other <a>'symbol'</a> that is cloned
to create an <a>element instance</a>
within the <a>use-element shadow tree</a>
behaves as a symbol definition, and must not be rendered.
</p>


</edit:with>

<h2 id="UseElement">The <span class='element-name'>'use'</span> element</h2>

<div class="annotation svg2-requirement">
  <table>
    <tr>
      <th>SVG 2 Requirement:</th>
      <td>Allow <a>'use'</a> to reference an external document's root element by omitting the fragment.</td>
    </tr>
    <tr>
      <th>Resolution:</th>
      <td><a href="http://www.w3.org/2011/10/28-svg-irc#T00-33-43">We will relax referencing requirements to particular elements to allow dropping fragments to mean referencing root element, where it makes sense, such as with use, in SVG 2.</a></td>
    </tr>
    <tr>
      <th>Purpose:</th>
      <td>To avoid requiring authors to modify the referenced document to add an ID to the root element.</td>
    </tr>
    <tr>
      <th>Owner:</th>
      <td>Cameron (<a href="http://www.w3.org/Graphics/SVG/WG/track/actions/3417">ACTION-3417</a>)</td>
    </tr>
    <tr>
      <th>Status:</th>
      <td>Done</td>
    </tr>
  </table>
</div>

<edit:with element='use'>

<edit:elementsummary name='use'/>

<p>The <a>'use'</a> element
references another element, a copy of which
is rendered in place of the <a>'use'</a> in the document.
The <a>referenced element</a> may be a <a>container element</a>,
in which case a copy of
the complete SVG document subtree rooted at that element is used.
</p>
<p>
The cloned content inherits styles from the <a>'use'</a> element
and can be the target of user events.
However, these cloned <a>element instances</a> remain linked to the referenced source
and reflect DOM mutations in the original.
In addition, all style rules that apply in the scope of the referenced element
also apply in the scope of the cloned <a>shadow tree</a>.
</p>


    <p>The <a>'x'</a>, <a>'y'</a>, <a>'width'</a> and <a>'height'</a>
    geometric properties specify the positioning of the referenced element.
    The <a>'width'</a> and <a>'height'</a> attributes
    only have an effect if the <a>referenced element</a>
    defines a viewport (i.e., if it is a <a>'svg'</a> or <a>'symbol'</a>);
    if so, a value other than <span class="prop-value">auto</span>
    for the <a>'use'</a> element overrides the value
    of the corresponding geometric property on that element.
    </p>
    <p>A negative value for <a>'width'</a> or <a>'height'</a>
    must be treated as an illegal value.
    If <a>'width'</a> or <a>'height'</a> is zero,
    and the properties have an effect on the <a>referenced element</a>,
    then rendering of that element will be disabled.</p>

    <p class="note">
    The <a>'x'</a> and <a>'y'</a> properties
    affect the user coordinate system for the element.
    See the <a href="#UseLayout">Layout</a> section for implementation details.
    </p>

<dl class="attrdef-list">
  <dt>
    <table class="attrdef def">
      <tr>
        <th>Name</th>
        <th>Value</th>
        <th>Initial value</th>
        <th>Animatable</th>
      </tr>
      <tr>
        <td><dfn id="UseElementHrefAttribute">href</dfn></td>
        <td>URL <a href="types.html#attribute-url" class="syntax">[URL]</a></td>
        <td>(none)</td>
        <td>yes</td>
      </tr>
    </table>
  </dt>
  <dd>
    <p>An <a href="linking.html#URLReference">URL reference</a> to the
    element/fragment within an SVG document to be cloned for
    rendering.</p>
    <p>The <a>'use'</a> element can reference an entire SVG document
    by specifying an <a>'href'</a> value without a fragment.
    Such references are taken to be referring to the root element
    of the referenced document.</p>
    Refer to the common handling defined for <a
    href="linking.html#linkRefAttrs">URL reference attributes</a> and
    <a href="linking.html#XLinkRefAttrs">deprecated XLink attributes</a>.
  </dd>
</dl>

<p class="note">New in SVG 2.
An <a>'href'</a> without a fragment allows an entire SVG document to be referenced
without having to ensure that it has an ID on its root element.</p>

<p>
User agents may restrict external resource documents for security
reasons. In particular, this specification does not allow cross-origin resource requests in <a>'use'</a>.
A future version of this or another specification may provide a method of securely enabling cross-origin re-use
of assets.
</p>

<p>When the <a>'href'</a> attribute is set
(or, in the absence of an <a>'href'</a> attribute, an <a>'xlink:href'</a> attribute),
the user agent must <a href="linking.html#processingURL">process the URL</a>.
The target element that results from URL processing is the <a>referenced element</a> of the <a>'use'</a>.
</p>

<p>If the <a>referenced element</a> that results from resolving the URL
  is neither an SVG element
  nor an HTML-namespaced element
  <a href="embedded.html#HTMLElements">that may be included as a child of an SVG container element</a>,
  then the reference is <a>invalid</a> and the <a>'use'</a> element is in error.
</p>
<p>
  If the referenced element is a (shadow-including) ancestor
  of the <a>'use'</a> element,
  then this is an <a>invalid circular reference</a>
  and the <a>'use'</a> element is in error.
</p>
<p>
  Otherwise, the user agent must generate a <a>shadow tree</a>
  of <a>re-used graphics</a> to render as the contents of the <a>'use'</a> element,
  as described in the next section, <a href="#UseShadowTree">The use-element shadow tree</a>.
</p>

<p>A <a>'use'</a> that has an <a>unresolved</a> or <a>invalid</a> URL reference
  is not rendered.
  For the purpose of bounding box calculations,
  it is equivalent to an empty container element.</p>

</edit:with>


<h3 id="UseShadowTree">The use-element shadow tree</h3>

<p>The <a>re-used graphics</a> generated by a <a>'use'</a> element
are defined in terms of a <a>shadow tree</a>.
In terms of interactivity and style inheritance,
they are therefore quite different from other types of <a>re-used graphics</a> in SVG,
such as <a>'pattern'</a> and <a>'marker element'</a> content.
</p>

<p>
Elements in the shadow tree are rendered as if
the <a>'use'</a> element was a container and they were its children.
However, the SVG Document Object Model (DOM) only contains
the <a>'use'</a> element and its attributes.
The SVG DOM does not include the
element instances as children of the <a>'use'</a> element.
</p>

<p>User agents that support scripting and the document object model
must implement the <a>use-element shadow tree</a> as described in this section
and in conformance with the <a href="refs.html#ref-dom">dom</a> specification <a href="refs.html#ref-dom">[dom]</a>,
or its future replacement.
In contrast, user agents that do <em>not</em> support
the dynamic interactive processing mode
may not need to implement all the details of the shadow DOM.
However, all user agents must ensure that the <a href="#UseLayout">layout</a>
and <a href="#UseStyleInheritance">style inheritance</a> for the re-used graphics,
and any <a href="#UseMultimedia">multimedia</a>
and <a href="#UseAnimations">declarative animations</a> if applicable,
are rendered in the same way as if the shadow DOM was implemented.
</p>

<p>The following definitions apply when discussing <a>'use'</a> elements
  and their shadow trees:</p>

<dl>
  <dt id="TermReferencedElement">referenced element</dt>
  <dd>The element specified by the <a>'href'</a> (or <a>'xlink:href'</a>) attribute on the <a>'use'</a> element, or the root element of a document referenced by that attribute if the URL provided does not include a target fragment that links to a specific element <a>'id'</a>.</dd>

  <dt id="TermReferencedDocumentSubtree">referenced document subtree</dt>
  <dt>referenced graphics</dt>
  <dd>The referenced element, and all of its descendent nodes.</dd>

  <dt id="TermShadowRoot">shadow root</dt>
  <dd>A <a>ShadowRoot</a> object,
  a type of <a>DocumentFragment</a> node which is associated with a host <a>Element</a>,
  and which contains the content that will be used to render that host.
  A shadow root should be implemented in conformance with the <a href="refs.html#ref-dom">dom</a> specification <a href="refs.html#ref-dom">[dom]</a>,
  or its future replacement.
  </dd>

  <dt id="TermShadowHost">shadow host</dt>
  <dt>host</dt>
  <dd>An element that has an associated shadow root;
    usage is consistent the definition of <a href="https://dom.spec.whatwg.org/#concept-documentfragment-host">host</a> in the DOM standard.
  </dd>

  <dt id="TermShadowTree">shadow tree</dt>
  <dd>A node tree whose root is a shadow root;
    usage is consistent the definition of <a href="https://dom.spec.whatwg.org/#shadow-trees">shadow tree</a> in the DOM standard.
  </dd>

  <dt id="TermUseElementShadowTree">use-element shadow tree</dt>
  <dd>A shadow tree whose host is a <a>'use'</a> element,
  which contains element instances generated by cloning the referenced graphics.
  </dd>

  <dt id="TermElementInstance">element instance</dt>
  <dt>instance</dt>
  <dd>An element in the <a>use-element shadow tree</a>,
    which is generated by cloning a corresponding element in the referenced document subtree.
  </dd>

  <dt id="TermInstanceRoot">instance root</dt>
  <dd>The <a>element instance</a> for the referenced element;
    it is always a direct child of the <a>'use'</a> element's shadow root.
  </dd>

  <dt id="TermCorrespondingElement">corresponding element</dt>
  <dd>For each element instance,
    the element in the referenced document subtree from which it is cloned.</dd>

  <dt id="TermCorrespondingUseElement">corresponding use element</dt>
  <dd>For each element instance,
    the <a>'use'</a> element which causes it to be rendered in the document.
    This is the instance's shadow root's host <a>'use'</a> element
    <em>if</em> that element is not itself an element instance within a <a>'use'</a> element shadow tree,
    or is that element's corresponding use element otherwise,
    recursively exiting shadow trees as many times as necessary
    to reach a <a>'use'</a> element that was not itself generated
    as part of the shadow tree of another <a>'use'</a> element.
  </dd>
</dl>

<p>When the user agent successfully resolves a <a>'use'</a> element
to identify a <a>referenced element</a>,
the user agent must create a
<a>use-element shadow tree</a> whose host is the <a>'use'</a> element itself.
The shadow tree must be created even if
the <a>'use'</a> element is not rendered
because it is a descendent of a <a>never-rendered element</a>,
because of conditional processing,
or because of the <a>'display'</a> property being set to <span class="prop-value">none</span>
on it or an ancestor element.
</p>

<p>
Each node in the shadow tree is an <a>instance</a> of a corresponding node
from the <a>referenced document subtree</a>.
The shadow nodes all descend from the <a>instance root</a>,
which is the instance of the <a>referenced element</a>,
and which itself is a direct child of the <a>shadow root</a> node.
</p>
<p>
The shadow tree is open (inspectable by script), but read-only.
Any attempt to directly modify the elements, attributes, and other nodes in the shadow tree
must throw a <code>NoModificationAllowedError</code>.
</p>

<p>
Within a <a>use-element shadow tree</a>,
<a>'script'</a> elements are inert (do not execute);
<a>'audio'</a> and <a>'video'</a> elements
are subject to the limitations specified in the <a href="#UseMultimedia">Multimedia</a> section.
</p>

<p class="note">
  Previous versions of SVG restricted the contents
  of the shadow tree to SVG graphics elements.
  This specification allows any valid SVG document subtree
  to be cloned.
  Cloning non-graphical content, however,
  will not usually have any visible effect.
</p>

<p>
If the <a>referenced element</a> is in an external file,
then all <a>URL references</a> in attributes and style properties
must be made absolute as described in <a href="linking.html#processingURL-absolute">Generating the absolute URL</a>,
before copying the value to the <a>element instances</a>.
The shadow tree itself uses the same document base URL
as the document that includes it.
</p>

<p>
The user agent must ensure that
all mutations to the <a>referenced document subtree</a> are reflected in the shadow tree.
This includes changes to elements, attributes, and text and other nodes.
In addition, changes to the stylesheets in effect for the referenced graphics
must be reflected in changes to the stylesheets in the shadow tree's scope,
as described futher in the section on <a href="#UseStyleInheritance">style inheritance</a>.
</p>

<p>
If either the <a>'use'</a> element or the <a>referenced element</a> is altered
in a way that causes the <a>'use'</a> element's URL reference to become <a>unresolved</a> again,
then the entire shadow tree for that use element is discarded.
</p>

<p>When a <a>'use'</a> references
another element which is another <a>'use'</a> or whose content contains a
<a>'use'</a> element, then the shadow DOM
cloning approach described above is recursive. However, a set
of references that directly or indirectly reference a element
to create a circular dependency is an <a>invalid circular reference</a>.
The <a>'use'</a> element or element instance
whose shadow tree would create the circular reference
is in error and must not be rendered by the user agent.</p>


<h3 id="UseLayout">Layout of re-used graphics</h3>

<p>The value of the <a>'x'</a>, <a>'y'</a>, <a>'width'</a> and <a>'height'</a> properties
on a <a>'use'</a> element
are used to position the re-used graphics
and to set the viewport size
if the <a>referenced element</a> defines a nested viewport.
The effect of these properties on a <a>'use'</a> element
is notably different from their effect on a <a>graphics element</a>,
or from their effect in CSS box layout.
</p>

<p>
  The <a>'x'</a> and <a>'y'</a> properties define
  an additional transformation
  (<span class="attr-value">translate(x,y)</span>,
  where <span class="attr-value">x</span>
  and <span class="attr-value">y</span> represent the computed value of the corresponding property)
  to be applied to the <a>'use'</a> element,
  after any transformations specified with other properties
  (i.e., appended to the right-side of the transformation list).
</p>

<div class="note">
  <p>
  For historical reasons,
  the supplemental transformation is applied to the <a>'use'</a> element itself,
  rather than solely to the re-used content in the shadow tree.
  This affects the coordinate system used for
  any masks, clipping paths, or filters
  applied to the <a>'use'</a> element
  and calculated in <span class="attr-value">userSpaceOnUse</span> units.
  </p>
  <p>
  To apply <span class="attr-value">userSpaceOnUse</span> graphical effects in an un-transformed coordinate space,
  while also using the <a>'x'</a> and <a>'y'</a> to position the graphics,
  authors can nest the <a>'use'</a> element inside a <a>'g'</a>,
  and apply the graphical effects to the <a>'g'</a> element.
  </p>
</div>

<p>
  The <a>'width'</a> and <a>'height'</a> properties
  on the <a>'use'</a> element
  override the values for the corresponding properties
  on a referenced <a>'svg'</a> or <a>'symbol'</a> element
  when determining the used value for that property on the <a>instance root</a> element.
  However, if the computed value for the property on the <a>'use'</a> element is <span class="prop-value">auto</span>,
  then the property is computed as normal for the element instance.
</p>
<p>
  These properties can therefore be used to scale a graphic
  that defines its own coordinate system,
  each time it is re-used.
  Because <span class="prop-value">auto</span> is the initial value,
  if dimensions are not explicitly set on the <a>'use'</a> element,
  the values set on the <a>'svg'</a> or <a>'symbol'</a> will be used as defaults.
</p>
<p>
  The <a>'width'</a> and <a>'height'</a> properties
  on the <a>'use'</a> element have no effect
  if the <a>referenced element</a> does not
  <a href="coords.html#EstablishingANewSVGViewport">establish a new viewport</a>.
  In particular, the <a>'use'</a> element does not itself establish a new viewport,
  and therefore does not affect the interpretation of percentages in the re-used graphics.
</p>

<p>
  In all other ways,
  rendering and layout of elements within the
  <a>use-element shadow tree</a>
  occurs as if the <a>'use'</a> element was a container for its shadow content.
  In particular, unless elements within the shadow tree establish a new viewport,
  they must be drawn in the coordinate system in which the <a>'use'</a> element is defined
  (including any cumulative transformations).
  This affects the interpretation of percentage lengths,
  and also graphical effects with <span class="prop-value">userSpaceOnUse</span> units.
</p>

<h3 id="UseStyleInheritance">Style Scoping and Inheritance</h3>

<p>The <a>use-element shadow tree</a>, like other shadow trees,
  exhibits style encapsulation,
  as defined in the <a href="https://www.w3.org/TR/css-scoping-1/">CSS Scoping</a> module <a href="refs.html#ref-css-scoping-1">[css-scoping-1]</a>.
  This means that elements in the shadow tree inherit styles
  from its <a>host</a> <a>'use'</a> element,
  but that style rules defined in the outer document
  do not match the elements in the shadow tree.
  Instead, the shadow tree maintains its own list of stylesheets,
  whose CSS rules are matched against elements in the shadow tree.
</p>

<p class="note">
  Presentation attributes and the <a>'style attribute'</a> attribute
  are cloned from the elements in the <a>referenced graphics</a>
  into the <a>element instances</a>
  in the same manner as other attributes.
</p>

<p>
  When the <a>referenced element</a>
  is from the same document as the <a>'use'</a> element,
  the same document stylesheets will apply in
  both the original document and the shadow tree document fragment.
  Any changes to the stylesheets in the main document
  also affect the shadow tree;
  the <code>StyleSheetList</code> object accessed through the
  document and shadow root document fragment's
  <code>styleSheets</code> properties must be identical.
  If a <a>'style element'</a> element is duplicated
  as part of the <a>referenced document subtree</a>,
  then the <code>styleSheet</code> property on the <a>element instance</a>
  points to the same object as for the <a>corresponding element</a>.
</p>

<p>
  When the <a>referenced element</a>
  is from an external document,
  the stylesheet objects generated when processing that document
  apply to the shadow tree, and are read-only.
  All <a>URL references</a> in the stylesheet,
  including fragment-only references,
  must be made absolute, relative to the URL of the document
  that contains the <a>referenced element</a>.
  User agents may re-use the same stylesheet objects for any shadow trees
  that reference that same external document.
</p>

<p>
  Style rules that are scoped to the shadow tree
  cannot normally affect any elements in the main document.
  Similarly, style rules in the main document can only
  affect the shadow tree elements by changing inherited values.
  However, <a href="https://www.w3.org/TR/css-scoping-1/">CSS Scoping</a>
  defines special selectors for styling the <a>host</a> element from within the shadow tree,
  or for adjusting styles within the shadow tree
  in response to changes in the host's context
  <a href="refs.html#ref-css-scoping-1">[css-scoping-1]</a>.
</p>

<p>
  CSS media queries within a shadow tree's scope
  are evaluated using the same device features and dimensions
  as the corresponding "light" document
  (that is, the document that contains the <a>corresponding use element</a>
  for the shadow tree, after recursively exiting all nested shadow trees).
</p>

<div class="note">
  <p>
    In most cases,
    the <a>element instance</a> in the shadow tree will match the same style rules
    as its <a>corresponding element</a> in the original document.
    However, if a CSS rule uses a <a href="https://drafts.csswg.org/selectors/#complex">complex selector</a>
    to match an element based on its ancestors or siblings,
    and those ancestors or siblings are not cloned as part of the shadow tree,
    then that rule would no longer match the <a>element instance</a>.
    Similarly, child-indexed pseudo-classes
    such as <code>nth-of-type</code> and <code>nth-child</code>
    may apply to one element but not the other.
    This represents a change
    from how style cloning was defined in previous versions of SVG.
  </p>

  <p>
    The following example demonstrates both the consistent and changed style-matching rules.
    The circle on the left is re-used to draw the circle on the right.
    The original circle has styles set in various ways:
  </p>
  <ul>
    <li><a>'stroke-width'</a> (20) is set in a presentation attribute on the circle itself.</li>
    <li><a>'stroke-opacity'</a> (0.7) is set via a CSS rule with a simple selector matching the circle tag name.</li>
    <li><a>'stroke'</a> color (green) is set using a complex CSS selector, matching the circle as a descendent of an element with class <code>special</code>.</li>
    <li><a>'fill'</a> color is not set directly on the circle, so is inherited from the style set on the containing <a>'g'</a> element (blue).</li>
  </ul>
  <p>
    In the SVG 1.1 style-cloning model,
    the <a href="https://www.w3.org/TR/css-cascade-3/#specified">specified style values</a>
    would be cloned from the original element to the element instance.
    The re-used circle would have the same styles as the original,
    except that the <a>'fill'</a> value would be inherited from the <a>'use'</a> (orange)
    instead of from the <a>'g'</a> (blue).
  </p>
  <p>
    In the shadow DOM model required by SVG 2,
    the styles for the re-used circle are calculated as follows:
  </p>
  <ul>
    <li>the <a>'stroke-width'</a> (20) presentation attribute is cloned to the element instance.</li>
    <li>the CSS rule setting <a>'stroke-opacity'</a> (0.7) is part of the CSS stylesheet cloned into the shadow tree; it matches the circle tag name of the <a>element instance</a>, so is applied.</li>
    <li>the CSS rule with the complex selector is also part of the cloned stylesheet, but it does not match the <a>element instance</a> of the circle, which is not a descendent of an element with class <code>special</code>; instead, <a>'stroke'</a> color on the circle is inherited from the host <a>'use'</a> element (purple).</li>
    <li><a>'fill'</a> color is still not set directly, so is once again inherited from the host <a>'use'</a> element.</li>
  </ul>
  <p>
    The re-used circle therefore differs from the original in both fill color (because it inherits from a different element) and stroke color (because the complex selector no longer matches).
  </p>

  <edit:example href='images/struct/Use-changed-styles.svg' name='Use-changed-styles' description="A 'use' element copying a 'circle', with various style matching rules demonstrated" link='yes' image='yes'/>

  <p>
    Previous versions of SVG
    were not clear about how dynamic pseudo-classes
    (such as <code>:hover</code>)
    should apply to element instances.
    The shadow tree model requires that all such pseudo-classes
    are matched independently to the
    <a>element instance</a> or to its <a>corresponding element</a>,
    depending on which element the user is interacting with.
  </p>
</div>

<div class="example">
  <p>
  Specifying <span
  class="prop-value">'visibility:hidden'</span> on a <a>'use'</a> element does not guarantee
  that the referenced content will not be rendered.
  Unlike the <a>'display'</a> or the <a>'opacity'</a> properties,
  the <a>'visibility'</a> property does not appy directly to container elements,
  and therefore does not apply directly to the <a>'use'</a> element.
  Because <a>'visibility'</a> is normally inherited,
  hiding the use element will often hide the child content,
  but not necessarily.
  If any graphics elements in the shadow tree have
  <span class="prop-value">'visibility:visible'</span> specified, then that
  element will be visible even if the <a>'use'</a> element specifies <span
  class="prop-value">'visibility:hidden'</span>.</p>

  <p>
    In the following example, key style rules are as follows:
  </p>
<pre class="css">
.dark {
  visibility: hidden;
}
.eyes {
  visibility: visible;
}
svg:hover .dark, svg:focus .dark {
  visibility: visible;
}
</pre>
  <p>
    The "dark" class is set on the group containing the <a>'use'</a> elements,
    so all parts of the re-used graphics inherit the hidden visibility setting,
    except for the subtrees with class "eyes", where it is reset to visible.
    Upon hovering or focusing the graphic, the hiding effect is removed.
  </p>
  <div class="figure">
    <img alt="Multiple use-copies of a creature-symbol on a black background; the use elements have visibility: hidden, but the creatures' eyes have visibility: visible." src="images/struct/Use-visibility-inheritance.png" />
    <p class="caption">Example Use-visibility-hidden, default styles</p>
  </div>
  <div class="figure">
    <img alt="Multiple use-copies of a rabbit-symbol on a light green background; each rabbit has different=coloured fur, but the same pink noses and white fluffy tails." src="images/struct/Use-visibility-inheritance.2.png" />
    <p class="caption">Example Use-visibility-hidden, interactive styles</p>
  </div>

  <p class="view-as-svg"><a href="images/struct/Use-visibility-inheritance.svg">View this example as SVG</a></p>

  <p>
    The example also demonstrates inheritance of other style properties
    (<a>'fill'</a> and <a>'stroke'</a>)
    specified on the <a>'use'</a> elements,
    and how these are also not used if any elements within the symbol
    specify explicit values (e.g., the pink noses and ears and the white tails).
  </p>
</div>

<h3 id="UseMultimedia">Multimedia in use-element shadow trees</h3>

<p>
  When a <a>use-element shadow tree</a> includes
  <a>'audio'</a> or <a>'video'</a> elements,
  the following behaviors must be enforced:
</p>
<ul>
  <li>
  The user agent must synchronize playback of the media
  with the <a>corresponding element</a>
  (if it is rendered as part of the same document)
  and any other <a>instances</a> of the same <a>corresponding element</a>
  in the document.
  </li>
  <li>
  The <a>instance</a> must not play any audio
  if the <a>'use'</a> element is not rendered.
  </li>
  <li>
  If user-agent provided playback controls are included
  for the <a>corresponding element</a>
  (or would be included, if the element was rendered),
  then they must be included for all instances in the document,
  and a user action on any instance must control playback on them all.
  </li>
</ul>

<h3 id="UseAnimations">Animations in use-element shadow trees</h3>

<p>
  The <a href="https://www.w3.org/TR/web-animations-1/">Web Animations API</a>
  [<a href="refs.html#ref-web-animations-1">web-animations-1</a>]
  and the <a href="https://svgwg.org/specs/animations/">SVG Animations</a> specification
  [<a href="refs.html#ref-svg-animation">svg-animation</a>]
  define non-CSS ways to animate attributes and styles
  on targetted elements without directly manipulating DOM properties
  (see the <a href="animate.html">Animation appendix</a> for details).
  User agents that implement those features
  must ensure that all animations
  that apply to an element in a <a>referenced document subtree</a>
  also apply to instances of that element
  in a <a>use-element shadow tree</a>,
  as described in this section.
</p>

<div class="note">
  <p>
    Scripted animations created by directly manipulating
    attributes on elements in the <a>referenced graphics</a>
    (including the <a>'style attribute'</a> attribute or its IDL property)
    will be propagated to the <a>element instances</a>
    in the shadow tree in the same manner as any other DOM manipulations.
  </p>
  <p>
    Animation effects applied using CSS
    will be duplicated along with other stylesheet rules,
    following the procedure specified in the
    <a href="#UseStyleInheritance">Style Scoping and Inheritance</a> section.
  </p>
</div>

<p>
  All animations within a <a>use-element shadow tree</a>
  operate in the same document timeline as for the
  <a>corresponding use element</a>,
  regardless of whether the <a>referenced element</a>
  is from the same or an external document.
</p>

<p>
  For animation effects applied
  using a <a href="https://www.w3.org/TR/web-animations-1/">Web Animations API</a> method
  <a href="refs.html#ref-web-animations-1">[web-animations-1]</a>,
  if the target of the animation is a <a>corresponding element</a>
  to an <a>element instance</a> in a shadow tree,
  the user agent must construct a <a>ShadowAnimation</a>
  whose source is that <a>Animation</a> object
  and whose target is the <a>element instance</a>.
  If there are multiple instances of the element in different trees,
  then there will be multiple shadow animations, one for each.
</p>
<p>
  The user agent must create such a <a>ShadowAnimation</a>
  for all Web Animations API animations in effect
  (including pending and frozen animations)
  at the time the shadow tree is generated,
  and for any new animations applied while the shadow tree exists.
  The user agent must not create <a>ShadowAnimation</a> objects
  for CSS animations or animation elements
  (as these are duplicated separately).
</p>

<p class="note">
  As part of the interface definition,
  a <a>ShadowAnimation</a> is read-only,
  and must reflect any changes to its <a>ShadowAnimation::sourceAnimation</a>.
</p>

<p>
  Any attempts to directly apply new animations
  to a target that is a read-only <a>element instance</a> (or pseudo-element)
  within a <a>use-element shadow tree</a>
  must throw a <code>NoModificationAllowedError</code>.
</p>

<p>
  For each <a>animation element</a> [<a href="refs.html#ref-svg-animation">svg-animation</a>]
  that targets an element in the
  <a>referenced document subtree</a>,
  the user agent must ensure that an equivalent animation element
  is in effect in the <a>use-element shadow tree</a>.
  If the animation element itself is part of the referenced document subtree,
  then this happens as a matter of course through the creation
  of an <a>element instance</a> for the animation element.
  Otherwise, the user agent must generate an <a>element instance</a>
  for the animation element
  that has the same effect as if it was a node in the shadow tree.
  The effective document order for these generated animation elements
  must be the same as the document order for their <a>corresponding elements</a>.
</p>

<p>
  Each animation element or instance must only affect a target element
  in the same node tree (shadow or light),
  regardless of whether the targetting is implicit (the parent element)
  or explicit (a URL cross-reference to an element <a>'id'</a>).
  In this way, the one-to-one relationship between animation elements
  and target elements is preserved.
</p>

<p class="note">
  The <a>'id'</a> attribute is cloned, like any other attribute,
  from the <a>corresponding element</a> to the <a>element instance</a>;
  This does not conflict with the requirement for <a>'id'</a> to be unique,
  because the clone and the original are in distinct node trees.
</p>

<p>
  All animation elements, in the document or in the shadow trees,
  which are timed to begin or end in response to an event
  on another element identified by its <a>'id'</a> attribute,
  must also begin or end when any <a>instance</a> of an element with that <a>'id'</a>
  receives the same event.
  This is consistent with how event listeners on a
  referenced element also listen to events on instances of that element,
  as described in the section on
  <a href="#UseEventHandling">Event handling in use-element shadow trees</a>.
  This behavior does not apply to animation begin or end times
  defined only by an event and not by an <a>'id'</a>
  (and therefore implicitly listening for the event on the target element);
  in that case, each animation element is only triggered by its own target.
</p>

<p>
  At the time an <a>instance</a> of an animation element
  is generated within a shadow tree,
  if there is an active animation associated with the <a>corresponding element</a>
  (including a frozen animation),
  and the timing event that initiated that animation would also have initiated the instance if it existed,
  then the animation for the <a>element instance</a> must be initiated,
  with its begin time
  adjusted backwards in the document timeline
  to match the timing of the <a>corresponding element</a>.
</p>

<div class="note">
  <p>
    In many cases,
    the requirements of this section mean that
    the <a>element instance</a> and its <a>corresponding element</a>
    will animate synchronously.
    This will be the case if the animation is purely time-based,
    or if it begins and ends in response to user interaction
    on an element referenced by its <a>'id'</a>.
    However, if the animation is triggered by a user interaction event
    on the targetted element (implicitly),
    then only the element or element instance that receives the interaction event
    will display the animation.
  </p>
  <p>
    This is a change from previous versions of SVG,
    which required all animations on the <a>corresponding element</a> to be mirrored,
    regardless of user interaction,
    but which did not offer clear guidance for responding to
    user interactions with the element instances.
    The change ensures that interactive animations declared with animation elements
    behave in the same manner as interactive CSS styles and CSS animations.
  </p>
  <p>
    In order to create animations
    that apply to all instances when any instance or the original element
    receives an event,
    specify the element <a>'id'</a> explicitly:
  </p>
  <pre><code>
&lt;set href="#target" begin="mouseover" ... />
  &lt;!-- only affects the element that is moused over --&gt;

&lt;set href="#target" begin="target.mouseover" ... />
  &lt;!-- affects all instances of the element with the id 'target',
          in all light and shadow node trees,
          when any of them are moused over --&gt;
  </code></pre>
</div>



<h3 id="UseEventHandling">Event handling in use-element shadow trees</h3>

<p>Element in a <a>use-element shadow tree</a>
  can both listen for and be the target of DOM events.
  Event retargetting provides encapsulation,
  so that the details of the shadow DOM structure
  are masked when an event bubbles out of the shadow tree and into the light.
</p>

<p class="note">
  Event retargeting is new in SVG 2.
  It provides consistency with the Shadow DOM specification,
  with existing implementations,
  and with the expectations of authors who are only concerned with elements in the main DOM.
</p>

<p>
  Any event listeners defined on an element
  in the <a>referenced graphics</a>
  must also listen for the same event, at the same capture phase,
  on each <a>instance</a> of that element in a <a>use-element shadow tree</a>.
  This includes event listeners assigned using <a>event attributes</a>
  (which would be duplicated as with any other DOM attribute)
  and also event listeners assigned using the <a href="https://www.w3.org/TR/dom/#dom-eventtarget-addeventlistener"><code>addEventListener</code></a> method.
  The user agent must ensure that the list of event listeners
  for each <a>element instance</a> is synchronized to match
  its <a>corresponding element</a>.
  An event listener cannot be directly assigned
  to a read-only <a>element instance</a> in a <a>use-element shadow tree</a>.
  Any attempt to add an event listener to such an element
  must throw a <code>NoModificationAllowedError</code>.
</p>

<p>Events in the <a>use-element shadow tree</a>
  are dispatched and bubble according to the shadow tree
  <a href="https://dom.spec.whatwg.org/#events">event path and event retargeting algorithm</a> [<a href="refs.html#ref-dom">DOM</a>].
</p>

<div class="note">
  <p>
    In general, the event path for a <a>use-element shadow tree</a>
    is constructed from the ancestors of the event target element
    up to the <a>shadow root</a>,
    then the <a>host</a> <a>'use'</a> element
    and its event path through to the document window.
    This means that, in the capture phase,
    an event propagates from the window through the regular document tree
    to the <a>'use'</a> element
    and then to the shadow root object
    and down through the shadow tree
    (or recursively through multiple shadow trees)
    to the event target element.
    In the bubbling phase, the event passes in the opposite direction,
    from the shadow tree elements to the shadow root,
    then to the <a>'use'</a> element and its ancestors.
  </p>
  <p>
    The event retargeting algorithm ensures that
    from the perspective of event listeners
    on the <a>'use'</a> element or its ancestors,
    all events targetted to <a>element instances</a> in the shadow tree
    instead have a target of the <a>'use'</a> element itself.
    If the event has both a <a href="https://www.w3.org/TR/dom/#dom-event-target"><code>target</code></a>
    and a <code>relatedTarget</code>,
    and both of these properties would be retargeted
    to point to the same <a>'use'</a> element,
    then the event is not propagated at all outside of the shadow tree.
    This would occur, for example,
    if focus moved from one element inside the shadow tree to another.
    Certain other event types are constrained to
    not propagate outside of the shadow tree in which they were created.
  </p>
  <p>
    In contrast, event listeners that process the event
    while it is propagating through the shadow tree
    (because the listener has been added to a
    <a>corresponding element</a>)
    will receive the event with its <a href="https://www.w3.org/TR/dom/#dom-event-target"><code>target</code></a>
    pointing to a read-only <a>element instance</a> in the shadow tree.
    The <a>SVGElementInstance::correspondingElement</a>
    and <a>SVGElementInstance::correspondingUseElement</a>
    properties of that <a>element instance</a>
    can be used to connect it to the modifiable elements in the main DOM.
  </p>
</div>

</div><!-- ready-for-wider-review -->

<h2 id="ConditionalProcessing">Conditional processing</h2>

<h3 id="ConditionalProcessingOverview">Conditional processing overview</h3>

<p>SVG contains a <a>'switch'</a> element along with
attributes <a>'requiredExtensions'</a> and <a>'systemLanguage'</a> to provide an
ability to specify alternate viewing depending on the
capabilities of a given user agent or the user's language.</p>

<p>Attributes <a>'requiredExtensions'</a> and <a>'systemLanguage'</a> act as tests and
evaluate to either true or false. The <a>'switch'</a> renders the first of
its children for which all of these attributes test true. If
the given attribute is not specified, then a true value is
assumed.</p>

<p>When an element is excluded because of conditional processing,
it is treated as if it had a used value of <code>none</code> for the <a>'display'</a> property.
Similar to the <a>'display'</a> property, conditional processing
attributes only affect the direct rendering of elements and do
not prevent elements from being successfully referenced by
other elements (such as via a <a>'use'</a>).</p>

<p>In consequence:</p>

<ul>
  <li>conditional processing affects the visual display of <a>graphics elements</a>,
  <a>'a'</a>, <a>'foreignObject'</a>, and <a>text content elements</a>.</li>

  <li>conditional processing prevents <a>animation elements</a> from playing.</li>

  <li>conditional processing will
  have no effect on <a>never-rendered elements</a>;
  in particular, conditional processing does not affect the processing of a <a>'style element'</a> or <a>'script'</a> element.</li>

  <li>conditional processing of child content of a never-rendered container element
  (e.g., a <a>'pattern'</a> or a <a>'mask element'</a>)
  will affect whether that child content contributes to the graphical effect.</li>
</ul>

<div class="note">
  <p>Previous versions of SVG included a third conditional processing attribute,
  <code>requiredFeatures</code>.
  This was intended to allow authors to provide fallback behavior for user agents
  that only implemented parts of the SVG specification.
  Unfortunately, poor specification and implementation of this attribute made it unreliable
  as a test of feature support.
  </p>
</div>

<h3 id="ConditionalProcessingDefinitions">Definitions</h3>
<dl class="definitions">
  <dt><dfn id="TermConditionalProcessingAttribute" data-dfn-type="dfn" data-export="">conditional processing attribute</dfn></dt>
  <dd>A conditional processing attribute is one that controls whether
  or not the element on which it appears is processed.  Most elements,
  but not all, may have conditional processing attributes specified
  on them.  See <a href="struct.html#ConditionalProcessing">Conditional processing</a>
  for details.  The conditional processing attributes defined in
  SVG 2 are <edit:attributecategory name='conditional processing'/>.</dd>
</dl>

<h3 id="SwitchElement">The <span class='element-name'>'switch'</span> element</h3>

<edit:elementsummary name='switch'/>

<p>The <a>'switch'</a> element evaluates
the <a>'requiredExtensions'</a> and
<a>'systemLanguage'</a> attributes on its direct child elements in
order, and then processes and renders the first child for which these
attributes evaluate to true. All others will be bypassed and therefore
not rendered. If the child element is a container element such as a
<a>'g'</a>, then the entire subtree is either processed/rendered or
bypassed/not rendered.</p>

<p class='ready-for-wider-review'>
In SVG, when evaluating the <a>'systemLanguage'</a> attribute, the order of
evaluation of descendant elements of the <a>'switch'</a> element must be as if the
<a href="https://www.w3.org/TR/REC-smil/smil-content.html#adef-allowReorder">'allowReorder'</a>
attribute, defined in the SMIL specification [<a href="refs.html#ref-SMIL">SMIL</a>]
always has a value of 'yes'.</p>

<p>Note that the values of properties <a>'display'</a> and
<a>'visibility'</a> have no effect on <a>'switch'</a> element
processing. In particular, setting <a>'display'</a> to
<span class="prop-value">none</span> on a child of a <a>'switch'</a> element
has no effect on true/false testing associated with <a>'switch'</a>
element processing.</p>

<p>The <a>'switch'</a> element does not affect the processing of
<a>'script'</a> and <a>'style element'</a> elements.</p>

<p>For more information and an example, see
<a href="embedded.html#ForeignObjectElement">Embedding foreign
object types</a>.</p>

<h3 id="ConditionalProcessingRequiredExtensionsAttribute">The <span class='attr-name'>'requiredExtensions'</span> attribute</h3>

<p>The <a>'requiredExtensions'</a>
attribute defines a list of required language extensions.
Language extensions are capabilities within a user agent that
go beyond the feature set defined in this specification. Each
extension is identified by an <a
href="linking.html#URLReference">URL reference</a>.</p>

<dl class="attrdef-list">
  <dt>
    <table class="attrdef def">
      <tr>
        <th>Name</th>
        <th>Value</th>
        <th>Initial value</th>
        <th>Animatable</th>
      </tr>
      <tr>
        <td><dfn id="RequiredExtensionsAttribute">requiredExtensions</dfn></td>
        <td><a>set of space-separated tokens</a> <span class="syntax">[HTML]</span></td>
        <td>(none)</td>
        <td>no</td>
      </tr>
    </table>
  </dt>
  <dd>
    <p>The value is a list of <a
    href="linking.html#URLReference">URL reference</a>s which
    identify the required extensions, with the individual
    values separated by white space. Determines whether all of
    the named <em>extensions</em> are supported by the user
    agent. If all of the given extensions are supported, then
    the attribute evaluates to true; otherwise, the current
    element and its children are skipped and thus will not be
    rendered.</p>
  </dd>
</dl>

<p>If a given <a href="linking.html#URLReference">URL
reference</a> contains white space within itself, that white
space must be escaped.</p>

<p>If the attribute is not present, then it implicitly evaluates to "true". If a null string or empty string value is
given to attribute <a>'requiredExtensions'</a>, the attribute
evaluates to "false".</p>

<p><a>'requiredExtensions'</a> is often
used in conjunction with the <a>'switch'</a> element. If the <a>'requiredExtensions'</a> is used in other
situations, then it represents a simple switch on the given
element whether to render the element or not.</p>

<p>The URL names for the extension should include versioning
information, such as "http://example.org/SVGExtensionXYZ/1.0",
so that script writers can distinguish between different
versions of a given extension.</p>

<h3 id="ConditionalProcessingSystemLanguageAttribute">The <span class="attr-name">'systemLanguage'</span> attribute</h3>

<dl class="attrdef-list">
  <dt>
    <table class="attrdef def">
      <tr>
        <th>Name</th>
        <th>Value</th>
        <th>Initial value</th>
        <th>Animatable</th>
      </tr>
      <tr>
        <td><dfn id="SystemLanguageAttribute">systemLanguage</dfn></td>
        <td><a>set of comma-separated tokens</a> <span class="syntax">[HTML]</span></td>
        <td>(none)</td>
        <td>no</td>
      </tr>
    </table>
  </dt>
  <dd>
    <p>The value is a <a>set of comma-separated tokens</a>, each of which must be a <a href="http://tools.ietf.org/html/bcp47#section-2.1">Language-Tag</a> value, as defined in <a href="http://www.ietf.org/rfc/bcp/bcp47.txt">BCP 47</a>
    [<a href="refs.html#ref-bcp47">BCP47</a>].
    </p>
  </dd>
</dl>

<p>Evaluates to "true" if one of the language tags indicated by
user preferences is a case-insensitive match of one of the language tags given in
the value of this parameter, or if one of the language tags
indicated by user preferences is a case-insensitive prefix of one of
the language tags given in the value of this parameter such that
the first tag character following the prefix is "-".</p>

<p>Evaluates to "false" otherwise.</p>

<p>If the attribute is not present, then it implicitly evaluates to "true".
If a null string or empty string value is
given to attribute <a>'systemLanguage'</a>, the attribute evaluates to
"false".</p>

<p>Note: This use of a prefix matching rule does not imply that
language tags are assigned to languages in such a way that it
is always true that if a user understands a language with a
certain tag, then this user will also understand all languages
with tags for which this tag is a prefix.</p>

<p>The prefix rule simply allows the use of prefix tags if this
is the case.</p>

<p class="note">Implementation note: When making the choice of linguistic
preference available to the user, implementers should take into
account the fact that users are not familiar with the details
of language matching as described above, and should provide
appropriate guidance. As an example, users may assume that on
selecting "en-gb", they will be served any kind of English
document if British English is not available. The user
interface for setting user preferences should guide the user to
add "en" to get the best matching behavior.</p>

<p>Multiple languages may be listed for content that is
intended for multiple audiences. For example, content that is
presented simultaneously in the original Maori and English
versions, would call for:</p>

<pre>&lt;text systemLanguage="mi, en"&gt;&lt;!-- content goes here --&gt;&lt;/text&gt;</pre>

<p>However, just because multiple languages are present within
the object on which the <a>'systemLanguage'</a> test
attribute is placed, this does not mean that it is intended for
multiple linguistic audiences. An example would be a beginner's
language primer, such as "A First Lesson in Latin," which is
clearly intended to be used by an English-literate audience. In
this case, the <a>'systemLanguage'</a> test attribute
should only include "en".</p>

<p class="note">Authoring note: Authors should realize that if several
alternative language objects are enclosed in a <a>'switch'</a>, and none of them
matches, this may lead to situations where no content is
displayed. It is thus recommended to include a "catch-all"
choice at the end of such a <a>'switch'</a> which is acceptable in
all cases.</p>

<p><a>'systemLanguage'</a> is often used
in conjunction with the <a>'switch'</a> element. If the <a>'systemLanguage'</a> is used in other
situations, then it represents a simple switch on the given
element whether to render the element or not.</p>

<h2 id="DescriptionAndTitleElements">The <span class='element-name'>'desc'</span>
and <span class='element-name'>'title'</span> elements</h2>

<h3 id="DescriptionDefinitions">Definition</h3>
<dl class="definitions">
  <dt><dfn id="TermDescriptiveElement" data-dfn-type="dfn" data-export="">descriptive element</dfn></dt>
  <dd>An element which provides supplementary descriptive information about
  its parent.  Specifically, the following elements are descriptive elements:
  <edit:elementcategory name='descriptive'/>.</dd>
</dl>

<p class="note">Multilingual descriptive text selection, based on the <a>'lang'</a> attribute, was added to allow internationalization
of the <a>'desc'</a> and <a>'title element'</a> elements.</p>

<p class="annotation">New in SVG 2. Adding 'lang' resolved at Rigi Kaltbad face-to-face.
Removed text that limited number of 'desc' and 'title' elements. Status: Done.</p>

<div class="ready-for-wider-review">
<p>Any <a>container element</a> or <a>graphics element</a> in an SVG document
can have zero or more <a>'desc'</a> and/or <a>'title'</a> elements as children,
whose content is text. <a>'desc'</a> and <a>'title'</a> elements are
not visually rendered as part of the graphics.
The <a>'display'</a> value for the <a>'title'</a> and <a>'desc'</a> elements
must always be set to <span class="prop-value">none</span>
by the <a>user agent style sheet</a>,
and this declaration must have importance over any other CSS rule or presentation attribute.
</p>

<p>Multiple sibling <a>'desc'</a> or <a>'title'</a> elements must have
different languages,
as defined using a <a>'lang'</a> attribute (or <code>xml:lang</code> attribute) on the descriptive element or an ancestor.
The user agent must select the element of each type whose language best
matches language preferences set by the user.
A descriptive element with an empty-string language tag
(indicating no language, for example a text alternative consisting of emoji symbols)
is a lowest-priority match for any user, ranked below all user-specified language preferences.
If multiple equally valid matches exist, the first match should be used.
If no match exists for either 'title' or 'desc', the first element of that type must be selected.</p>

<div class="example">
  <p>The following example shows alternative language titles on a re-used star icon,
    inline in an HTML document.
    The example assumes that the HTML document as a whole has a correctly-declared language of <code>en</code> (English without a specified country code).
  </p>
  <pre>
&lt;svg&gt;
  &lt;use href="#star"&gt;
    &lt;title&gt;Favourite&lt;/title&gt;
    &lt;title lang="en-us"&gt;Favorite&lt;/title&gt;
    &lt;title lang="nl"&gt;Favoriet&lt;/title&gt;
    &lt;title lang=""&gt;★&lt;/title&gt;
  &lt;/use&gt;
&lt;/svg&gt;
  </pre>
  <p>
    The first <code>title</code> element inherits the language of the document (<code>en</code>); the others have explicitly-declared languages for each element.
    If the user's preferred language (out of those provided) is American English, the icon title is the American spelling "Favorite".
    If the user's preferred language is Dutch, the icon title is "Favoriet".
    If the user's preference list includes generic English ranked higher than Dutch, the title is "Favourite" with British spelling.
    If the user does not understand either Dutch or English, the title will be the star symbol character—which is not ideal (most screen readers will read it as a localized version of "black star"), but better than no text alternative at all.
  </p>
  <p class="note">
    Authors should be aware that SVG 1.1-supporting user agents
    that have not yet implemented multi-lingual descriptive text
    will normally select the first element of each type, regardless of user preferences.
    SVG 1.1 user agents may also fail to recognize a <code>title</code> element that is not the first child of its parent,
    or a <code>desc</code> element that has previous siblings that are not other descriptive elements.
  </p>
</div>

<p class="issue" data-issue="67">The use of more than one <a>'title'</a> or <a>'desc'</a> element to
provide localised information is at risk, with no known implementations.</p>

<p>User agents must make the text content of selected 'title' and 'desc' elements available to platform accessibility APIs as part of the name and description computation for the parent element, as defined in the <a href="https://www.w3.org/TR/svg-aam-1.0/"><cite>SVG Accessibility API Mappings [SVG-AAM]</cite></a> specification.</p>

<p>Inclusion of any 'title' or 'desc' elements as a direct child of a <a>rendered element</a> indicates that the rendered element is of semantic importance in the graphic.
Authors should not, and <a>SVG generators</a> must not, include empty 'title' or 'desc' elements with no text content or whitespace-only text content,
as this will result in a nameless object being presented to assistive technology users.
</p>

<p>
If an individual graphic element has no meaning on its own,
alternative text should instead be provided for the nearest container element that describes a meaningful object.
Authors should use grouping (<a>'g'</a>) elements to structure their drawing elements into meaningful objects, and name those groups with <a>'title'</a>.
Conversely, if a container object is used simply to apply styles or layout,
and neither defines an object nor provides meaningful grouping structure,
it does not need alternative text.</p>

<p>
  Descriptive text elements whose parent is <a>not rendered</a> may be used by authors or authoring tools as reference information; authors are warned that this data is not normally available to end users viewing the graphic through assistive technologies.  Nonetheless, a <a>non-rendered element</a> may be referenced as part of the accessible name or description of a rendered element (as defined in <a href="https://www.w3.org/TR/svg-aam-1.0/">SVG-AAM</a>), and the recursive computation will use descriptive child elements of the referenced element.
</p>

<p>Description and title elements may contain marked-up text
from other namespaces, using standard XML mechanisms to indicate the namespace.
However, authors should not rely on such markup to provide meaning to alternative text;
only the plain text content is currently required to be exposed to assistive technologies.</p>

<p class="note">
  The HTML parser treats all markup within <a>'title'</a> and <a>'desc'</a>
  the same way it treats markkup in an HTML fragment;
  most elements will be assigned to the HTML namespace.
</p>

<p>User agents may use markup within <a>'title'</a>
to influence the visual presentation of titles (such as tooltips),
but are not required to do so.
</p>

<div id='TitleElement'>
<edit:elementsummary name='title'/>
</div>

<p>The <a>'title'</a> child element represents a short text alternative for the
element.</p>

<p>On a link, this could be the title or a description of the target resource; on an
image or drawing object, it could be a short description of the
graphic; on interactive content, it could be a label for, or instructions for, use
of the element; and so forth.</p>

<p>Authors should not provide redundant information in a <a>'title'</a> element
if there is also a visible label for the drawing element (e.g., using a <a>'text'</a> element).
Instead, the visual label should be associated with the drawing element
using an <a>'aria-labelledby'</a> attribute.</p>

<p>Interactive user agents should make the plain text content of <a>'title'</a> elements available in response to user interaction, in a manner consistent with platform conventions;
existing user agents commonly render <a>'title'</a> elements as
a tooltip on hovering the parent element.</p>

<p>Authors should provide a <a>'title'</a> child element to the root svg
element within a stand-alone SVG document. Since users often consult documents
out of context, authors should provide context-rich titles. Thus, instead of a
title such as "Introduction", which doesn't provide much contextual background,
authors should supply a title such as "Introduction to Medieval Bee-Keeping"
instead. For reasons of accessibility, user agents should always make the
content of the ‘title’ child element to the root svg element available to
users.
However, this is typically done through other means than the tooltips used for nested SVG and graphics elements, e.g., by displaying in a browser tab.</p>

<div id='DescElement'>
<edit:elementsummary name='desc'/>
</div>

<p>The <a>'desc'</a> element represents more detailed textual
information for the element such as a description. This is typically exposed to assistive
technologies to provide more detailed information, such as a description of the visual appearance of a graphic or help to explain the functionality of a complex widget.  It is not typically available to other users, so should not be used for essential instructions.</p>


<p>
Authors may associate detailed information, including visible text, with part of the graphic
using <a>'aria-describedby'</a> attribute
(on the described element or a parent container),
with the value being an ID reference to one or more SVG or HTML elements containing the description.
The <a>'aria-describedby'</a> attribute takes precedence
over the child <a>'desc'</a> when providing a description.
If an element has both visible description and a child <a>'desc'</a> element providing supplementary information,
authors should explicitly include the <a>'id'</a> of the element itself in its own <a>'aria-describedby'</a> list, in order to concatenate the two descriptions together.
</p>


</div> <!--  class="ready-for-wider-review" -->


<h2 id="MetadataElement">The <span class="element-name">'metadata'</span> element</h2>

<p>Metadata which is included with SVG content should be
specified within <a>'metadata'</a>
elements. The contents of the <a>'metadata'</a> should be elements from
other XML namespaces, with these elements from these namespaces
expressed in a manner conforming with the <a href="https://www.w3.org/TR/2006/REC-xml-names-20060816/"><cite>Namespaces in XML</cite></a> Recommendation
[<a href="refs.html#ref-xml-names">xml-names</a>].</p>

<p class="annotation">SVG 2 removes the recommendation to structure metadata
elements in any particular way. </p>

<edit:elementsummary name='metadata'/>

<p>Metadata content is not directly rendered;
the <a>'display'</a> value for the <a>'metadata'</a> element
must always be set to <span class="prop-value">none</span>
by the <a>user agent style sheet</a>,
and this declaration must have importance over any other CSS rule or presentation attribute.
</p>

<p>Here is an example of how metadata can be included in an SVG
document. The example uses the Dublin Core version 1.1 schema.
(Other XML-compatible metadata languages, including ones not
based on RDF, can be used also.)</p>

<pre><![CDATA[
<?xml version="1.0" standalone="yes"?>
<svg width="4in" height="3in"
    xmlns = 'http://www.w3.org/2000/svg'>
    <desc xmlns:myfoo="http://example.org/myfoo">
      <myfoo:title>This is a financial report</myfoo:title>
      <myfoo:descr>The global description uses markup from the
        <myfoo:emph>myfoo</myfoo:emph> namespace.</myfoo:descr>
      <myfoo:scene><myfoo:what>widget $growth</myfoo:what>
      <myfoo:contains>$three $graph-bar</myfoo:contains>
        <myfoo:when>1998 $through 2000</myfoo:when> </myfoo:scene>
   </desc>
    <metadata>
      <rdf:RDF
           xmlns:rdf = "http://www.w3.org/1999/02/22-rdf-syntax-ns#"
           xmlns:rdfs = "http://www.w3.org/2000/01/rdf-schema#"
           xmlns:dc = "http://purl.org/dc/elements/1.1/" >
        <rdf:Description about="http://example.org/myfoo"
             dc:title="MyFoo Financial Report"
             dc:description="$three $bar $thousands $dollars $from 1998 $through 2000"
             dc:publisher="Example Organization"
             dc:date="2000-04-11"
             dc:format="image/svg+xml"
             dc:language="en" >
          <dc:creator>
            <rdf:Bag>
              <rdf:li>Irving Bird</rdf:li>
              <rdf:li>Mary Lambert</rdf:li>
            </rdf:Bag>
          </dc:creator>
        </rdf:Description>
      </rdf:RDF>
    </metadata>
</svg>
]]></pre>


<h2 id="HTMLMetadataElements">HTML metadata elements</h2>

<p>For user agents that support HTML, the following HTML elements (in
the HTML namespace) must be supported in SVG documents:</p>

<ul>
  <li>the <a class="html" href="https://html.spec.whatwg.org/multipage/semantics.html#the-base-element"><code>base</code></a> element</li>
  <li>the <a class="html" href="https://html.spec.whatwg.org/multipage/semantics.html#the-link-element"><code>link</code></a> element</li>
  <li>the <a class="html" href="https://html.spec.whatwg.org/multipage/semantics.html#the-meta-element"><code>meta</code></a> element</li>
  <li>the <a class="html" href="https://html.spec.whatwg.org/multipage/semantics.html#the-style-element"><code>style</code></a> element</li>
  <li>the <a class="html" href="https://html.spec.whatwg.org/multipage/scripting.html#the-script-element"><code>script</code></a> element</li>
</ul>

<p class="note">
Note that the <a class="html" href="https://html.spec.whatwg.org/multipage/semantics.html#the-base-element"><code>base</code></a> element will affect all URL values in the document, including e.g. paint server references or <a>'use'</a> element references.
However, when <a href="linking.html#processingURL-absolute">processing URL references</a>
to identify a specific target element,
the user agent must always compare the generated absolute URL against the current document base URL
to determine whether it is a <a>same-document URL reference</a>.
In this way, target-fragment only references to elements in the same document remain valid,
regardless of any changes to the document base URL.
</p>


<h2 id="ForeignNamespaces">Foreign namespaces and private data</h2>

<p>
SVG allows inclusion of elements from foreign namespaces
anywhere within the SVG content.
In general, the SVG user agent
must include the unknown foreign-namespaced elements in the DOM
but will ignore and exclude them for rendering purposes.
</p>
<p>
The notable exceptions are described in the <a href="embedded.html">Embedded Content chapter</a>
under <a href="embedded.html#HTMLElements">HTML elements in SVG subtrees</a>
and <a href="embedded.html#ForeignObjectElement">Embedding Foreign Object
Types</a>.
Also see the handling of
<a href="struct.html#UnknownElement">unknown elements</a>
in the SVG namespace, which are treated differently.
</p>

<p>
Additionally, SVG allows inclusion of attributes from
foreign namespaces on any SVG element.
The SVG user agent must
include unknown attributes in the DOM but should otherwise ignore
unknown attributes.
</p>

<div class="note">
  <p>
  Authors should be aware that unknown namespaced elements and attributes
  will not be parsed as such by the HTML parser.
  Instead, the namespace prefix will be included in the tag or attribute name,
  elements will be placed in the parent element namespace and attributes in the default namespace.
  </p>
  <p>
  To add custom attributes in a way that will result in consistent parsing
  in both XML and HTML documents,
  authors may use the <a href="#DataAttributes"><span class='attr-name'>'data-*'</span> attributes</a>.
  These can be added to SVG <a>'metadata'</a> elements
  if the information they encode is not associated with any other element in the document.
  </p>
</div>

<p>SVG's ability to include foreign namespaces can be used for
the following purposes:</p>

<ul>
  <li>Application-specific information so that authoring
  applications can include model-level data in the SVG content
  to serve their "roundtripping" purposes (i.e., the ability to
  write, then read a file without loss of higher-level
  information).</li>

  <li>Supplemental data for extensibility. For example, suppose
  there is an extension which extrudes 2D graphics
  into three dimensions according to certain parameters;
  these parameters may be included in the SVG content
  by inserting elements from the extension's
  namespace.</li>
</ul>

<p>
For example, a business graphics authoring application
might want to include some private data within an SVG document
so that it could properly reassemble the chart (a pie chart in
this case) upon reading it back in:
</p>

<div class="example">
<pre><![CDATA[
<?xml version="1.0" standalone="yes"?>
<svg width="4in" height="3in"
     xmlns = 'http://www.w3.org/2000/svg'>
  <defs>
    <myapp:piechart xmlns:myapp="http://example.org/myapp"
                    title="Sales by Region">
      <myapp:pieslice label="Northern Region" value="1.23"/>
      <myapp:pieslice label="Eastern Region" value="2.53"/>
      <myapp:pieslice label="Southern Region" value="3.89"/>
      <myapp:pieslice label="Western Region" value="2.04"/>
      <!-- Other private data goes here -->
    </myapp:piechart>
  </defs>
  <desc>This chart includes private data in another namespace
  </desc>
  <!-- In here would be the actual SVG graphics elements which
       draw the pie chart -->
</svg>
]]></pre>
</div>

<h2 id="CommonAttributes">Common attributes</h2>

<h3 id="CommonAttributeDefinitions">Definitions</h3>

<dl class="definitions">

  <dt><dfn id="TermCoreAttribute" data-dfn-type="dfn" data-export="">core attributes</dfn></dt>
  <dd>The core attributes are those attributes that can be specified
  on any SVG element.
  The core attributes are <edit:attributecategory name='core'/>, along with all
  <a href="struct.html#DataAttributes">custom data attributes</a>.
  </dd>

</dl>

<h3 id="Core.attrib">Attributes common to all elements: <span class='attr-name'>'id'</span></h3>

<p>The <a>'id'</a> attribute is available on all SVG elements:</p>

<dl class="attrdef-list">
  <dt>
    <table class="attrdef def">
      <tr>
        <th>Name</th>
        <th>Value</th>
        <th>Initial value</th>
        <th>Animatable</th>
      </tr>
      <tr>
        <td><dfn id="IDAttribute" data-dfn-for="core-attributes" data-dfn-type="element-attr">id</dfn></td>
        <td>(see below)</td>
        <td>(none)</td>
        <td>no</td>
      </tr>
    </table>
  </dt>
  <dd class="ready-for-wider-review">
    <p>Must reflect the <a href="https://www.w3.org/TR/dom/#concept-id">element's
    ID</a> [<a href="refs.html#ref-dom">DOM</a>].
    The <a>'id'</a> attribute must be unique within the node tree,
    must not be an empty string,
    and must not contain any whitespace characters.
    </p>
    <p>
      Additional requirements apply in order for
      the <a>'id'</a> attribute to be valid in XML documents,
      as defined in the specification for the relevant version of XML.
      A stand-alone SVG document uses XML 1.0 syntax [<a href="refs.html#ref-xml">xml</a>],
      which specifies that valid <a>'id'</a> values are <a href="https://www.w3.org/TR/xml/#NT-Name">XML name tokens</a>.
      Valid XML 1.0 names only include designated characters (letters, digits, and a few punctuation marks),
      and do not start with a digit, a full stop (.) character, or a hyphen-minus (-) character.
    </p>
    <p>
      User agents should process <a>'id'</a> values in SVG files irrespective of XML validity.
    </p>
    <p>
      Authors should avoid the use of <a>'id'</a> values that would be parsed
      as an <a href="linking.html#SVGViewSpecification">SVG view specification</a>
      or a <a href="linking.html#MediaFragments">basic media fragment</a>
      when used as a URL target fragment.
    </p>
  </dd>
</dl>

<h3 id="LangSpaceAttrs">The <span class="attr-name">'lang'</span> and <span class="attr-name">'xml:lang'</span> attributes</h3>

<p>The <span class='attr-name'>'lang'</span> attribute (in no namespace) specifies the primary language for the element's contents and
for any of the element's attributes that contain text.
</p>
<p>The <span class='attr-name'>'lang'</span> attribute in the XML namespace is defined in XML [<a href="refs.html#ref-xml">xml</a>].</p>
<p>If these attributes are omitted from an element, then the language of this element is the same as the language of its parent element, if any.</p>
<p>The <span class='attr-name'>'lang'</span> attribute in the XML namespace may be used on SVG elements in XML documents.
If both the <span class='attr-name'>'lang'</span> attribute in no namespace and the <span class='attr-name'>'lang'</span> attribute
in the XML namespace are specified on the same element, they must have exactly the same value when compared in an ASCII case-insensitive manner.
</p>
<p>
If both the <span class='attr-name'>'lang'</span> attribute in no namespace and the <span class='attr-name'>'lang'</span> attribute in the
XML namespace are set on an element, user agents must use the <span class='attr-name'>'lang'</span> attribute in the XML namespace, and
the <span class='attr-name'>'lang'</span> attribute in no namespace must be ignored for the purposes of determining the element's language.
</p>


<dl class="attrdef-list">
  <dt>
    <table class="attrdef def">
      <tr>
        <th>Name</th>
        <th>Value</th>
        <th>Initial value</th>
        <th>Animatable</th>
      </tr>
      <tr>
        <td><dfn id="LangAttribute" data-dfn-for="core-attributes" data-dfn-type="element-attr">lang</dfn></td>
        <td><a href="http://tools.ietf.org/html/bcp47#section-2.1">Language-Tag</a> <span class='syntax'>[ABNF]</span></td>
        <td>(none)</td>
        <td>no</td>
      </tr>
    </table>
  </dt>
  <dd>
    <p>The <span class='attr-name'>'lang'</span> attribute specifies the primary language for the element's contents and
for any of the element's attributes that contain text. Its value must be a valid BCP 47 language tag,
or the empty string. Setting the attribute to the empty string indicates that the primary language is unknown.
[<a href="refs.html#ref-bcp47">BCP47</a>].
    </p>
  </dd>
</dl>

<h3 id="WhitespaceProcessingXMLSpaceAttribute">The <span class="attr-name">'xml:space'</span> attribute</h3>
<div class="annotation svg2-requirement">
  <table>
    <tr>
      <th>SVG 2 Requirement:</th>
      <td>Deprecate the use of <span class='attr-name'>'xml:space'</span> to affect text layout and use the <span class='property'>'white-space'</span> property instead.</td>
    </tr>
    <tr>
      <th>Resolution:</th>
      <td><a href="http://www.w3.org/2011/03/03-svg-minutes.html#item04">We drop xml:space from SVG 2 and remove the relating tests from the SVG 1.1. test suite.</a></td>
    </tr>
    <tr>
      <th>Purpose:</th>
      <td>To align with CSS.</td>
    </tr>
    <tr>
      <th>Owner:</th>
      <td>Chris (<a href="http://www.w3.org/Graphics/SVG/WG/track/actions/3004">ACTION-3004</a>, done; and
                 <a href="http://www.w3.org/Graphics/SVG/WG/track/actions/3005">ACTION-3005</a>, done)</td>
    </tr>
    <tr>
      <th>Status</th>
      <td>Done.</td>
    </tr>
  </table>
</div>
<dl class='attrdef-list'>
   <dt>
    <table class="attrdef def">
      <tr>
        <th>Name</th>
        <th>Value</th>
        <th>Initial value</th>
        <th>Animatable</th>
      </tr>
      <tr>
        <td><dfn id="XMLSpaceAttribute" data-dfn-for="core-attributes" data-dfn-type="element-attr">xml:space</dfn></td>
        <td>(see below)</td>
        <td>default</td>
        <td>no</td>
      </tr>
    </table>
  </dt>
  <dd>
    <p>Deprecated XML attribute to specify whether white space
    is preserved in character data. The only possible values
    are the strings <span class='attr-value'>'default'</span> and <span class='attr-value'>'preserve'</span>, without
    white space.  Refer to the
    <a href="https://www.w3.org/TR/2008/REC-xml-20081126/"><cite>Extensible Markup Language (XML) 1.0</cite></a>
    Recommendation [<a href="refs.html#ref-xml">xml</a>] and to the
    discussion <a href="text.html#WhiteSpace">white space
    handling</a> in SVG.</p>
    <p>New content should use the <a>'white-space'</a> property instead.</p>
  </dd>
</dl>

<h3 id="tabindexattribute">The <span class='attr-name'>'tabindex'</span> attribute</h3>

<dl class='attrdef-list'>
   <dt>
    <table class="attrdef def">
      <tr>
        <th>Name</th>
        <th>Value</th>
        <th>Initial value</th>
        <th>Animatable</th>
      </tr>
      <tr>
        <td><dfn id="SVGElementTabindexAttribute" data-dfn-for="core-attributes" data-dfn-type="element-attr">tabindex</dfn></td>
        <td><a href="https://html.spec.whatwg.org/#valid-integer">valid integer</a> <span class="syntax">[HTML]</span></td>
        <td>(none)</td>
        <td>no</td>
      </tr>
    </table>
  </dt>
  <dd>
  <p>This content attribute allows authors to control whether an element is focusable, whether it is supposed to be reachable
  using <a href="interact.html#Focus">sequential focus navigation</a>, and what is to be the relative
  order of the element for the purposes of sequential focus
  navigation.</p>
    <p class="note">The name "tab index" comes from the common use of the
  "tab" key to navigate through the focusable elements. The term
  "tabbing" refers to moving forward through the focusable elements
  that can be reached using sequential focus navigation.
   </p>
  </dd>
</dl>

<div class='ready-for-wider-review'>
<h3 id="DataAttributes">The <span class='attr-name'>'data-*'</span> attributes</h3>

<p>All SVG elements support
<a href="https://www.w3.org/TR/2014/CR-html5-20140204/dom.html#custom-data-attribute">custom data attributes</a>,
which are those in no namespace whose names begin with the string "data-".
See the <a href="https://www.w3.org/TR/2014/CR-html5-20140204/dom.html#embedding-custom-non-visible-data-with-the-data-*-attributes">requirements
for custom data attributes</a> in the HTML specification.</p>
</div>

<h2 id="WAIARIAAttributes">WAI-ARIA attributes</h2>

<h3 id="WAIARIA-definitions">Definitions</h3>

<dl class="definitions">
  <dt><dfn id="TermARIAAttribute" data-dfn-type="dfn" data-export="">ARIA attributes</dfn></dt>
  <dd>These are the attributes defined in WAI-ARIA,
    consisting of WAI-ARIA states and properties
    as well as the role attribute.
    See the WAI-ARIA
  <a href="https://www.w3.org/TR/wai-aria-1.1/#role_definitions">Definition of Roles</a>, the WAI-ARIA
Graphics Module <a href="https://www.w3.org/TR/graphics-aria-1.0/#roles">Graphics Roles</a>,
 and the WAI-ARIA <a href="https://www.w3.org/TR/wai-aria/#states_and_properties">Supported States and Properties</a>.
  The aria attributes are <edit:attributecategory name='aria'/>.</dd>
</dl>

<p class="note">Note that the above list of ARIA attributes may be expanded by future WAI-ARIA specifications.
</p>

<h3 id="roleattribute">Role attribute</h3>

<p>Any <a>renderable element</a> may have an ARIA role attribute specified; the role attribute is ignored on <a>non-rendered elements</a>.
The attribute, if specified, must have a value that is a <a>set of space-separated
tokens</a> representing the various WAI-ARIA roles that the element belongs to.
These tokens are role values defined in
<a href="https://www.w3.org/TR/wai-aria-1.1/#role_definitions">Definition of Roles</a>
([<a href="refs.html#ref-wai-aria">wai-aria</a>], section 5.4) and <a href="https://www.w3.org/TR/graphics-aria-1.0/#roles">Graphics Roles</a>
([<a href="refs.html#ref-graphics-aria-1.0">graphics-aria-1.0</a>], section 4).</p>

<p>The WAI-ARIA role that an SVG element has assigned to it is the first valid
role found in the list of tokens generated when the role attribute
is split on spaces.
A valid role is a recognized, non-abstract role that is <a href="#implicit-aria-semantics">allowed for the element type</a>.</p>

<dl class="attrdef-list">
   <dt>
    <table class="attrdef def">
      <tr>
        <th>Name</th>
        <th>Value</th>
        <th>Initial value</th>
        <th>Animatable</th>
      </tr>
      <tr>
        <td><dfn id="RoleAttribute" data-dfn-type="element-attr" data-export="">role</dfn></td>
        <td><a>set of space-separated tokens</a> <span class="syntax">[HTML]</span></td>
        <td>(see below)</td>
        <td>no</td>
      </tr>
    </table>
  </dt>
  <dd>
    <p>The <a>'role'</a> attribute must be a
    <a>set of space-separated tokens</a> having values defined in
    <a href="https://www.w3.org/TR/wai-aria-1.1/#role_definitions">Definition of Roles</a> ([<a href="refs.html#ref-wai-aria">wai-aria</a>], section 5.4).
    </p>
    <p>The role value is a set of white-space separated machine-extractable semantic information used to define the purpose of the element.</p>
    <p>The <a>initial value</a> for the <a>'role'</a> attribute, for each SVG element, is the corresponding
    <a href="#implicit-aria-semantics">default implied ARIA semantic for SVG elements</a>.</p>
  </dd>
</dl>

<p>To be valid and useful, many element roles require additional information to be provided
in the form of an accessible name
or explicit <a href="#ARIAStateandPropertyAttributes">state and property values</a>.
Accessible names may be provided using SVG <a>descriptive elements</a> or <a>ARIA attributes</a>.
The requirements for each role are indicated where the role is defined, e.g., in
<a href="https://www.w3.org/TR/wai-aria-1.1/#role_definitions">WAI-ARIA</a>
([<a href="refs.html#ref-wai-aria">WAI-ARIA</a>]) or the <a href="https://www.w3.org/TR/graphics-aria-1.0/#roles">WAI-ARIA Graphics Module</a>
([<a href="refs.html#ref-graphics-aria-1.0">graphics-aria-1.0</a>]).</p>

<h3 id="ARIAStateandPropertyAttributes">State and property attributes (all aria- attributes)</h3>

<p>WAI-ARIA state and property attributes may be specified on SVG elements.
These attributes are defined by ARIA in
<a href="https://www.w3.org/TR/wai-aria-1.1/#state_prop_def">Definitions of States and Properties (all aria-* attributes)</a>
([<a href="refs.html#ref-wai-aria">wai-aria</a>], section 6.6).</p>

<p>These attributes, if specified, must have a value that is the WAI-ARIA value
type in the "Value" field of the definition for the state or property, mapped to
the appropriate SVG value type according to
<a href="https://www.w3.org/TR/wai-aria-1.1/#typemapping">Mapping WAI-ARIA Value types to languages</a>
using the SVG mapping ([<a href="refs.html#ref-wai-aria">wai-aria</a>], section 10.2).</p>

<p>The attributes are animatable;
  if animation is used to change the state of the graphic,
  or to change its content in a way that alters the correct alternative text description,
  the same method of animation should be used to update the corresponding
  ARIA state or property attribute.
</p>

<p>WAI-ARIA State and Property attributes can be used on any element. They are
not always meaningful, however, and in such cases user agents might not perform
any processing aside from including them in the DOM. State and property attributes are
processed according to the <a href="https://www.w3.org/TR/wai-aria-1.1/"><cite>ARIA</cite></a> and
<a href="https://www.w3.org/TR/svg-aam-1.0/"><cite>SVG Accessibility API Mappings</cite></a> specification
specifications. [<a href="refs.html#ref-wai-aria">wai-aria</a>] [<a href="refs.html#ref-svg-aam-1.0">svg-aam-1.0</a>]</p>

<h3 id="implicit-aria-semantics">Implicit and Allowed ARIA Semantics</h3>
<p>The following table defines the <span>default implicit ARIA
  semantics</span> that apply to <a href="eltindex.html">SVG elements</a>. Each
  language feature (element) in a cell in the first
  column implies the ARIA semantics (role, states, and/or properties)
  given in the cell in the second column of the same row. The third column defines restrictions as to what WAI-ARIA semantic (role, state, or property) may or may not apply.</p>
<p>For many graphics elements, an implicit role is only assigned
  if the author provides information that indicates semantic importance.
  The complete <dfn id="TermInclusionCriteria" data-dfn-type="dfn" data-export="">inclusion criteria</dfn> for the accessibility tree
  are defined by the <a href="https://www.w3.org/TR/svg-aam-1.0/"><cite>SVG Accessibility API Mappings</cite></a> specification for user agents [<a href="refs.html#ref-svg-aam-1.0">svg-aam-1.0</a>].
  For authors, the preferred means of indicating semantic importance is to provide an accessible name for the element.
  This can be done through a direct child <a>'title'</a> element,
  or through the <a>'aria-label'</a> or <a>'aria-labelledby'</a> attributes.
  Authors should use one of these methods to provide an accessible name
  for any content that is essential to the comprehension of the SVG,
  and especially for any interactive content.
</p>

  <table id="table-aria-implicit" class="vert">
      <thead>
          <tr>
            <th>Language feature</th>
            <th>Default implied ARIA semantics</th>
            <th>Allowed roles</th></tr>
      </thead>

   <tbody>
    <tr><td><a>'a'</a></td>
        <td><code title="attr-aria-role-link">link</code> role
    if the element has a valid <code>href</code> or <code>xlink:href</code> attribute.
    For <code>a</code> elements that are not links, the default semantics are the same as
    <code>tspan</code> if the <code>a</code> element is a descendent of <code>text</code>,
    or the same as <code>g</code> otherwise.</td>
        <td>no restrictions</td>
    </tr>
    <tr>
      <td><a>'audio'</a></td>
      <td>platform-specific role mappings,
        as defined in the <a href="https://w3c.github.io/html-aam/#x4-4-html-element-role-mappings">HTML Accessibility API Mappings</a> specification</td>
      <td>If specified, role must be <code>application</code></td>
    </tr>
    <tr>
      <td><a>'canvas'</a></td>
      <td>platform-specific role mappings,
        as defined in the <a href="https://w3c.github.io/html-aam/#x4-4-html-element-role-mappings">HTML Accessibility API Mappings</a> specification</td>
      <td>no restrictions</td>
    </tr>
    <tr>
      <td><a>'circle'</a></td>
      <td><code>graphics-symbol</code> role
        if the element meets the <a>inclusion criteria</a>,
        otherwise <code>none</code></td>
      <td>no restrictions</td>
    </tr>
    <tr>
      <td><a>'clipPath'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'defs'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'desc'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'ellipse'</a></td>
      <td><code>graphics-symbol</code> role
        if the element meets the <a>inclusion criteria</a>,
        otherwise <code>none</code></td>
      <td>no restrictions</td>
    </tr>
    <tr>
      <td><a>'feBlend'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'feColorMatrix'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'feComponentTransfer'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'feComposite'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'feConvolveMatrix'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'feDiffuseLighting'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'feDisplacementMap'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'feDistantLight'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'feDropShadow'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'feFlood'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'feFuncA'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'feFuncB'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'feFuncG'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'feFuncR'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'feGaussianBlur'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'feImage'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'feMerge'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'feMergeNode'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'feMorphology'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'feOffset'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'fePointLight'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'feSpecularLighting'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'feSpotLight'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'feTile'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'feTurbulence'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'filter element'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'foreignObject'</a></td>
      <td><code>group</code> role
        if the element meets the <a>inclusion criteria</a>,
        otherwise <code>none</code></td>
      <td>no restrictions</td>
    </tr>
    <tr>
      <td><a>'g'</a></td>
      <td><code>group</code> role
        if the element meets the <a>inclusion criteria</a>,
        otherwise <code>none</code></td>
      <td>no restrictions</td>
    </tr>
    <tr>
      <td><a>'iframe'</a></td>
      <td>platform-specific role mappings,
        as defined in the <a href="https://w3c.github.io/html-aam/#x4-4-html-element-role-mappings">HTML Accessibility API Mappings</a> specification</td>
      <td>If Specified, role must be either <code title="attr-aria-role-application">application</code>, <code title="attr-aria-role-document">document</code>, or <code title="attr-aria-role-img">img</code> roles</td>
    </tr>
    <tr>
      <td><a>'image'</a></td>
      <td><code title="attr-aria-role-img">img</code> role</td>
      <td>no restrictions</td>
    </tr>
    <tr>
      <td><a>'line'</a></td>
      <td><code>graphics-symbol</code> role
        if the element meets the <a>inclusion criteria</a>,
        otherwise <code>none</code></td>
      <td>no restrictions</td>
    </tr>
    <tr>
      <td><a>'linearGradient'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'marker element'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'mask element'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'metadata'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'mpath'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'path'</a></td>
      <td><code>graphics-symbol</code> role
        if the element meets the <a>inclusion criteria</a>,
        otherwise <code>none</code></td>
      <td>no restrictions</td>
    </tr>
    <tr>
      <td><a>'pattern'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'polygon'</a></td>
      <td><code>graphics-symbol</code> role
        if the element meets the <a>inclusion criteria</a>,
        otherwise <code>none</code></td>
      <td>no restrictions</td>
    </tr>
    <tr>
      <td><a>'polyline'</a></td>
      <td><code>graphics-symbol</code> role
        if the element meets the <a>inclusion criteria</a>,
        otherwise <code>none</code></td>
      <td>no restrictions</td>
    </tr>
    <tr>
      <td><a>'radialGradient'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'rect'</a></td>
      <td><code>graphics-symbol</code> role
        if the element meets the <a>inclusion criteria</a>,
        otherwise <code>none</code></td>
      <td>no restrictions</td>
    </tr>
    <tr>
      <td><a>'script'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'stop'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'style element'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'svg'</a></td>
      <td><code>graphics-document</code> role</td>
      <td>no restrictions</td>
    </tr>
    <tr>
      <td><a>'switch'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'symbol'</a></td>
      <td><code>graphics-object</code> role
        if the element is a rendered <a>element instance</a>
        that meets the <a>inclusion criteria</a>,
        otherwise <code>none</code></td>
      <td>no restrictions</td>
    </tr>
    <tr>
      <td><a>'text'</a></td>
      <td><code>group</code>role,
        with platform-specific role mappings,
        as defined in the <a href="https://w3c.github.io/svg-aam/#details-id-69">SVG Accessibility API Mappings</a> specification</td>
      <td>no restrictions</td>
    </tr>
    <tr>
      <td><a>'textPath'</a></td>
      <td><code>group</code> role
        if the element meets the <a>inclusion criteria</a>,
        otherwise <code>none</code></td>
      <td>no restrictions</td>
    </tr>
    <tr>
      <td><a>'title'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
    <tr>
      <td><a>'tspan'</a></td>
      <td><code>group</code> role
        if the element meets the <a>inclusion criteria</a>,
        otherwise <code>none</code></td>
      <td>no restrictions</td>
    </tr>
    <tr>
      <td><a>'use'</a></td>
      <td><code>graphics-object</code> role
        if the element meets the <a>inclusion criteria</a>,
        otherwise <code>none</code></td>
      <td>no restrictions</td>
    </tr>
    <tr>
      <td><a>'video'</a></td>
      <td>platform-specific role mappings,
        as defined in the <a href="https://w3c.github.io/html-aam/#x4-4-html-element-role-mappings">HTML Accessibility API Mappings</a> specification</td>
      <td>If specified, role must be <code>application</code></td>
    </tr>
    <tr>
      <td><a>'view'</a></td>
      <td>none</td>
      <td>no role may be applied</td>
    </tr>
   </tbody>
  </table>

<h2 id="DOMInterfaces">DOM interfaces</h2>

<div class='ready-for-wider-review'>
<h3 id="InterfaceDocumentExtensions">Extensions to the Document interface</h3>

<p>The DOM Core specification defines a <a>Document</a> interface, which this specification extends.</p>
<p class="note">In the case where an SVG document is embedded by reference,
such as when an HTML document has an <span class="element-name">'object'</span>
element whose <span class="attr-name">'data'</span> attribute references an SVG
document (i.e., a document whose MIME type is "image/svg+xml"
and whose root element is thus an <a>'svg'</a> element), there will exist
two distinct DOM hierarchies. The first DOM hierarchy will be for the
referencing document (e.g., an XHTML document). The second DOM hierarchy
will be for the referenced SVG document.</p>

<pre class="idl">partial interface <a>Document</a> {
  readonly attribute <a>SVGSVGElement</a>? <a href="struct.html#__svg__SVGDocument__rootElement">rootElement</a>;
};</pre>

<p>The <b id="__svg__SVGDocument__rootElement">rootElement</b> IDL attribute
represents the root <a>'svg'</a> element.  On getting
<a href="#__svg__SVGDocument__rootElement">rootElement</a>, the root element
of the document is returned, if it is an <a>'svg'</a> element, or null
otherwise.</p>

<p class="note">This attribute is deprecated, and may be removed in a future SVG specification.
Authors are encouraged to use the <a href="https://www.w3.org/TR/dom/#dom-document-documentelement">documentElement</a> attribute on <a>Document</a> instead.</p>
<!--<p class="issue" data-issue="47">Data point: <a href="https://www.chromestatus.com/metrics/feature/timeline/popularity/251">UseCounter in blink</a> shows ~0.010.</p>-->

<p>SVG implementations that implement HTML must support the
<a href="https://html.spec.whatwg.org/multipage/dom.html#the-document-object">HTML extensions to the document interface</a>.

Other SVG implementations must support the following IDL fragment.
</p>

<pre class="idl" edit:excludefromidl="true"><span class="comment">// must only be implemented in certain implementations</span>
partial interface <a>Document</a> {
  readonly attribute DOMString title;
  readonly attribute DOMString referrer;
  readonly attribute DOMString domain;
  readonly attribute Element? <a href="struct.html#__svg__SVGDocument__activeElement">activeElement</a>;
};</pre>

<p>The title, referrer, domain and <span id="__svg__SVGDocument__activeElement">activeElement</span> IDL attributes must behave the same as
<a href="https://html.spec.whatwg.org/multipage/dom.html#the-document-object">the corresponding IDL attributes defined in HTML</a>.</p>

<h3 id="InterfaceSVGSVGElement">Interface SVGSVGElement</h3>

<edit:with element="svg">

<p>An <a>SVGSVGElement</a> object represents an <a>'svg'</a> element
in the DOM.  The <a>SVGSVGElement</a> interface also contains
miscellaneous utility methods, such as data type object factory methods.</p>

<p>An <a>SVGSVGElement</a> object maintains an internal
<a>DOMPoint</a> object, called its
<dfn id="CurrentTranslatePointObject" data-dfn-type="dfn" data-export="">current translate point object</dfn>,
which is the object returned from the <a href="#__svg__SVGSVGElement__currentTranslate">currentTranslate</a>
IDL attribute.</p>

<pre class="idl">[Exposed=Window]
interface <b>SVGSVGElement</b> : <a>SVGGraphicsElement</a> {

  [SameObject] readonly attribute <a>SVGAnimatedLength</a> <a href="struct.html#__svg__SVGSVGElement__x">x</a>;
  [SameObject] readonly attribute <a>SVGAnimatedLength</a> <a href="struct.html#__svg__SVGSVGElement__y">y</a>;
  [SameObject] readonly attribute <a>SVGAnimatedLength</a> <a href="struct.html#__svg__SVGSVGElement__width">width</a>;
  [SameObject] readonly attribute <a>SVGAnimatedLength</a> <a href="struct.html#__svg__SVGSVGElement__height">height</a>;

  attribute float <a href="struct.html#__svg__SVGSVGElement__currentScale">currentScale</a>;
  [SameObject] readonly attribute <a>DOMPointReadOnly</a> <a href="struct.html#__svg__SVGSVGElement__currentTranslate">currentTranslate</a>;

  <a>NodeList</a> <a href="struct.html#__svg__SVGSVGElement__getIntersectionList">getIntersectionList</a>(<a>DOMRectReadOnly</a> rect, <a>SVGElement</a>? referenceElement);
  <a>NodeList</a> <a href="struct.html#__svg__SVGSVGElement__getEnclosureList">getEnclosureList</a>(<a>DOMRectReadOnly</a> rect, <a>SVGElement</a>? referenceElement);
  boolean <a href="struct.html#__svg__SVGSVGElement__checkIntersection">checkIntersection</a>(<a>SVGElement</a> element, <a>DOMRectReadOnly</a> rect);
  boolean <a href="struct.html#__svg__SVGSVGElement__checkEnclosure">checkEnclosure</a>(<a>SVGElement</a> element, <a>DOMRectReadOnly</a> rect);

  void <a href="struct.html#__svg__SVGSVGElement__deselectAll">deselectAll</a>();

  <a>SVGNumber</a> <a href="struct.html#__svg__SVGSVGElement__createSVGNumber">createSVGNumber</a>();
  <a>SVGLength</a> <a href="struct.html#__svg__SVGSVGElement__createSVGLength">createSVGLength</a>();
  <a>SVGAngle</a> <a href="struct.html#__svg__SVGSVGElement__createSVGAngle">createSVGAngle</a>();
  <a>DOMPoint</a> <a href="struct.html#__svg__SVGSVGElement__createSVGPoint">createSVGPoint</a>();
  <a>DOMMatrix</a> <a href="struct.html#__svg__SVGSVGElement__createSVGMatrix">createSVGMatrix</a>();
  <a>DOMRect</a> <a href="struct.html#__svg__SVGSVGElement__createSVGRect">createSVGRect</a>();
  <a>SVGTransform</a> <a href="struct.html#__svg__SVGSVGElement__createSVGTransform">createSVGTransform</a>();
  <a>SVGTransform</a> <a href="struct.html#__svg__SVGSVGElement__createSVGTransformFromMatrix">createSVGTransformFromMatrix</a>(<a>DOMMatrixReadOnly</a> matrix);

  <a>Element</a> <a href="struct.html#__svg__SVGSVGElement__getElementById">getElementById</a>(DOMString elementId);

  <span class="comment">// Deprecated methods that have no effect when called,</span>
  <span class="comment">// but which are kept for compatibility reasons.</span>
  unsigned long <a href="struct.html#__svg__SVGSVGElement__suspendRedraw">suspendRedraw</a>(unsigned long maxWaitMilliseconds);
  void <a href="struct.html#__svg__SVGSVGElement__unsuspendRedraw">unsuspendRedraw</a>(unsigned long suspendHandleID);
  void <a href="struct.html#__svg__SVGSVGElement__unsuspendRedrawAll">unsuspendRedrawAll</a>();
  void <a href="struct.html#__svg__SVGSVGElement__forceRedraw">forceRedraw</a>();
};

<a>SVGSVGElement</a> includes <a>SVGFitToViewBox</a>;
<a>SVGSVGElement</a> includes <a>SVGZoomAndPan</a>;
<a>SVGSVGElement</a> includes <a>WindowEventHandlers</a>;</pre>

<p>The
<b id="__svg__SVGSVGElement__x">x</b>,
<b id="__svg__SVGSVGElement__y">y</b>,
<b id="__svg__SVGSVGElement__width">width</b> and
<b id="__svg__SVGSVGElement__height">height</b> IDL attributes
<a>reflect</a> the computed values of the <a>'x'</a>, <a>'y'</a>, <a>'width'</a> and
<a>'height'</a> properties and their corresponding
presentation attributes, respectively.</p>

<p>The <b id="__svg__SVGSVGElement__currentScale">currentScale</b> and
<b id="__svg__SVGSVGElement__currentTranslate">currentTranslate</b> IDL
attributes represent the transform applied to the document in
response to user magnification and panning operations, as described under
<a href="interact.html#ZoomAndPanAttribute">Magnification and panning</a>.</p>

<p class="note">The document's magnification and panning
transform is a 2x3 matrix of the form
[currentScale 0 0 currentScale currentTranslate.x currentTranslate.y].
The value of the <a>'transform'</a> property does not affect
<a href="#__svg__SVGSVGElement__currentScale">currentScale</a> or
<a href="#__svg__SVGSVGElement__currentTranslate">currentTranslate</a>.</p>

<p>On getting <a href="#__svg__SVGSVGElement__currentScale">currentScale</a>,
the following steps are run:</p>

<ol class='algorithm'>
  <li>If the current <a>'svg'</a> element is not the <a>outermost svg element</a>,
  then return 1.</li>
  <li>Let [<var>a</var> <var>b</var> <var>c</var> <var>d</var> <var>e</var> <var>f</var>]
  be the 2x3 matrix that represents the document's magnification and panning
  transform.</li>
  <li>Return <var>a</var>.</li>
</ol>

<p>On setting <a href="#__svg__SVGSVGElement__currentScale">currentScale</a>,
the following steps are run:</p>

<ol class='algorithm'>
  <li>If the current <a>'svg'</a> element is not the <a>outermost svg element</a>,
  then return.</li>
  <li>Let <var>scale</var> be the value being assigned to
  <a href="#__svg__SVGSVGElement__currentScale">currentScale</a>.</li>
  <li>Let [<var>a</var> <var>b</var> <var>c</var> <var>d</var> <var>e</var> <var>f</var>]
  be the 2x3 matrix that represents the document's magnification and panning
  transform.</li>
  <li>Set the document's magnification and panning transform to
  [<var>scale</var> 0 0 <var>scale</var> <var>e</var> <var>f</var>].</li>
</ol>

<p>On getting <a href="#__svg__SVGSVGElement__currentTranslate">currentTranslate</a>,
the <a>SVGSVGElement</a> object's <a href="#CurrentTranslatePointObject">current
translate point object</a> is returned.  This object
<a href="shapes.html#PointMode">represents the current translation</a>
for the <a>'svg'</a> element.  A <a href="#CurrentTranslatePointObject">current
translate point object</a> must be <a href="shapes.html#ReadOnlyPoint">read only</a>
when its <a>'svg'</a> element is not the <a>outermost svg element</a>,
and writable otherwise.</p>

<p class="note">See the rules for <a href="shapes.html#AssignToDOMPoint">assigning to a DOMPoint</a>
for how modifying the <a href="#CurrentTranslatePointObject">current
translate point object</a> affects the document's magnification and panning transform.</p>

<p>Whenever the document's magnification and panning transform changes
in response to user interaction or whenever the <a>outermost svg element</a>
changes, the following steps are run:</p>

<ol class='algorithm'>
  <li>Let [<var>a</var> <var>b</var> <var>c</var> <var>d</var> <var>e</var> <var>f</var>]
  be the 2x3 matrix that represents the document's magnification and panning
  transform.</li>
  <li>Let <var>element</var> be the <a>outermost svg element</a>.</li>
  <li>Update the x and y components of <var>element</var>'s
  <a href="#CurrentTranslatePointObject">current translate point object</a>
  to <var>e</var> and <var>f</var>, respectively.</li>
</ol>

<p class="note">Running these steps when the <a>outermost svg element</a>
changes will ensure that if the document element is replaced with a different
<a>'svg'</a> element, that its <a href="#__svg__SVGSVGElement__currentTranslate">currentTranslate</a>
will be immediately updated to reflect the translation component of
the document's magnification and panning transform.</p>

<p>Whenever an <a>'svg'</a> element is no longer <a>outermost svg element</a>,
the x and y components of its <a href="#CurrentTranslatePointObject">current
translate point object</a> must be set to 0.</p>

<p class="note">Note that the value of the <a>'zoomAndPan'</a> attribute
on the <a>outermost svg element</a> only controls whether the document's
magnification and panning transform can be updated through user interaction.
Regardless of the value of that attribute, the current scale and translation
can be changed by modifying <a href="#__svg__SVGSVGElement__currentScale">currentScale</a>
and <a href="#__svg__SVGSVGElement__currentTranslate">currentTranslate</a>.</p>

<p>The <b id="__svg__SVGSVGElement__suspendRedraw">suspendRedraw</b>,
<b id="__svg__SVGSVGElement__unsuspendRedraw">unsuspendRedraw</b>,
<b id="__svg__SVGSVGElement__unsuspendRedrawAll">unsuspendRedrawAll</b>
and <b id="__svg__SVGSVGElement__forceRedraw">forceRedraw</b>
methods are all deprecated and defined to have no effect.  When
the suspendRedraw method is called, it must return 1.</p>

<p>The <b id="__svg__SVGSVGElement__getIntersectionList">getIntersectionList</b>,
<b id="__svg__SVGSVGElement__getEnclosureList">getEnclosureList</b>,
<b id="__svg__SVGSVGElement__checkIntersection">checkIntersection</b> and
<b id="__svg__SVGSVGElement__checkEnclosure">checkEnclosure</b> methods are
used to perform geometry operations on <a>graphics elements</a> to find
those whose (or check whether their) graphical content lies partially or
completely within a given rectangle.</p>

<p>To <dfn id="TermFindIntersectingOrEnclosedDescendants" data-dfn-type="dfn" data-export="">find the intersecting
or enclosed descendants</dfn> of a given element <var>element</var>
with a given rectangle <var>rectangle</var> using <var>ancestor</var>
as the element in whose coordinate space <var>rectangle</var> is
to be interpreted, the following steps are run:</p>

<ol class='algorithm'>
  <li>Let <var>result</var> be an initially empty list.</li>
  <li>If <var>element</var> is not displayed, due to having a <a>'display'</a> value
  of <span class='prop-value'>none</span> or being in a subtree that has
  failing <a>conditional processing attributes</a> or a failing branch
  of a <a>'switch'</a>, then return <var>result</var>.</li>
  <li>For each child element <var>child</var> of <var>element</var>, in document order:
    <ol>
      <li>If <var>child</var> is an <a>'svg'</a> or <a>'g'</a> element, then:
        <ol>
          <li>Let <var>descendants</var> be the result of
          <a href="#TermFindIntersectingOrEnclosedDescendants">finding the
          intersecting (or enclosed) descendants</a> of <var>child</var> with
          <var>rectangle</var> in <var>ancestor</var>'s coordinate space.</li>
          <li>Append to <var>result</var> all the elements of <var>descendants</var>.</li>
        </ol>
      </li>
      <li>Otherwise, if <var>child</var> is a <a>'use'</a> element, then:
        <ol>
          <li>Let <var>root</var> be the root of the <var>child</var>'s shadow tree.</li>
          <li>Let <var>descendants</var> be the result of
          <a href="#TermFindIntersectingOrEnclosedDescendants">finding the
          intersecting (or enclosed) descendants</a> of <var>root</var> with
          <var>rectangle</var> in <var>ancestor</var>'s coordinate space.</li>
          <li>If <var>descendants</var> is not empty, then append <var>child</var>
          to <var>result</var>.
            <p class="note">This means that although we look at the
            elements in the <a>use-element shadow tree</a>,
            we don't place the <a>element instances</a> or their <a>corresponding element</a>
            in the <var>result</var> list; only the <a>'use'</a>
            element itself is returned.</p>
          </li>
        </ol>
      </li>
      <li>Otherwise, if <var>child</var> is a <a>graphics element</a>, then:
        <ol>
          <li>Let <var>region</var> be the shape in <var>child</var>'s coordinate
          system that is sensitive to hit detection, taking into account the
          rules for interpreting <var>child</var>'s <a>'pointer-events'</a> value.</li>
          <li>Transform <var>region</var> into <var>ancestor</var>'s coordinate system.</li>
          <li>If we are finding intersecting descendants and <var>region</var> lies partially
          or fully within <var>rectangle</var>, then append <var>child</var> to <var>result</var>.</li>
          <li>Otherwise, we are finding enclosed descendants.  If <var>region</var> lies
          fully within <var>rectangle</var>, then append <var>child</var> to <var>result</var>.</li>
        </ol>
      </li>
    </ol>
  </li>
  <li>Return <var>result</var>.</li>
</ol>

<p>To <dfn id="TermFindNonContainerGraphicsElements" data-dfn-type="dfn" data-export="">find the non-container
graphics elements</dfn> within a given element <var>element</var>, the following
steps are run:</p>

<ol class='algorithm'>
  <li>Let <var>result</var> be an initially empty list.</li>
  <li>If <var>element</var> is an <a>'svg'</a> or <a>'g'</a> element,
  then for each child element <var>child</var> of <var>element</var>,
  in document order:
    <ol>
      <li>Let <var>descendants</var> be the result of
      <a href="#TermFindNonContainerGraphicsElements">finding the non-container
      graphics elements</a> within <var>child</var>.</li>
      <li>Append to <var>result</var> all the elements of <var>descendants</var>.</li>
    </ol>
  </li>
  <li>Otherwise, if <var>element</var> is a <a>graphics element</a> then
  append <var>element</var> to <var>result</var>.</li>
  <li>Return <var>result</var>.</li>
</ol>

<p>When getIntersectionList(<var>rect</var>, <var>referenceElement</var>) or
getEnclosureList(<var>rect</var>, <var>referenceElement</var>) is called,
the following steps are run:</p>

<ol class='algorithm'>
  <li>Let <var>descendants</var> be a list, depending on what method we are in:
    <dl class='switch'>
      <dt><a href="#__svg__SVGSVGElement__getIntersectionList">getIntersectionList</a></dt>
      <dd><var>descendants</var> is the result of
      <a href="#TermFindIntersectingOrEnclosedDescendants">finding the intersecting descendants</a>
      of the current <a>'svg'</a> element with rectangle <var>rect</var>
      in the current <a>'svg'</a> element's coordinate system.</dd>
      <dt><a href="#__svg__SVGSVGElement__getEnclosureList">getEnclosureList</a></dt>
      <dd><var>descendants</var> is the result of
      <a href="#TermFindIntersectingOrEnclosedDescendants">finding the enclosed descendants</a>
      of the current <a>'svg'</a> element with rectangle <var>rect</var>
      in the current <a>'svg'</a> element's coordinate system.</dd>
    </dl>
  </li>
  <li>If <var>referenceElement</var> is not null, then remove from
  <var>descendants</var> any element that does not have <var>referenceElement</var>
  as an ancestor.</li>
  <li>Return a <a href="https://www.w3.org/TR/dom/#concept-collection-static">static</a>
  <a>NodeList</a> that contains all of the elements in <var>descendants</var>.
  ([<a href="refs.html#ref-dom">DOM</a>], section 5.2.7)</li>
</ol>

<p>When checkIntersection(<var>element</var>, <var>rect</var>) or
checkEnclosure(<var>element</var>, <var>rect</var>) is called,
the following steps are run:</p>

<ol class='algorithm'>
  <li>Let <var>descendants</var> be a list, depending on what method we are in:
    <dl class='switch'>
      <dt><a href="#__svg__SVGSVGElement__getIntersectionList">getIntersectionList</a></dt>
      <dd><var>descendants</var> is the result of
      <a href="#TermFindIntersectingOrEnclosedDescendants">finding the intersecting descendants</a>
      of the current <a>'svg'</a> element with rectangle <var>rect</var>
      in the current <a>'svg'</a> element's coordinate system.</dd>
      <dt><a href="#__svg__SVGSVGElement__getEnclosureList">getEnclosureList</a></dt>
      <dd><var>descendants</var> is the result of
      <a href="#TermFindIntersectingOrEnclosedDescendants">finding the enclosed descendants</a>
      of the current <a>'svg'</a> element with rectangle <var>rect</var>
      in the current <a>'svg'</a> element's coordinate system.</dd>
    </dl>
  </li>
  <li>Let <var>elements</var> be the result of
  <a href="#TermFindNonContainerGraphicsElements">finding the non-container
  graphics elements</a> within <var>element</var>.</li>
  <li>If <var>elements</var> is empty, then return false.</li>
  <li>If any element in <var>elements</var> is not also in <var>descendants</var>,
  then return false.</li>
  <li>Return true.</li>
</ol>

<div class='ready-for-wider-review'>
<p>The <b id="__svg__SVGSVGElement__deselectAll">deselectAll</b> method is
used to remove any selections from the document.  When deselectAll() is called,
all <a href="https://www.w3.org/TR/2014/WD-dom-20140204/#concept-range">ranges</a>
from the document's <a href="http://w3c.github.io/selection-api/#dom-selection">selection</a>
are removed and the <a href="http://w3c.github.io/selection-api/#dom-selection">selection</a>'s
<a href="http://w3c.github.io/selection-api/#dfn-direction">direction</a> is set to
forwards. [<a href="refs.html#ref-dom">DOM</a>][<a href="refs.html#ref-editing">EDITING</a>]
This method is deprecated, as it duplicates functionality from the Selection API.</p>

<p class="note">This is equivalent to calling <code>document.getSelection().removeAllRanges()</code>
on the document that this <a>'svg'</a> element is in.</p>
</div>

<p>The
<b id="__svg__SVGSVGElement__createSVGNumber">createSVGNumber</b>,
<b id="__svg__SVGSVGElement__createSVGLength">createSVGLength</b>,
<b id="__svg__SVGSVGElement__createSVGAngle">createSVGAngle</b>,
<b id="__svg__SVGSVGElement__createSVGPoint">createSVGPoint</b>,
<b id="__svg__SVGSVGElement__createSVGMatrix">createSVGMatrix</b>,
<b id="__svg__SVGSVGElement__createSVGRect">createSVGRect</b> and
<b id="__svg__SVGSVGElement__createSVGTransform">createSVGTransform</b>
methods are all factory functions used to create a new datatype object
of a particular type.  When one of these methods is called, a new
object is returned according to the following table:</p>

<table class='vert'>
  <tr><th>Method</th><th>Object and details</th></tr>
  <tr><td><a href="#__svg__SVGSVGElement__createSVGNumber">createSVGNumber</a></td><td>A new, <a href="types.html#NumberMode">detached</a> <a>SVGNumber</a> object whose value is 0.</td></tr>
  <tr><td><a href="#__svg__SVGSVGElement__createSVGLength">createSVGLength</a></td><td>A new, <a href="types.html#LengthMode">detached</a> <a>SVGLength</a> object whose value is the unitless <a>&lt;number&gt;</a> 0.</td></tr>
  <tr><td><a href="#__svg__SVGSVGElement__createSVGAngle">createSVGAngle</a></td><td>A new, <a href="types.html#AngleMode">detached</a> <a>SVGAngle</a> object whose value is the unitless <a>&lt;number&gt;</a> 0.</td></tr>
  <tr><td><a href="#__svg__SVGSVGElement__createSVGPoint">createSVGPoint</a></td><td>A new, <a href="shapes.html#PointMode">detached</a> <a>DOMPoint</a> object whose coordinates are all 0.</td></tr>
  <tr><td><a href="#__svg__SVGSVGElement__createSVGMatrix">createSVGMatrix</a></td><td>A new, <a href="coords.html#MatrixMode">detached</a> <a>DOMMatrix</a> object representing the identity matrix.</td></tr>
  <tr><td><a href="#__svg__SVGSVGElement__createSVGRect">createSVGRect</a></td><td>A new, <a>DOMRect</a> object whose x, y, width and height are all 0.</td></tr>
  <tr><td><a href="#__svg__SVGSVGElement__createSVGTransform">createSVGTransform</a></td><td>A new, <a href="coords.html#TransformMode">detached</a> <a>SVGTransform</a> object whose value is <span class='prop-value'>matrix(1, 0, 0, 1, 0, 0)</span>.</td></tr>
</table>

<p>The <a href="#__svg__SVGSVGElement__createSVGPoint">createSVGPoint</a>,
<a href="#__svg__SVGSVGElement__createSVGMatrix">createSVGMatrix</a> and
<a href="#__svg__SVGSVGElement__createSVGRect">createSVGRect</a> methods
are all deprecated and kept only for compatibility with legacy content.
Authors are encouraged to use the <a>DOMPoint</a>, <a>DOMMatrix</a> and
<a>DOMRect</a> constructors instead.</p>

<p>The <b id="__svg__SVGSVGElement__createSVGTransformFromMatrix">createSVGTransformFromMatrix</b>
method is used to create a new <a>SVGTransform</a> object from a matrix object.
Its behavior is the same as the
<a href="coords.html#__svg__SVGTransformList__createSVGTransformFromMatrix">createSVGTransformFromMatrix</a>
method on <a>SVGTransformList</a>.</p>

<div class='ready-for-wider-review'>
<p>The <b id="__svg__SVGSVGElement__getElementById">getElementById</b> method,
must return the first element in <a>tree order</a>, within the
<a>'svg'</a> element's descendants, whose ID is <var>elementId</var>, or
null if there is no such element.</p>
</div>

</edit:with>


<h3 id="InterfaceSVGGElement">Interface SVGGElement</h3>

<edit:with element="g">

<p>An <a>SVGGElement</a> object represents a <a>'g'</a> element in the DOM.</p>

<pre class="idl">[Exposed=Window]
interface <b>SVGGElement</b> : <a>SVGGraphicsElement</a> {
};</pre>

</edit:with>


<h3 id="InterfaceSVGUnknownElement">Interface SVGUnknownElement</h3>

<edit:with element="unknown">

<p>An <a>SVGUnknownElement</a> object represents an unknown element in the SVG namespace.</p>

<pre class="idl">[Exposed=Window]
interface <b>SVGUnknownElement</b> : <a>SVGGraphicsElement</a> {
};</pre>

</edit:with>


<h3 id="InterfaceSVGDefsElement">Interface SVGDefsElement</h3>

<edit:with element="defs">

<p>An <a>SVGDefsElement</a> object represents a <a>'defs'</a> element in the DOM.</p>

<pre class="idl">[Exposed=Window]
interface <b>SVGDefsElement</b> : <a>SVGGraphicsElement</a> {
};</pre>

</edit:with>


<h3 id="InterfaceSVGDescElement">Interface SVGDescElement</h3>

<edit:with element="desc">

<p>An <a>SVGDescElement</a> object represents a <a>'desc'</a> element in the DOM.</p>

<pre class="idl">[Exposed=Window]
interface <b>SVGDescElement</b> : <a>SVGElement</a> {
};</pre>

</edit:with>


<h3 id="InterfaceSVGMetadataElement">Interface SVGMetadataElement</h3>

<edit:with element="metadata">

<p>An <a>SVGMetadataElement</a> object represents a <a>'metadata'</a> element in the DOM.</p>

<pre class="idl">[Exposed=Window]
interface <b>SVGMetadataElement</b> : <a>SVGElement</a> {
};</pre>

</edit:with>


<h3 id="InterfaceSVGTitleElement">Interface SVGTitleElement</h3>

<edit:with element="title">

<p>An <a>SVGTitleElement</a> object represents a <a>'title'</a> element in the DOM.</p>

<pre class="idl">[Exposed=Window]
interface <b>SVGTitleElement</b> : <a>SVGElement</a> {
};</pre>

</edit:with>


<h3 id="InterfaceSVGSymbolElement">Interface SVGSymbolElement</h3>

<edit:with element="symbol">

<p>An <a>SVGSymbolElement</a> object represents a <a>'symbol'</a> element in the DOM.</p>

<pre class="idl">[Exposed=Window]
interface <b>SVGSymbolElement</b> : <a>SVGGraphicsElement</a> {
};

<a>SVGSymbolElement</a> includes <a>SVGFitToViewBox</a>;</pre>

<p class="note">
  New in SVG 2.
  The <a>SVGSymbolElement</a> interface now inherits from <a>SVGGraphicsElement</a>,
  so that the instantiated symbol in the shadow DOM can be queried as a graphics element.
</p>

</edit:with>


<h3 id="InterfaceSVGUseElement">Interface SVGUseElement</h3>

<edit:with element="use">

<p>An <a>SVGUseElement</a> object represents a <a>'use'</a> element in the DOM.</p>

<pre class="idl">[Exposed=Window]
interface <b>SVGUseElement</b> : <a>SVGGraphicsElement</a> {
  [SameObject] readonly attribute <a>SVGAnimatedLength</a> <a href="struct.html#__svg__SVGUseElement__x">x</a>;
  [SameObject] readonly attribute <a>SVGAnimatedLength</a> <a href="struct.html#__svg__SVGUseElement__y">y</a>;
  [SameObject] readonly attribute <a>SVGAnimatedLength</a> <a href="struct.html#__svg__SVGUseElement__width">width</a>;
  [SameObject] readonly attribute <a>SVGAnimatedLength</a> <a href="struct.html#__svg__SVGUseElement__height">height</a>;
  [SameObject] readonly attribute <a>SVGElement</a>? <a href="struct.html#__svg__SVGUseElement__instanceRoot">instanceRoot</a>;
  [SameObject] readonly attribute <a>SVGElement</a>? <a href="struct.html#__svg__SVGUseElement__animatedInstanceRoot">animatedInstanceRoot</a>;
};

<a>SVGUseElement</a> includes <a>SVGURIReference</a>;</pre>

<p>The
<b id="__svg__SVGUseElement__x">x</b>,
<b id="__svg__SVGUseElement__y">y</b>,
<b id="__svg__SVGUseElement__width">width</b> and
<b id="__svg__SVGUseElement__height">height</b> IDL attributes
<a>reflect</a> the computed values of the <a>'x'</a>, <a>'y'</a>, <a>'width'</a> and
<a>'height'</a> properties and their corresponding
presentation attributes, respectively.</p>

<p>The <b id="__svg__SVGUseElement__instanceRoot">instanceRoot</b> and
<b id="__svg__SVGUseElement__animatedInstanceRoot">animatedInstanceRoot</b>
IDL attributes both point to the <a>instance root</a>,
the <a>SVGElementInstance</a> that is a direct child
of this element's shadow root
(<code>u.instanceRoot</code> is equivalent to getting <code>u.shadowRoot.firstChild</code>).
If this element does not have a shadow tree
(for example, because its URI is invalid
or because it has been disabled by <a>conditional processing</a>),
then getting these attributes returns null.</p>

</edit:with>


<h3 id="InterfaceSVGUseElementShadowRoot">Interface SVGUseElementShadowRoot</h3>

<p>The root object of each <a>use-element shadow tree</a>
  implements the <a>SVGUseElementShadowRoot</a> interface.
  This interface does not currently define any extensions
  to the properties and methods defined for the
  <a>ShadowRoot</a> interface
  and <a href="https://dom.spec.whatwg.org/#mixin-documentorshadowroot">DocumentOrShadowRoot</a> mixin.
  However, the tree rooted at this node
  is entirely read-only from the perspective of author scripts.</p>

<pre class="idl">[Exposed=Window]
interface <b>SVGUseElementShadowRoot</b> : <a>ShadowRoot</a> {
};</pre>

<h3 id="InterfaceSVGElementInstance" data-dfn-type="interface" data-lt="SVGElementInstance">Mixin SVGElementInstance</h3>

<p>The <a>SVGElementInstance</a> interface defines extensions to the <a>SVGElement</a> interface,
  which are only used for elements in a <a>use-element shadow tree</a>.</p>

<p class="note">
  In previous versions of SVG,
  SVG element instances were defined as non-element objects
  that were valid event targets but not full DOM nodes.
  This specification re-defines the <a>use-element shadow tree</a>
  to be consistent with the Shadow DOM specification,
  which means that instances are actual SVGElement objects.
  This interface adds the missing functionality for backwards compatibility.
  However, authors should be aware that compatibility is not perfect,
  and design their scripts accordingly.
  Also note that these properties will not be available
  on HTML-namespaced element objects in the shadow tree.
</p>

<pre class="idl">interface mixin <b>SVGElementInstance</b> {
  [SameObject] readonly attribute <a>SVGElement</a>? <a href="#__svg__SVGElementInstance__correspondingElement">correspondingElement</a>;
  [SameObject] readonly attribute <a>SVGUseElement</a>? <a href="#__svg__SVGElementInstance__correspondingUseElement">correspondingUseElement</a>;
};</pre>

<p>The <b id="__svg__SVGElementInstance__correspondingElement">correspondingElement</b> IDL attribute
points to the <a>corresponding element</a> if this element is an <a>element instance</a> in a <a>use-element shadow tree</a>,
or is null otherwise.</p>

<p class="issue" data-issue="71">
  When the <a>referenced element</a> is in an external file,
  the presence of this pointer
  implies that the entire DOM of the external file
  must be maintained in memory.
  However, as currently specified, the external DOM is read-only.
  It therefore offers limited functionality and a potentially large performance impact.
  Pending feedback from implementers,
  authors should consider the use of <code>correspondingElement</code>
  with external file references to be at-risk.
</p>

<p>The <b id="__svg__SVGElementInstance__correspondingUseElement">correspondingUseElement</b> IDL attribute
points to the <a>corresponding use element</a> if this element is an <a>element instance</a> in a <a>use-element shadow tree</a>,
or is null otherwise.</p>

<h3 id="InterfaceShadowAnimation">Interface ShadowAnimation</h3>

<p>The <a>ShadowAnimation</a> inteface defines a read-only <a>Animation</a> object,
  which mirrors all changes to the <a>ShadowAnimation::sourceAnimation</a> object
  from which it was constructed.
  They are used to mirror author-initiated animation objects in the
  <a>use-element shadow tree</a>.
</p>


<pre class="idl">[<i>Constructor</i>(<a>Animation</a> source, <a>Animatable</a> newTarget), Exposed=Window]
interface <b>ShadowAnimation</b> : <a>Animation</a> {
  [SameObject] readonly attribute <a>Animation</a> <a href="#__svg__ShadowAnimation__sourceAnimation">sourceAnimation</a>;
};</pre>

<p>The <b id="__svg__ShadowAnimation__sourceAnimation">sourceAnimation</b> IDL property
  points to the <a>Animation</a> object passed in the constructor.
</p>

<p>
  The constructor generates a new <a>ShadowAnimation</a> object,
  which reflects all properties on the <a>ShadowAnimation::sourceAnimation</a>,
  except that its <a href="https://www.w3.org/TR/web-animations-1/#dom-animation-effect"><code>effect</code></a> is created by constructing a new
  <a href="https://www.w3.org/TR/web-animations-1/#keyframeeffectreadonly"><code>KeyframeEffectReadOnly</code></a>
  using the keyframe effect of the <a>ShadowAnimation::sourceAnimation</a> as its source,
  and then modifying its <a href="https://www.w3.org/TR/web-animations-1/#dom-keyframeeffectreadonly-target"><code>target</code></a>
  to match the <code>newTarget</code> parameter.
</p>


<p>
  A <a>ShadowAnimation</a> is read-only.
  Any attempt to set any of the inherited IDL properties,
  or call any of the <a>Animation</a> methods that change its state,
  must throw a <code>NoModificationAllowedError</code>.
  However, the user agent must ensure that
  any changes to the properties or state
  of the <a>ShadowAnimation::sourceAnimation</a> are reflected
  in changes to the <a>ShadowAnimation</a>.
</p>

<h3 id="InterfaceSVGSwitchElement">Interface SVGSwitchElement</h3>

<edit:with element="switch">

<p>An <a>SVGSwitchElement</a> object represents a <a>'switch'</a> element in the DOM.</p>

<pre class="idl">[Exposed=Window]
interface <b>SVGSwitchElement</b> : <a>SVGGraphicsElement</a> {
};</pre>

</edit:with>


<h3 id="InterfaceGetSVGDocument" data-dfn-type="interface" data-lt="GetSVGDocument">Mixin GetSVGDocument</h3>

<p>This interface provides access to an SVG document embedded by reference
in another DOM-based language. The expectation is that the interface is
implemented on DOM objects that allow such SVG document references.</p>

<p>This interface is deprecated and may be dropped from future versions of
the SVG specification.  To access the SVG document inside an
<span class="element-name">'iframe'</span> or
<span class="element-name">'object'</span> element,
authors are suggested to use the <code>contentDocument</code>
attribute on the <a>HTMLIFrameElement</a> or <a>HTMLObjectElement</a>
interface, respectively.</p>

<p class="note">The <a>HTMLIFrameElement</a>, <a>HTMLEmbedElement</a>
and <a>HTMLObjectElement</a> interfaces all define their own getSVGDocument
method, which provides access to the SVG document in the same way that
the <a>GetSVGDocument</a> does.  Those three interfaces therefore do not need
to implement <a>GetSVGDocument</a>.  Still, authors are strongly recommended
to use contentDocument instead.</p>

<pre class="idl">interface mixin <b>GetSVGDocument</b> {
  <a>Document</a> <a href="struct.html#__svg__GetSVGDocument__getSVGDocument">getSVGDocument</a>();
};</pre>

<p>The <b id="__svg__GetSVGDocument__getSVGDocument">getSVGDocument</b> method
is used to return a referenced SVG document.  When getSVGDocument() is called,
it must return the <a>Document</a> object referenced by the embedding element
that implements the <a>GetSVGDocument</a> interface; if there is no document,
null is returned.</p>

<p class="note">Note that this does no check to see whether the referenced
document is indeed an SVG document.  Instead, any document is returned.</p>
</div>

</body>
</html>
