<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional+edit//EN" "xhtml1-transitional+edit.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:edit="http://xmlns.grorg.org/SVGT12NG/">
<head>
  <title>Text</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <link rel="stylesheet"           title="Default"               type="text/css" media="screen" href="style/default_svg.css"/>
  <link rel="alternate stylesheet" title="No issues/annotations" type="text/css" media="screen" href="style/default_no_issues.css"/>
  <!--
  <link rel="alternate stylesheet" title="CSS3 Unmodified"       type="text/css" media="screen" href="style/default.css"/>
  <link rel="alternate stylesheet" title="SVG 1.1"               type="text/css" media="screen" href="style/svg-style.css"/>
  -->
  <!-- W3C style sheet will be added here during processing. -->
</head>
<body>

<p class='issue'>Note that this chapter is in the process of being substantially rewritten.</p>

<h1>Text</h1>

<!-- THESE ANNOTATIONS NEED TO BE MOVED TO PROPER SECTIONS -->

<div class="annotation svg2-requirement">
  <table>
    <tr>
      <th>SVG 2 Requirement:</th>
      <td>Support text in shapes.</td>
    </tr>
    <tr>
      <th>Resolution:</th>
      <td><a href="http://www.w3.org/2011/11/17-svg-irc#T22-04-11">SVG 2 will require automatic text wrapping compatible with CSS.</a></td>
    </tr>
    <tr>
      <th>Purpose:</th>
      <td>Text in flow charts, etc.</td>
    </tr>
    <tr>
      <th>Owner:</th>
      <td>Tav (no action)</td>
    </tr>
  </table>
</div>

<div class="annotation svg2-requirement">
  <table>
    <tr>
      <th>SVG 2 Requirement:</th>
      <td>Have a way to specify flip-invariant text.</td>
    </tr>
    <tr>
      <th>Resolution:</th>
      <td><a href="http://www.w3.org/2011/11/17-svg-irc#T22-26-26">SVG 2 will have a way to specify flip-invariant text.</a></td>
    </tr>
    <tr>
      <th>Purpose:</th>
      <td>To keep text readable if an image is rotated.</td>
    </tr>
    <tr>
      <th>Owner:</th>
      <td>Doug (no action)</td>
    </tr>
  </table>
</div>

<div class="annotation svg2-requirement">
  <table>
    <tr>
      <th>SVG 2 Requirement:</th>
      <td>Include explicit support for Web Open Font Format (WOFF).</td>
    </tr>
    <tr>
      <th>Resolution:</th>
      <td><a href="http://www.w3.org/2011/03/01-svg-minutes.html#item03">We will mandate WOFF support in SVG 2.</a></td>
    </tr>
    <tr>
      <th>Purpose:</th>
      <td>To allow access to full OpenType features for internationalisation and advanced typography.</td>
    </tr>
    <tr>
      <th>Owner:</th>
      <td>Chris (no action)</td>
    </tr>
  </table>
</div>

<div class="annotation svg2-requirement">
  <table>
    <tr>
      <th>SVG 2 Requirement:</th>
      <td>Reference CSS3 Fonts.</td>
    </tr>
    <tr>
      <th>Resolution:</th>
      <td><a href="http://www.w3.org/2011/07/29-svg-minutes.html#item08">SVG 2 will depend on CSS3 Fonts.</a></td>
    </tr>
    <tr>
      <th>Purpose:</th>
      <td>Alignment with CSS 2.1 and CSS3 for Web font functionality, and to provide
      access to advanced typographic features of fonts.</td>
    </tr>
    <tr>
      <th>Owner:</th>
      <td>Chris (<a href="http://www.w3.org/Graphics/SVG/WG/track/actions/3123">ACTION-3123</a>)</td>
    </tr>
  </table>
</div>

<h2 id="Introduction">Introduction</h2>

  <p>
    Text that is to be rendered as part of an SVG document fragment is
    specified using the <a>'text'</a> element. The characters to be
    drawn are expressed as
    <a href="http://www.w3.org/TR/2008/REC-xml-20081126/#syntax">XML
    character data</a> ([<a href="refs.html#ref-XML10">XML10</a>],
    section 2.4) inside the <a>'text'</a> element.
  </p>

  <p>
    SVG's <a>'text'</a> elements are rendered like other graphics
    elements. Thus, <a href="coords.html">coordinate system
    transformations</a>, <a href="painting.html">painting</a>,
    <a href="masking.html">clipping</a> and
    <a href="masking.html">masking</a> features apply to
    <a>'text'</a> elements in the same way as they apply to
    <a>shapes</a> such as
    <a href="paths.html">paths</a> and <a href="shapes.html#RectElement">rectangles</a>.
  </p>

  <p>
    Each <a>'text'</a> element causes a section of text to be
    rendered. The text can be rendered:
  </p>
  <ul>
    <li>pre-formatted (with limited line wrapping),</li>
    <li>auto-wrapped (if a <a>content area</a> is provided),</li>
    <li>on a path (if a <a>'textPath'</a> element is provided).</li>
  </ul>

  <p>
    SVG supports the following international text processing features for
    all text:
  </p>
  <ul>
    <li>horizontal and vertical orientation of text,</li>

    <li>left-to-right or bidirectional text (i.e., languages
    which intermix right-to-left and left-to-right text, such as
    Arabic and Hebrew),</li>

    <li>when <a href="fonts.html#SVGFontsOverview">SVG fonts</a> are
    used, automatic selection of the correct glyph corresponding
    to the current form for
    <a href="fonts.html#GlyphElementArabicFormAttribute">Arabic</a>
    and <a href="fonts.html#GlyphElementLangAttribute">Han</a>
    text.
    <p class="issue">What about Hebrew, Hindi, etc.?</p>
    </li>
  </ul>

  <p>
    The section <a href="text.html#TextLayout">Text layout</a> gives an
    introduction to text layout. It is followed by sections covering
    <a href="text.html#TextLayoutContentArea">content areas</a>,
    <a href="text.html#TextLayoutDirections">writing directions</a> and
    <a href="text.html#TextLayoutPositioning">general glyph
    positioning</a>. The specialized layout rules corresponding to
    text that is
    <a href="text.html#TextLayoutPre">pre-formatted</a>,
    <a href="text.html#TextLayoutAuto">auto-wrapped</a>, and
    <a href="text.html#TextLayoutPath">on a path</a>
    are then addressed in individual sections.
  </p>

  <p class="note">
    Rules for text layout in SVG 1.1 are mostly defined within the SVG
    1.1 specification. The rules mirror to a large extent those found
    in CSS. In SVG 2, the dependence on CSS is more explicit. In
    practice the end layout is the same. The change to directly
    relying on CSS specifications simplifies the SVG specification
    while making it more obvious that rendering agents can use the
    same code to both render text in HTML and in SVG. It also allows
    the easy extension of SVG text layout to include things like
    automatic text wrapping.
  </p>

  <p>
    Because SVG text is packaged as XML character data:
  </p>

  <ul>
    <li>
      Text data in SVG content is readily accessible to the visually
      impaired (see <a href="access.html">Accessibility
      Support</a>),
    </li>

    <li>
      In many viewing scenarios, the user will be able to search for
      and select text strings and copy selected text strings to the
      system clipboard (see <a href="text.html#TextSelection">Text
      selection and clipboard operations</a>),
    </li>

    <li>
      XML-compatible Web search engines will find text strings in
      SVG content with no additional effort over what they need to
      do to find text strings in other XML documents.
    </li>
  </ul>

  <p>
    Multi-language SVG content is possible by
    <a href="i18n.html#I18nTextSubstitution">substituting different
    text strings based on the user's preferred language</a>.
  </p>

  <p>
    For accessibility reasons, it is recommended that text which is
    included in a document have appropriate semantic markup to
    indicate its function.
    See <a href="access.html#SVGAccessibilityGuidelines">SVG
    accessibility guidelines</a> for more information.
  </p>

<h2 id="CharactersAndGlyphs">Characters and their corresponding glyphs</h2>

  <p>
    In XML
    [<a href="http://www.w3.org/TR/2008/REC-xml-20081126/">XML10</a>],
    textual content is defined in terms of a sequence of XML
    characters, where each character is defined by a particular
    Unicode code point [<a href="refs.html#ref-UNICODE">UNICODE</a>].
    Fonts, on the other hand, consist of a collection of
    <a>glyphs</a> and other associated information, such as
    <a href="text.html#FontsTablesBaselines">font tables</a>. A glyph is a
    presentable form of one or more characters (or a part of a character
    in some cases). Each glyph consists of some sort of identifier (in
    some cases a string, in other cases a number) along with drawing
    instructions for rendering that particular glyph.
  </p>

  <p>
    In many cases, there is a one-to-one mapping of Unicode characters
    (i.e., Unicode code points) to glyphs in a font. For example, it
    is common for a font designed for Latin languages (where the
    term <em>Latin</em> is used for European languages such as English
    with alphabets similar to and/or derivative to the Latin language)
    to contain a single glyph for each of the standard ASCII
    characters (i.e., A-to-Z, a-to-z, 0-to-9, plus the various
    punctuation characters found in ASCII). Thus, in most situations,
    the string "XML", which consists of three Unicode characters,
    would be rendered by the three glyphs corresponding to "X", "M"
    and "L", respectively.
  </p>

  <p>
    In various other cases, however, there is not a strict one-to-one
    mapping of Unicode characters to glyphs. Some of the circumstances
    when the mapping is not one-to-one:
  </p>
  
  <ul>
    <li>
      Ligatures &#x2013; For best looking typesetting, it is often desirable
      that particular sequences of characters are rendered as a single
      glyph. An example is the word "office".  Many fonts will define
      an "ffi" ligature. When the word "office" is rendered, sometimes
      the user agent will render the glyph for the "ffi" ligature
      instead of rendering distinct glyphs (i.e., "f", "f" and "i")
      for each of the three characters. Thus, for ligatures, multiple
      Unicode characters map to a single glyph. (Note that for proper
      rendering of some languages, ligatures are required for certain
      character combinations.)
    </li>

    <li>
      Composite characters &#x2013; In various situations, commonly used
      adornments such as diacritical marks will be stored once in a
      font as a particular glyph and then composed with one or more
      other glyphs to result in the desired character. For example, it
      is possible that a font engine might render the
      <span class="code-fragment">é</span> character by first
      rendering the glyph for <span class="code-fragment">e</span> and
      then rendering the glyph for
      <span class="code-fragment">&#xb4;</span> (the accent mark)
      such that the accent mark will appear over
      the <span class="code-fragment">e</span>. In this situation, a
      single Unicode character maps to multiple glyphs.
    </li>

    <li>
      Glyph substitution &#x2013; Some typography systems examine the nature
      of the textual content and utilize different glyphs in different
      circumstances. For example, in Arabic, the same Unicode
      character might render as any of four different glyphs,
      depending on such factors as whether the character appears at
      the start, the end or the middle of a sequence of cursively
      joined characters. Different glyphs might be used for a
      punctuation character depending on inline-progression-direction
      (e.g., horizontal vs. vertical).  In these situations, a single
      Unicode character might map to one of several alternative
      glyphs.
    </li>

    <li>
      In some languages, particular sequences of characters will be
      converted into multiple glyphs such that parts of a particular
      character are in one glyph and the remainder of that character
      is in another glyph.
    </li>

    <li>
      Alternative glyph specification &#x2013; SVG contains a facility for
      the author to explicitly specify that a particular sequence of
      Unicode characters is to be rendered using a particular
      glyph. (See <a href="text.html#AlternateGlyphs">Alternate
      glyphs</a>.) When this facility is used, multiple Unicode
      characters map to a single glyph.
    </li>
  </ul>

  <p>
    In many situations, the algorithms for mapping from characters to
    glyphs are system-dependent, resulting in the possibility that the
    rendering of text might be (usually slightly) different when
    viewed in different user environments.  If the author of SVG
    content requires precise selection of fonts and glyphs, then the
    recommendation is that the necessary fonts (potentially subsetted
    to include only the glyphs needed for the given document) be
    available either as <a href="fonts.html#SVGFontsOverview">SVG
    fonts</a> embedded within the SVG content or as
    <a href="http://www.w3.org/TR/2011/WD-css3-fonts-20111004/#introduction">downloadable
    fonts</a> ([<a href="refs.html#ref-CSS3FONTS">CSS3FONTS</a>],
    section 1) posted at the same Web location as the SVG content.
  </p>

  <p>
    Throughout this chapter, the term <em>character</em> shall be
    equivalent to the definition of a character in XML
    [<a href="http://www.w3.org/TR/2008/REC-xml-20081126/">XML10</a>].
  </p>

<h2 id="FontsTablesBaselines">Fonts, font tables and baselines</h2>

  <div class="annotation svg2-requirement">
    <table>
      <tr>
	<th>SVG 2 Requirement:</th>
	<td>Support text aligned to different baselines.</td>
      </tr>
      <tr>
	<th>Resolution:</th>
	<td><a href="http://www.w3.org/2012/03/15-svg-irc#T21-07-21">SVG 2 will support glyphs being aligned to different baselines, perhaps by using existing or improved CSS properties.</a></td>
      </tr>
      <tr>
	<th>Purpose:</th>
	<td>To allow glyphs in horizontal text to have different vertical alignments for stylistic effects.</td>
      </tr>
      <tr>
	<th>Owner:</th>
	<td>Chris (no action)</td>
      </tr>
    </table>
  </div>
  
  <p>Reliable delivery of fonts is a requirement for SVG.
Designers need to create SVG content with arbitrary fonts and
know that the same graphical result will appear when the
content is viewed by all end users, even when end users do not
have the necessary fonts installed on their computers. This
parallels the print world, where the designer uses a given font
when authoring a drawing for print, and the graphical content
appears exactly the same in the printed version as it appeared
on the designer's authoring system.</p>

<p>SVG utilizes the
<a href="http://dev.w3.org/csswg/css3-fonts/">WebFonts</a>
facility defined in
([<a href="refs.html#ref-CSS3FONTS">CSS3 Fonts</a>]) as a key
mechanism for reliable delivery of font data to end users. In a
common scenario, SVG authoring applications generate
compressed, subsetted WebFonts
for all text elements used by a given SVG document fragment.</p>

<p>One disadvantage to the WebFont
facility in the past was that specifications did not require
support of particular font formats. The result was that
different implementations supported different Web font formats,
thereby making it difficult for Web site creators to post a
single Web site using WebFonts that worked across all user
agents.</p>

<p>SVG 2 mandates support for Web Open Font Format [<a href="refs.html#ref-WOFF">WOFF</a>], which 
 is now supported in <a href="http://w3c-test.org/framework/review/woff-at/">most user agents</a>. Besides enabling compressed, subsetted WebFonts
with accompanying metadata for clear licensing, WOFF also benefits from OpenType multilingual features 
and support for advanced typography. Thus, content authors can author CSS to request discretionary ligatures, 
swash forms, old-style figures etc. while also ensuring that a font is provided which supports those features.</p>

  <p>
    A font consists of a collection of glyphs together with other
    information (collectively, the font tables) necessary to use those glyphs to
    present characters on some visual medium. The combination of the
    collection of glyphs and the font tables is called the <em>font
    data</em>. The font tables include the information necessary to
    map characters to glyphs, to determine the size of glyph areas and
    to position the glyph area. <!-- next sentence is loose and should be impoved -->
    Each font table consists of one or
    more font characteristics, such as the font-weight and
    font-style.
  </p>

  <p>
    The geometric font characteristics are expressed in a coordinate
    system based on the EM box. (The EM is a relative measure of the
    height of the glyphs in the font.)  The box 1 EM high and 1 EM
    wide is called the <em>design space</em>. This space is given a
    geometric coordinates by sub-dividing the EM into a number
    of <em>units per em</em>.
  </p>

  <p class="note">
    Units per em is a font characteristic. A typical value
    for units per em is 1000 or 2048.
  </p>

  <p>
    The coordinate space of the EM box is called the <em>design space
    coordinate system</em>. For scalable fonts, the curves and lines
    that are used to draw a glyph are represented using this
    coordinate system.
  </p>

  <p class="note">
    Most often, the (0,0) point in this coordinate system is
    positioned on the left edge of the EM box, but not at the bottom
    left corner. The Y coordinate of the bottom of a roman capital
    letter is usually zero. And the descenders on lowercase roman
    letters have negative coordinate values.
  </p>
  <p class="issue">Insert figure.</p>

  <p>
    SVG assumes that the font tables will provide at least three font
    characteristics: an ascent, a descent and a set of
    baseline-tables. The ascent is the distance to the top of the EM
    box from the (0,0) point of the font; the descent is the distance
    to the bottom of the EM box from the (0.0) point of the font. The
    baseline-table is explained below.
  </p>

  <p class="note">
    Within an OpenType font, for horizontal writing-modes,
    the ascent and descent are given by the sTypoAscender and
    sTypoDescender entries in the OS/2 table. For vertical writing-modes,
    the descent (the distance, in this case from the (0,0) point to the
    left edge of the glyph) is normally zero because the (0,0) point is on
    the left edge. The ascent for vertical writing-modes is either 1 em or
    is specified by the ideographic top baseline value in the OpenType
    Base table for vertical writing-modes.
  </p>

  <p>
    In horizontal writing-modes, the glyphs of a given script
    are positioned so that a particular point on each glyph, the
    <em><a href="text.html#AlignmentPoint">alignment-point</a></em>,
    is aligned with the alignment-points of the other glyphs in that
    script. The glyphs of different scripts, for example, Western,
    Northern Indic and Far-Eastern scripts, are typically aligned at
    different points on the glyph. For example, Western glyphs are
    aligned on the bottoms of the capital letters, northern indic
    glyphs are aligned at the top of a horizontal stroke near the top
    of the glyphs and far-eastern glyphs are aligned either at the
    bottom or center of the glyph. Within a script and within a line
    of text having a single font-size, the sequence of
    alignment-points defines, in the inline- progression-direction, a
    geometric line called a <em>baseline</em>. Western and most other
    alphabetic and syllabic glyphs are aligned to an "alphabetic"
    baseline, the northern indic glyphs are aligned to a "hanging"
    baseline and the far-eastern glyphs are aligned to an
    "ideographic" baseline.
  </p>
  <p class="issue">Insert figure.</p>

  <p>
    A <em>baseline-table</em> specifies the position of one or more
    baselines in the design space coordinate system. The function of
    the baseline table is to facilitate the alignment of different
    scripts with respect to each other when they are mixed on the same
    text line. Because the desired relative alignments may depend on
    which script is dominant in a line (or block), there may be a
    different baseline table for each script. In addition, different
    alignment positions are needed for horizontal and vertical writing
    modes. Therefore, the font may have a set of baseline tables:
    typically, one or more for horizontal writing-modes and zero or
    more for vertical writing-modes.
  </p>

  <p class="note">
    Some fonts may not have values for the baseline tables. Heuristics
    are suggested for approximating the baseline tables when a given
    font does not supply baseline tables.
  </p>

  <p>
    SVG further assumes that for each glyph in the font data for a
    font, there are two width values, two alignment-baselines and two
    alignment-points, one each for horizontal writing-modes and the
    other for vertical writing-modes. (Even though it is specified as
    a width, for vertical writing-modes the width is used in the
    vertical direction.) The script to which a glyph belongs
    determines an alignment-baseline to which the glyph is to be
    aligned. The
    <a href="text.html#InlineProgressionDirection">inline-progression-direction</a>
    position of the alignment-point is on the start-edge of the glyph.
  </p>

  <p>
    Properties related to baselines are described below under
    <a href="text.html#BaselineAlignmentProperties">Baseline alignment
      properties</a>.
  </p>

  <p>
    In addition to the font characteristics required above, a font may
    also supply substitution and positioning tables that can be used
    by a formatter to re-order, combine and position a sequence of
    glyphs to make one or more composite glyphs. The combination may
    be as simple as a ligature, or as complex as an indic syllable
    which combines, usually with some re-ordering, multiple consonants
    and vowel glyphs.
  </p>

  <div class="issue">
    <p>
      The discussion of vertical text (CJK and Mongolian) is
      lacking. Here are some notes:
    </p>
    <ul>
      <li>Some Japanese opentype fonts have different glyphs for horizontal and vertical text.</li>
      <li>Kanji is set in a box 1 zenkaku width x 1 zenkaku width.</li>
      <li>Kanji baseline divides box into 88:12 ratio.</li>
      <li>Japanese/Latin mixed, 1 zenkaku should be slightly smaller than 1 em (ex. 10pt: 3.25mm vs 3.51mm).</li>
      <li>See: <a href="http://ajt.ktug.org/2008/0201okumura.pdf">pTEX and Japanese Typesetting</a>.</li>
      <li>Vertical kana can have ligatures!</li>
      <li>At least one proportional (horizontal and vertical) Japanese font exists.</li>
      <li>See: <a href="http://www.imug.org/presentations/imug-lunde-09162010.pdf">Kazuraki: Adobe Systems' Groundbreaking New Japanese Typeface</a>.</li>
    </ul>
  </div>

    
<h2 id="TextElement">The <span class="element-name">'text'</span> element</h2>

  <edit:with element='text'>

  <p>
    The <a>'text'</a> element defines a graphics element consisting of
    text. The XML character data within the <a>'text'</a> element,
    along with relevant attributes and properties, and
    character-to-glyph mapping tables within the font itself, define
    the glyphs to be rendered. (See
    <a href="text.html#CharactersAndGlyphs">Characters and their
    corresponding glyphs</a>.) The attributes and properties on
    the <a>'text'</a> element indicate such things as the writing
    direction, font specification, and painting attributes which
    describe how exactly to render the characters. Subsequent sections
    of this chapter describe the relevant text-specific attributes and
    properties, particular <a href="text.html#TextLayout">text
    layout</a> and
    <a href="text.html#RelationshipWithBiDirectionality">bidirectionality</a>.
  </p>

  <p>
    Since <a>'text'</a> elements are rendered using the same rendering
    methods as other graphics elements, all of the same
    <a href="coords.html">coordinate system transformations</a>, 
    <a href="painting.html">painting</a>, 
    <a href="masking.html">clipping</a>, and 
    <a href="masking.html">masking</a> features that apply to 
    <a>shapes</a> such as <a href="paths.html">paths</a> and 
    <a href="shapes.html#RectElement">rectangles</a> also apply to
    <a>'text'</a> elements.
  </p>

  <p id="ObjectBoundingBoxUnitsTextObjects">
    It is possible to apply a gradient, pattern, clipping path, mask
    or filter to text. When one of these facilities is applied to text
    and keyword <span class="attr-value">'objectBoundingBox'</span> is
    used (see
    <a href="coords.html#ObjectBoundingBox">Object bounding box
    units</a>) to specify a graphical effect relative to the "object
    bounding box", then the object bounding box units are computed
    relative to the entire <a>'text'</a> element in all cases, even
    when different effects are applied to different <a>'tspan'</a>
    elements within the same <a>'text'</a> element.
  </p>

  <p>
    The <a>'text'</a> element renders its first glyph (after
    <a href="text.html#RelationshipWithBiDirectionality">bidirectionality</a>
    reordering) at the initial <a>current text position</a> (with
    possible adjustments due to the value of the
    <a>'text-anchor'</a> property or the <a>'text-align'</a> property).
    For pre-formatted text and for auto-wrapped text where the
    <a>content area</a> is determined by a <a>'text/width'</a>
    or <a>'text/height'</a> attribute, the initial <a>current text
    position</a> is determined by the <a>'tspan/x'</a> and
    <a>'tspan/y'</a> values of the <a>'text'</a>, <a>'tspan'</a>,
    <a>'tref'</a>, or <a>'altGlyph'</a> element which contains the
    first rendered character.

    For auto-wrapped text in a shape or text on a path see
    the <a href="text.html#TextLayoutAuto">Auto-wrapped text</a> or
    <a href="text.html#TextLayoutPath">Text on a path</a> sections,
    respectively, to determine the initial <a>current text
    position</a>.

    After the glyph(s) corresponding to the given character is (are)
    rendered, the current text position is updated for the next
    character. In the simplest case, the new current text position is
    the previous current text position plus the glyphs' advance value
    (horizontal or vertical). See
    <a href="text.html#TextLayout">text layout</a> for a description
    of glyph placement and glyph advance.
  </p>

  <edit:elementsummary name='text'/>

<h3 id="TextAttributes">Attributes</h3>

  <dl class="attrdef-list-svg2">

    <dt id="TextElementXAttribute"><span class="adef">x</span></dt>
    <dd>

      <p>
	If a single
        <a href="types.html#DataTypeLength">&lt;length&gt;</a> is
        provided, then the value represents the new absolute X
        coordinate for the <a>current text position</a> for rendering
        the glyphs that correspond to the first character within this
        element or any of its descendants.
      </p>
      <p>
        If a comma- or space-separated list of <var>n</var>
	<a href="types.html#DataTypeLength">&lt;length&gt;</a>s is
        provided, then the values represent new absolute X coordinates
        for the <a>current text position</a> for rendering the glyphs
        corresponding to each of the first <var>n</var> characters
        within this element or any of its descendants.
      </p>
      <p>
        For additional processing rules, refer to the description of
        the <a>'tspan/x'</a> attribute on the <a>'tspan'</a> element.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="types.html#DataTypeLengths">&lt;list-of-coordinates&gt;</a></dd>
	<dt><a>Lacuna value</a></dt>  <dd>0</dd>
	<dt><a>Animatable</a></dt>    <dd>yes</dd>
      </dl>

    </dd>

    <dt id="TextElementYAttribute"><span class="adef">y</span></dt>
    <dd>

      <p>
	The corresponding list of absolute Y coordinates for the
        glyphs corresponding to the characters within this
        element. The processing rules for the <a>'y'</a> attribute
        parallel the processing rules for the <a>'x'</a> attribute.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="types.html#DataTypeLengths">&lt;list-of-coordinates&gt;</a></dd>
	<dt><a>Lacuna value</a></dt>  <dd>0</dd>
	<dt><a>Animatable</a></dt>    <dd>yes</dd>
      </dl>

    </dd>

    <dt id="TextElementDXAttribute"><span class="adef">dx</span></dt>
    <dd>

      <p>
	Shifts in the <a>current text position</a> along the x-axis
        for the characters within this element or any of its
        descendants.
      </p>
      <p>
        Refer to the description of the <a>'tspan/dx'</a> attribute on
        the <a>'tspan'</a> element.
      </p>
	
      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="types.html#DataTypeLengths">&lt;list-of-lengths&gt;</a></dd>
	<dt><a>Lacuna value</a></dt>  <dd>If not specified on this element or any of its descendants, no supllemental shifts along the x-axis will occur.</dd>
	<dt><a>Animatable</a></dt>    <dd>yes</dd>
      </dl>

    </dd>

    <dt id="TextElementDYAttribute"><span class="adef">dy</span></dt>
    <dd>

      <p>
	Shifts in the <a>current text position</a> along the y-axis
        for the characters within this element or any of its
        descendants.
      </p>
      <p>
        Refer to the description of the <a>'tspan/dy'</a> attribute on
        the <a>'tspan'</a> element.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="types.html#DataTypeLengths">&lt;list-of-lengths&gt;</a></dd>
	<dt><a>Lacuna value</a></dt>  <dd>If not specified on this element or any of its descendants, no supllemental shifts along the y-axis will occur.</dd>
	<dt><a>Animatable</a></dt>    <dd>yes</dd>
      </dl>

    </dd>

    <dt id="TextElementRotateAttribute"><span class="adef">rotate</span></dt>
    <dd>

      <p>
        The supplemental rotation about the <a>current text
        position</a> that will be applied to all of the glyphs
        corresponding to each character within this element.
      </p>
      <p>
        Refer to the description of the <a>'tspan/rotate'</a> attribute on the
        <a>'tspan'</a> element.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="types.html#DataTypeNumbers">&lt;list-of-numbers&gt;</a></dd>
	<dt><a>Lacuna value</a></dt>  <dd>If not specified on this element or any of its descendants, no supllemental rotations will occur.</dd>
	<dt><a>Animatable</a></dt>    <dd>yes (non-additive).</dd>
      </dl>

    </dd>

    <dt id="TextElementTextLengthAttribute"><span class="adef">textLength</span></dt>
    <dd>

      <p>
	The author's computation of the total sum of all of the
        advance values that correspond to character data within this
        element, including the advance value on the glyph (horizontal
        or vertical), the effect of properties
        <a>'letter-spacing'</a> and <a>'word-spacing'</a> and
        adjustments due to attributes <a>'tspan/dx'</a> and
        <a>'tspan/dy'</a> on <a>'tspan'</a> elements. This value is
        used to calibrate the user agent's own calculations with that
        of the author.
      </p>
      <p>
        The purpose of this attribute is to allow the author to
        achieve exact alignment, in visual rendering order after
        any <a href="text.html#RelationshipWithBiDirectionality">bidirectional
        reordering</a>, for the first and last rendered glyphs that
        correspond to this element; thus, for the last rendered
        character (in visual rendering order after
        any <a href="text.html#RelationshipWithBiDirectionality">bidirectional
        reordering</a>), any supplemental inter-character spacing
        beyond normal glyph advances are ignored (in most cases) when
        the user agent determines the appropriate amount to
        expand/compress the text string to fit within a length of
        <a>'textLength'</a>.
      </p>
      <p class="note">
	This property is not intended for use to obtain effects such
	as shrinking or expanding text.
      </p>
      <p>
        A negative value is an error
        (see <a href="implnote.html#ErrorProcessing">Error
        processing</a>).
      </p>
      <p>
	If the attribute is not specified anywhere within a
        <a>'text'</a> element, the effect is as if the author's
        computation exactly matched the value calculated by the user
        agent; thus, no advance adjustments are made.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="types.html#DataTypeLength">&lt;length&gt;</a></dd>
	<dt><a>Lacuna value</a></dt>  <dd>See above.</dd>
	<dt><a>Animatable</a></dt>    <dd>yes</dd>
      </dl>

    </dd>

    <dt id="TextElementLengthAdjustAttribute"><span class="adef">lengthAdjust</span></dt>
    <dd>

      <p>
        Indicates the type of adjustments which the user agent
        shall make to make the rendered length of the text match
        the value specified on the <a>'textLength'</a> attribute.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd>spacing|spacingAndGlyphs</dd>
	<dt><a>Lacuna value</a></dt>  <dd>spacing</dd>
	<dt><a>Animatable</a></dt>    <dd>yes</dd>
      </dl>

      <dl class="attrdef-values">

	<dt>spacing</dt>
	<dd>
	  Indicates that only the advance values are adjusted. The
          glyphs themselves are not stretched or compressed.
	</dd>

	<dt>spacingAndGlyphs</dt>
	<dd>
	  Indicates that the advance values are adjusted and the
          glyphs themselves stretched or compressed in one axis (i.e.,
          a direction parallel to the inline-progression-direction).
	</dd>
      </dl>

      <p>
        The user agent is required to achieve correct start and end
        positions for the text strings, but the locations of
        intermediate glyphs are not predictable because user agents
        might employ advanced algorithms to stretch or compress text
        strings in order to balance correct start and end positioning
        with optimal typography.
      </p>
      <p>
        Note that, for a text string that contains <var>n</var>
        characters, the adjustments to the advance values often occur
        only for <var>n</var>−1 characters (see description of
        attribute <a>'textLength'</a>), whereas stretching or
        compressing of the glyphs will be applied to all <var>n</var>
        characters.
      </p>
    </dd>

    <dt id="TextElementHeightAttribute"><span class="adef">height</span></dt>
    <dd>
      <p class="annotation">Added according to Resolution from June 27th, 2013.</p>
      <p>
	Establishes a rectangular <a>content area</a> for vertical
	text with the specified height. If <a>'width'</a> is also
	given, defines the height of a rectangular <a>content
	area</a> for horizontal text. It does not establish a
	<a>content area</a> for horizontal text if <a>'width'</a>
	is not also specified. See
	the <a href="text.html#TextLayoutContentArea">Content Area</a>
	section.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="types.html#DataTypeLength">&lt;length&gt;</a></dd>
	<dt><a>Lacuna value</a></dt>  <dd>As if not specified.</dd>
	<dt><a>Animatable</a></dt>    <dd>yes</dd>
      </dl>

    </dd>

    <dt id="TextElementWidthAttribute"><span class="adef">width</span></dt>
    <dd>
      <p class="annotation">Redefined according to Resolution from June 27th, 2013.</p>
      <p>
	Establishes a rectangular <a>content area</a> for horizontal
	text with the specified width. If <a>'height'</a> is also
	given, defines the width of a rectangular <a>content
	area</a> for vertical text. It does not establish a
	<a>content area</a> for vertical text if <a>'height'</a>
	is not also specified. See
	the <a href="text.html#TextLayoutContentArea">Content Area</a>
	section.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="types.html#DataTypeLength">&lt;length&gt;</a></dd>
	<dt><a>Lacuna value</a></dt>  <dd>As if not specified.</dd>
	<dt><a>Animatable</a></dt>    <dd>yes</dd>
      </dl>

    </dd>

  </dl>

  <p id="ExampleText01">
    <span class="example-ref">Example text01</span> below contains the
    text string "Hello, out there" which will be rendered onto the
    canvas using the Verdana font family with the glyphs filled with
    the color blue.
  </p>


  <edit:example href='images/text/text01.svg' name='test01' description="'Hello, out there' in blue" image='yes' link='yes'/>

  </edit:with>

<h2 id="TSpanElement">The <span class="element-name">'tspan'</span> element</h2>

  <div class="annotation svg2-requirement">
    <table>
      <tr>
	<th>SVG 2 Requirement:</th>
	<td>Allow transforms on <a>'tspan'</a>.</td>
      </tr>
      <tr>
	<th>Resolution:</th>
	<td><a href="http://www.w3.org/2011/12/01-svg-irc#T21-02-34">SVG 2 will allow transforms on <span class="element-name">'tspan'</span>.</a></td>
      </tr>
      <tr>
	<th>Purpose:</th>
	<td>Align with other elements such as <a>'a'</a> which already allow transforms.</td>
      </tr>
      <tr>
	<th>Owner:</th>
	<td>Cameron (no action)</td>
      </tr>
    </table>
  </div>

  <edit:with element='tspan'>

  <p>
    Within a <a>'text'</a> element, text and font properties can be
    changed by including a <span class="element-name">'tspan'</span>
    element.

    A <span class="element-name">'tspan'</span> element can also be
    used to adjust the <a>current text position</a> with absolute or
    relative coordinate values (some restrictions apply for
    auto-wrapped text and text on a path).
  </p>

  <edit:elementsummary name='tspan'/>

<h3 id="TSpanAttributes">Attributes</h3>

  <dl class="attrdef-list-svg2">

    <dt id="TSpanElementXAttribute"><span class="adef">x</span></dt>
    <dd>

      <p>
	If a single
	<a href="types.html#DataTypeLength">&lt;length&gt;</a> is
        provided, then the value represents the new absolute X
        coordinate for the <a>current text position</a> for rendering
        the glyphs that correspond to the first character within this
        element or any of its descendants.
      </p>
      <p>
	If a comma- or space-separated list of <var>n</var>
	<a href="types.html#DataTypeLength">&lt;length&gt;</a>s is
        provided, then the values represent new absolute X coordinates
        for the <a>current text position</a> for rendering the glyphs
        corresponding to each of the first <var>n</var> characters
        within this element or any of its descendants.
      </p>
      <p>
	If more
        <a href="types.html#DataTypeLength">&lt;length&gt;</a>s are
        provided than characters, then the extra
        <a href="types.html#DataTypeLength">&lt;length&gt;</a>s will
        have no effect on glyph positioning.
      </p>
      <p>
	If more characters exist than
	<a href="types.html#DataTypeLength">&lt;length&gt;</a>s,
	then for each of these extra characters:

	(a) if an ancestor <a>'text'</a> or <a>'tspan'</a> element
        specifies an absolute X coordinate for the given character via
        an <span class="attr-name">'x'</span> attribute, then that
        absolute X coordinate is used as the starting X coordinate for
        that character (nearest ancestor has precedence), else
        
	(b) the starting X coordinate for rendering the glyphs
        corresponding to the given character is the X coordinate of
        the resulting <a>current text position</a> from the most
        recently rendered glyph for the current <a>'text'</a> element.
      </p>
      <p>
        If the attribute is not specified:

	(a) if an ancestor <a>'text'</a> or <a>'tspan'</a> element
        specifies an absolute X coordinate for a given character via
        an <span class="attr-name">'x'</span> attribute, then that
        absolute X coordinate is used (nearest ancestor has
        precedence), else

        (b) the starting X coordinate for rendering the glyphs
        corresponding to a given character is the X coordinate of the
        resulting <a>current text position</a> from the most recently
        rendered glyph for the current <a>'text'</a> element.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="types.html#DataTypeLengths">&lt;list-of-coordinates&gt;</a></dd>
	<dt><a>Lacuna value</a></dt>  <dd>0</dd>
	<dt><a>Animatable</a></dt>    <dd>yes</dd>
      </dl>

    </dd>

    <dt id="TSpanElementYAttribute"><span class="adef">y</span></dt>
    <dd>

      <p>
	The corresponding list of absolute Y coordinates for the
        glyphs corresponding to the characters within this
        element. The processing rules for the <a>'y'</a> attribute
        parallel the processing rules for the <a>'x'</a> attribute.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="types.html#DataTypeLengths">&lt;list-of-coordinates&gt;</a></dd>
	<dt><a>Lacuna value</a></dt>  <dd>0</dd>
	<dt><a>Animatable</a></dt>    <dd>yes</dd>
      </dl>

    </dd>


    <dt id="TSpanElementDXAttribute"><span class="adef">dx</span></dt>
    <dd>

      <p>
	If a single
        <a href="types.html#DataTypeLength">&lt;length&gt;</a> is
        provided, this value represents the new relative X coordinate
        for the <a>current text position</a> for rendering the glyphs
        corresponding to the first character within this element or
        any of its descendants. The <a>current text position</a> is
        shifted along the x-axis of the current user coordinate system
        by <a href="types.html#DataTypeLength">&lt;length&gt;</a>
        before the first character's glyphs are rendered.
      </p>
      <p>
        If a comma- or space-separated list of
        <var>n</var> <a href="types.html#DataTypeLength">&lt;length&gt;</a>s
        is provided, then the values represent incremental shifts
        along the x-axis for the <a>current text position</a> before
        rendering the glyphs corresponding to the first <var>n</var>
        characters within this element or any of its
        descendants. Thus, before the glyphs are rendered
        corresponding to each character, the <a >current text
        position</a> resulting from drawing the glyphs for the
        previous character within the current <a>'text'</a> element is
        shifted along the X axis of the current user coordinate system
        by <a href="types.html#DataTypeLength">&lt;length&gt;</a>.
      </p>
      <p>
        If more
        <a href="types.html#DataTypeLength">&lt;length&gt;</a>s are
        provided than characters, then any extra
        <a href="types.html#DataTypeLength">&lt;length&gt;</a>s will
        have no effect on glyph positioning.
      </p>
      <p>
	If more characters exist than
        <a href="types.html#DataTypeLength">&lt;length&gt;</a>s, then
        for each of these extra characters:

	(a) if an ancestor <a>'text'</a> or <a>'tspan'</a> element
        specifies a relative X coordinate for the given character via
        a <span class="attr-name">'dx'</span> attribute, then
        the <a >current text position</a> is shifted along the x-axis
        of the current user coordinate system by that amount (nearest
        ancestor has precedence), else

	(b) no extra shift along the x-axis occurs.
      </p>
      <p>
	If the attribute is not specified:

	(a) if an ancestor <a>'text'</a> or <a>'tspan'</a> element
        specifies a relative X coordinate for a given character via a
        <span class="attr-name">'dx'</span> attribute, then
        the <a>current text position</a> is shifted along the x-axis
        of the current user coordinate system by that amount (nearest
        ancestor has precedence), else

	(b) no extra shift along the x-axis occurs.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="types.html#DataTypeLengths">&lt;list-of-lengths&gt;</a></dd>
	<dt><a>Lacuna value</a></dt>  <dd>See above.</dd>
	<dt><a>Animatable</a></dt>    <dd>yes</dd>
      </dl>

    </dd>

    <dt id="TSpanElementDYAttribute"><span class="adef">dy</span></dt>
    <dd>

      <p>
	The corresponding list of relative Y coordinates for the
        characters within the <a>'tspan'</a> element. The processing
        rules for the <a>'dy'</a> attribute parallel the processing
        rules for the <a>'dx'</a> attribute.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="types.html#DataTypeLengths">&lt;list-of-lengths&gt;</a></dd>
	<dt><a>Lacuna value</a></dt>  <dd>See <a>'text/dx'</a> attribute above.</dd>
	<dt><a>Animatable</a></dt>    <dd>yes</dd>
      </dl>

    </dd>

    <dt id="TSpanElementRotateAttribute"><span class="adef">rotate</span></dt>
    <dd>

      <p>
        The supplemental rotation about the <a>current text
        position</a> that will be applied to all of the glyphs
        corresponding to each character within this element.
      </p>
      <p>
        If a comma- or space-separated list of
	<a href="types.html#DataTypeNumber">&lt;number&gt;</a>s is
        provided, then the first
	<a href="types.html#DataTypeNumber">&lt;number&gt;</a>
        represents the supplemental rotation for the glyphs
        corresponding to the first character within this element or
        any of its descendants, the second
        <a href="types.html#DataTypeNumber">&lt;number&gt;</a>
        represents the supplemental rotation for the glyphs that
        correspond to the second character, and so on.
      </p>
      <p>
	If more
        <a href="types.html#DataTypeNumber">&lt;number&gt;</a>s are
        provided than there are characters, then the extra
        <a href="types.html#DataTypeNumber">&lt;number&gt;</a>s
        will be ignored.
      </p>
      <p>
	If more characters are provided than
        <a href="types.html#DataTypeNumber">&lt;number&gt;</a>s, then
        for each of these extra characters the rotation value
        specified by the last number must be used.
      </p>
      <p>
        If the attribute is not specified and if an ancestor <a>'text'</a> or
        <a>'tspan'</a> element specifies a supplemental rotation for a
        given character via a <a>'rotate'</a> attribute, then the
        given supplemental rotation is applied to the given character
        (nearest ancestor has precedence). If there are more
        characters than
        <a href="types.html#DataTypeNumber">&lt;number&gt;</a>s
        specified in the ancestor's <a>'rotate'</a> attribute, then
        for each of these extra characters the rotation value
        specified by the last number must be used.
      </p>
      <p>
        This supplemental rotation has no impact on the rules by
        which <a>current text position</a> is modified as glyphs get
        rendered and is supplemental to any rotation due to
        <a href="text.html#TextLayoutPath">text on a path</a> and
        to <a>'glyph-orientation-horizontal'</a>
        or <a>'glyph-orientation-vertical'</a>.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="types.html#DataTypeNumbers">&lt;list-of-numbers&gt;</a></dd>
	<dt><a>Lacuna value</a></dt>  <dd>See above.</dd>
	<dt><a>Animatable</a></dt>    <dd>yes (non-additive).</dd>
      </dl>

    </dd>

    <dt id="TSpanElementTextLengthAttribute"><span class="adef">textLength</span></dt>
    <dd>

      <p>
	The author's computation of the total sum of all of the
        advance values that correspond to character data within this
        element, including the advance value on the glyph (horizontal
        or vertical), the effect of properties
        <a>'letter-spacing'</a> and <a>'word-spacing'</a> and
        adjustments due to attributes <a>'tspan/dx'</a> and
        <a>'tspan/dy'</a> on this <a>'tspan'</a> element or any
        descendants. This value is used to calibrate the user agent's
        own calculations with that of the author.
      </p>
      <p>
        The purpose of this attribute is to allow the author to
        achieve exact alignment, in visual rendering order after
        any <a href="text.html#RelationshipWithBiDirectionality">bidirectional
        reordering</a>, for the first and last rendered glyphs that
        correspond to this element; thus, for the last rendered
        character (in visual rendering order after
        any <a href="text.html#RelationshipWithBiDirectionality">bidirectional
        reordering</a>), any supplemental inter-character spacing
        beyond normal glyph advances are ignored (in most cases) when
        the user agent determines the appropriate amount to
        expand/compress the text string to fit within a length of
        <a>'textLength'</a>.
      </p>
      <p>
        If attribute <a>'textLength'</a> is specified on a given
        element and also specified on an ancestor, the adjustments on
        all character data within this element are controlled by the
        value of <a>'textLength'</a> on this element exclusively, with
        the possible side-effect that the adjustment ratio for the
        contents of this element might be different than the
        adjustment ratio used for other content that shares the same
        ancestor. The user agent must assume that the total advance
        values for the other content within that ancestor is the
        difference between the advance value on that ancestor and the
        advance value for this element.
      </p>
      <p>
	A negative value is an error
        (see <a href="implnote.html#ErrorProcessing">Error
        processing</a>).
      </p>
      <p>
	If the attribute is not specified anywhere within a
        <a>'text'</a> element, the effect is as if the author's
        computation exactly matched the value calculated by the user
        agent; thus, no advance adjustments are made.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="types.html#DataTypeLength">&lt;length&gt;</a></dd>
	<dt><a>Lacuna value</a></dt>  <dd>See above.</dd>
	<dt><a>Animatable</a></dt>    <dd>yes</dd>
      </dl>

    </dd>
  </dl>

<h3 id="TSpanNotes">Notes on 'x', 'y', 'dx', 'dy', and 'rotate'</h3>

  <p>
    The <a>'x'</a>, <a>'y'</a>, <a>'dx'</a>, <a>'dy'</a>, and
    <a>'rotate'</a> on the <a>'tspan'</a> element are useful in
    high-end typography scenarios where individual glyphs require
    exact placement. These attributes are useful for minor positioning
    adjustments between characters or for major positioning
    adjustments, such as moving a section of text to a new location to
    achieve the visual effect of a new line of text (compatable with
    SVG 1.1). Note that the <a>'x'</a> and <a>'y'</a> attributes are
    ignored for auto-wrapped text (except for the initial <a>current
    text position</a> when the <a>content area</a> is specified by
    a <a>'text/width'</a> or <a>'text/height'</a> attribute).
  </p>
  <p class="issue">
    Are 'dx', 'dy', and 'rotate'  also ignored
    for auto-wrapped text? Or are they added adjustments after
    the text is laid out?
  </p>
  <p>
    In situations where micro-level positioning adjustment are
    necessary for advanced typographic control, the SVG content
    designer needs to ensure that the necessary font will be available
    for all viewers of the document (e.g., package up the necessary
    font data in the form of an SVG font or an alternative WebFont
    format which is stored at the same Web site as the SVG content)
    and that the viewing software will process the font in the
    expected way (the capabilities, characteristics and font layout
    mechanisms vary greatly from system to system). If the SVG content
    contains <a>'x'</a>, <a>'y'</a>, <a>'dx'</a>, or
    <a>'dy'</a> attribute values which are meant to correspond to a
    particular font processed by a particular set of viewing software
    and either of these requirements is not met, then the text might
    display with poor quality.
  </p>
  <p>
    The following additional rules apply to attributes <a>'x'</a>,
    <a>'y'</a>, <a>'dx'</a>, <a>'dy'</a>, and <a>'rotate'</a> when they
    contain a list of numbers:
  </p>

  <ul>
    <li>
      When a single XML character maps to a single glyph &#x2013; In this
      case, the <span class="code-fragment">i</span>-th value for the
      <a>'x'</a>, <a>'y'</a>, <a>'dx'</a>, <a>'dy'</a>,
      and <a>'rotate'</a> attributes is applied to the glyph that
      corresponds to the <span class="code-fragment">i</span>-th
      character.
    </li>

    <li>
      When a single XML character maps to multiple glyphs (e.g., when
      an accent glyph is placed on top of a base glyph) &#x2013; In this
      case, the <span class="code-fragment">i</span>-th value for
      the <a>'x'</a>, <a>'y'</a>, <a>'dx'</a>, and <a>'dy'</a> values
      are applied (i.e., the <a>current text position</a> is adjusted)
      before rendering the first glyph.  The rotation transformation
      corresponding to the
      <span class="code-fragment">i</span>-th <a>'rotate'</a>
      value is applied to the glyphs and to the inter-glyph advance
      values corresponding to this character on a group basis (i.e.,
      the rotation value creates a temporary new rotated coordinate
      system, and the glyphs orresponding to the character are
      rendered into this rotated coordinate system).
    </li>

    <li>
      When multiple XML characters map to a single glyph (e.g., when a
      ligature is used) &#x2013; Suppose that the
      <span class="code-fragment">i</span>-th and
      <span class="code-fragment">(i+1)</span>-th XML characters
      map to a single glyph. In this case, the
      <span class="code-fragment">i</span>-th value for the
      <a>'x'</a>, <a>'y'</a>, <a>'dx'</a>, <a>'dy'</a>,
      and <a>'rotate'</a> attributes all apply when rendering the
      glyph. The <span class="code-fragment">(i+1)</span>-th values,
      however, for <a>'x'</a>, <a>'y'</a>, and <a>'rotate'</a> are
      ignored (exception: the final <a>'rotate'</a> value in the list
      would still apply to subsequent characters), whereas
      the <a>'dx'</a> and <a>'dy'</a> are applied to the subsequent
      XML character (i.e., the
      <span class="code-fragment">(i+2)</span>-th character), if one
      exists, by translating the <a>current text position</a> by the
      given amounts before rendering the first glyph associated with
      that character.
    </li>

    <li>
      When there is a many-to-many mapping of characters to
      glyphs (e.g., when three characters map to two glyphs, such as
      when the first glyph expresses the first character and half
      of the second character, and the second glyph expresses the
      other half of the second character plus the third character)
      &#x2013; Suppose that the <span class="code-fragment">i</span>-th,
      <span class="code-fragment">(i+1)</span>-th and
      <span class="code-fragment">(i+2)</span>-th XML characters map
      to two glyphs. In this case, the
      <span class="code-fragment">i</span>-th value for the
      <a>'x'</a>, <a>'y'</a>, <a>'dx'</a>, and <a>'dy'</a> values
      are applied (i.e., the <a >current text position</a> is
      adjusted) before rendering the first glyph.  The rotation
      transformation corresponding to the
      <span class="code-fragment">i</span>-th <a>'rotate'</a>
      value is applied to both the two glyphs and the glyph advance
      values for the first glyph on a group basis (i.e., the rotation
      value creates a temporary new rotated coordinate system, and the
      two glyphs are rendered into the temporary rotated coordinate
      system). The <span class="code-fragment">(i+1)</span>-th and
      <span class="code-fragment">(i+2)</span>-th values, however, for
      the <a>'x'</a>, <a>'y'</a>, and <a>'rotate'</a> attributes are
      not applied (exception: the final <a>'rotate'</a> value in the
      list would still apply to subsequent characters), whereas
      the <span class="code-fragment">(i+1)</span>-th
      and <span class="code-fragment">(i+2)</span>-th values for
      the <a>'dx'</a> and <a>'dy'</a> attributes are applied to the
      subsequent XML character (i.e.,
      the <span class="code-fragment">(i+3)</span>-th character), if
      one exists, by translating the <a >current text position</a> by
      the given amounts before rendering the first glyph associated
      with that character.
    </li>

    <li>
      Relationship to
      <a href="text.html#RelationshipWithBiDirectionality">bidirectionality</a>
      &#x2013; As described below in the discussion on
      <a href="text.html#RelationshipWithBiDirectionality">bidirectionality</a>,
      text is laid out in a two-step process, where any bidirectional
      text is first re-ordered into a left-to-right string, and then
      text layout occurs with the re-ordered text string. Whenever the
      character data within a <a>'tspan'</a> element is re-ordered,
      the corresponding elements within the <a>'x'</a>, <a>'y'</a>,
      <a>'dx'</a>, <a>'dy'</a>, and <a>'rotate'</a> are also
      re-ordered to maintain the correspondence. For example,
      suppose that you have the following <a>'tspan'</a> element:
      <pre>
&lt;tspan dx="11 12 13 14 15 0 21 22 23 0 31 32 33 34 35 36"&gt;Latin and Hebrew&lt;/tspan&gt;
      </pre>
      and that the word "Hebrew" will be drawn right-to-left. First,
      the character data and the corresponding values in
      the <a>'dx'</a> list will be reordered, such that the text
      string will be "Latin and werbeH" and the list of values for
      the <a>'dx'</a> attribute will be "11 12 13 14 15 0 21 22 23 0
      36 35 34 33 32 31". After this re-ordering, the glyphs
      corresponding to the characters will be positioned using
      standard left-to-right layout rules.
    </li>
  </ul>

  <p>
    The following examples show basic use of the <a>'tspan'</a>
    element:
  </p>

  <p id="ExampleTSpan01">
    <span class="example-ref">Example tspan01</span> uses a
    <a>'tspan'</a> element to indicate that the word "not" is to use a
    bold font and have red fill.
  </p>

  <edit:example href='images/text/tspan01.svg' name='tspan01' description='using tspan to change visual attributes' image='yes' link='yes'/>

  <p id="ExampleTSpan02">
    <span class="example-ref">Example tspan02</span> uses
    the <a>'dx'</a> and <a>'dy'</a> attributes on the <a>'tspan'</a>
    element to adjust the <a>current text position</a> horizontally
    and vertically for particular text strings within a
    <a>'text'</a> element.
  </p>

  <edit:example href='images/text/tspan02.svg' name='tspan02' description="using tspan's dx and dy attributes for incremental positioning adjustments" image='yes' link='yes'/>

  <p id="ExampleTSpan03">
    <span class="example-ref">Example tspan03</span> uses
    the <a>'x'</a> and <a>'y'</a> attributes on the
    <a>'tspan'</a> element to establish a new absolute
    <a>current text position</a> for each glyph to be rendered. The
    example shows two lines of text within a single
    <a>'text'</a> element. Because both lines of text are within the
    same <a>'text'</a> element, the user will be able to select
    through both lines of text and copy the text to the system
    clipboard in user agents that support
    <a href="text.html#TextSelection">text selection and clipboard
    operations</a>.
  </p>

  <edit:example href='images/text/tspan03.svg' name='tspan03' description="using tspan's x and y attributes for multi-line text and precise glyph positioning" image='yes' link='yes'/>

  <p>
    <span class="example-ref">Example tspan04</span> uses the
    <a>'rotate'</a> attribute on the <a>'tspan'</a> element to rotate the
    glyphs to be rendered. This example shows a single text string in a
    <a>'tspan'</a> element that contains more characters than the
    number of values specified in the <a>'rotate'</a> attribute. In
    this case the last value specified in the <a>'rotate'</a>
    attribute of the <a>'tspan'</a> must be applied to the remaining
    characters in the string.
  </p>

  <edit:example href='images/text/tspan04.svg' name='tspan04' description="simple rotation of characters in a tspan element" image='yes' link='yes'/>

  <p>
    <span class="example-ref">Example tspan05</span> specifies the
    <a>'rotate'</a> attribute on the <a>'text'</a> element and on all
    but one of the child <a>'tspan'</a> elements to rotate the glyphs
    to be rendered. The example demonstrates the propagation of the
    <a>'rotate'</a> attribute.
  </p>

  <edit:example href='images/text/tspan05.svg' name='tspan05' description="propagation of rotation values to nested tspan elements" image='yes' link='yes'/>

  <p>
    Rotation of red text inside the <a>'text'</a> element:
  </p>

  <ul>
    <li>
      The <a>'rotate'</a> value will rotate the characters in the text
      <em>"Not "</em> by 5, 15, 25 and 35 degrees respectively.
    </li>
    <li>
      A <a>'rotate'</a> value is applied to the space that follows the
      text <em>"Not"</em>, to the space in between the text in the
      "child1" and "child5" <a>'tspan'</a> elements, and to the space
      before the text <em>"rotation"</em>.
    </li>
    <li>
      The next current <a>'rotate'</a> value specified is 45 followed
      by 55. The current <a>'rotate'</a> value in the <a>'text'</a>
      element is incremented as subsequent characters in the text of the
      child <a>'tspan'</a> elements are processed.
    </li>
    <li>
      The next immediate <a>'tspan'</a> element specifies rotate values
      for the text, hence the current <a>'rotate'</a> value will change to
      the next value in the list (but is not used) as each character is
      processed until the last value of 55 degrees is reached.
    </li>
    <li>
      The last <a>'rotate'</a> value of 55 degrees will be applied to all
      the characters in the text <em>"rotation"</em>.
    </li>
  </ul>

  <p>
    Rotation of the orange text inside the "child1" <a>'tspan'</a>element:
  </p>

  <ul>
    <li>
      The <a>'rotate'</a> value will rotate the first 4 characters in the
      text <em>"all characters "</em> by -10, -20, -30 and -40
      respectively.
    </li>
    <li>
      The last <a>'rotate'</a> value of -40 becomes the current
      <a>'rotate'</a> value and will be applied to all subsequent
      characters in the <a>'tspan'</a> element and to any child
      <a>'tspan'</a> elements that do not specify <a>'rotate'</a>
      values.
    </li>
    <li>
      The "child4" <a>'tspan'</a> element does not specify any
      <a>'rotate'</a> values and thus uses the current <a>'rotate'</a> of
      its ancestor ("child1" <a>'tspan'</a> element). All the characters
      in the text <em>"text"</em> specified within the "child4"
      <a>'tspan'</a> element will be rotated by -40 degrees.
    </li>
    <li>
      The last <a>'rotate'</a> value of -40 degrees will be applied to all
      the characters in the text <em>"have a"</em>.
    </li>
    <li>
      A <a>'rotate'</a> value is applied to the space in between the text
      in the "child2" and "child4" <a>'tspan'</a> elements, and to the
      space before the text <em>"have a"</em>.
    </li>
  </ul>

  <p>
    Rotation of the yellow text inside the "child2" <a>'tspan'</a>element:
  </p>

  <ul>
    <li>
      The <a>'rotate'</a> value will rotate the characters in the (yellow)
      text <em>"in "</em> by 70, 60, and 50 degrees respectively.
    </li>
    <li>
      A <a>'rotate'</a> value is applied to the space that follows the
      text <em>"in"</em>.
    </li>
    <li>
      There are more <a>'rotate'</a> values specified than characters,
      thus the additional <a>'rotate'</a> values will be applied to the
      "child3" <a>'tspan'</a> element which does not specified any
      <a>'rotate'</a> values.
    </li>
    <li>
      The characters in the text <em>"the"</em> specified within the
      "child3" <a>'tspan'</a> element will be rotated 40, 30 and 20
      degrees respectively.
    </li>
  </ul>

  <p>Rotation of the blue text inside the "child5" <a>'tspan'</a> element:</p>

  <ul>
    <li>
      The <a>'rotate'</a> value will rotate all the characters in text
      <em>"specified"</em> by -10 degrees.
    </li>
    <li>
      Only one <a>'rotate'</a> value is specified and is thus
      applied to all characters in the <a>'tspan'</a> element.
    </li>
  </ul>

  <p>
    The following diagram illustrates how the rotation values propagate to
    <a>'tspan'</a> elements nested withing a <a>'text'</a> element:
  </p>

  <img alt="Image that shows propagation of rotation values" src="images/text/tspan05-diagram.png" width="528" height="918" />

  </edit:with>

<h2 id="TRefElement">The <span class="element-name">'tref'</span> element</h2>

  <div class="annotation svg2-requirement">
    <table>
      <tr>
	<th>SVG 2 Requirement:</th>
	<td>Allow <a>'tref'</a> to point to non-SVG elements.</td>
      </tr>
      <tr>
	<th>Resolution:</th>
	<td><a href="http://lists.w3.org/Archives/Public/public-svg-wg/2009JulSep/att-0094/26-svg-minutes-last-topic.html#item01">We agree to remove the restriction of <span class="element-name">'tref'</span> pointing to only an SVG document fragment.</a></td>
      </tr>
      <tr>
	<th>Purpose:</th>
	<td>To allow easier text substitution.</td>
      </tr>
      <tr>
	<th>Owner:</th>
	<td>Cameron (<a href="http://www.w3.org/Graphics/SVG/WG/track/actions/3130">ACTION-3130</a>)</td>
      </tr>
    </table>
  </div>

  <edit:with element='tref'>

  <p>
    The textual content for a <a>'text'</a> can be either character data
    directly embedded within the <a>'text'</a> element or the character data
    content of a referenced element, where the referencing is specified with a
    <a>'tref'</a> element.
  </p>

  <edit:elementsummary name='tref'/>

<h3 id="TRefAttributes">Attributes</h3>

  <dl class="attrdef-list-svg2">

    <dt id="TRefElementHrefAttribute"><span class="adef">xlink:href</span></dt>
    <dd>

      <p>
	An <a>IRI reference</a> to an element whose character data
        content shall be used as character data for this <a>'tref'</a>
        element.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="types.html#DataTypeIRI">&lt;iri&gt;</a></dd>
	<dt><a>Lacuna value</a></dt>  <dd>As if not specified.</dd>
	<dt><a>Animatable</a></dt>    <dd>yes</dd>
      </dl>

    </dd>
  </dl>

<h3 id="TRefNotes">Notes</h3>

  <p>
    All character data within the referenced element, including
    character data enclosed within additional markup, will be
    rendered.
  </p>
  <p>
    The <a>'x'</a>, <a>'y'</a>, <a>'dx'</a>, <a>'dy'</a>
    and <a>'rotate'</a> attributes have the same meanings as for
    the <a>'tspan'</a> element. The attributes are applied as if
    the <a>'tref'</a> element was replaced by a
    <a>'tspan'</a> with the referenced character data (stripped of all
    supplemental markup) embedded within the hypothetical
    <a>'tspan'</a> element.
  </p>

  <p id="ExampleTRef01">
    <span class="example-ref">Example tref01</span> shows how to use
    character data from a different element as the character data for
    a given <a>'tspan'</a> element. The first <a>'text'</a> element
    (with <span class='attr-value'>id="ReferencedText"</span>) will
    not draw because it is part of a <a>'defs'</a> element. The
    second <a>'text'</a> element draws the string "Inline character
    data". The third <a>'text'</a> element draws the string "Reference
    character data" because it includes a <a>'tref'</a> element which
    is a reference to element "ReferencedText", and that element's
    character data is "Referenced character data".
  </p>

  <edit:example href='images/text/tref01.svg' name='tref01' description="inline vs reference text content" image='yes' link='yes'/>

</edit:with>

<h2 id="TextLayout">Text layout &#x2013; Introduction</h2>

  <div class="annotation svg2-requirement">
    <table>
      <tr>
	<th>SVG 2 Requirement:</th>
	<td>Include text layout improvements from SVG Tiny 1.2.</td>
      </tr>
      <tr>
	<th>Resolution:</th>
	<td><a href="http://www.w3.org/2012/02/02-svg-minutes.html#item10">SVG 2 will include the improved text from SVG Tiny 1.2 on characters and glyphs, text layout, text selection, text search.</a></td>
      </tr>
      <tr>
	<th>Purpose:</th>
	<td>To include clearer descriptions of text layout; no functional change.</td>
      </tr>
      <tr>
	<th>Owner:</th>
	<td>Chris (<a href="http://www.w3.org/Graphics/SVG/WG/track/actions/3236">ACTION-3236</a>)</td>
      </tr>
    </table>
  </div>

  <p>
    This section gives a short overview of SVG text layout. It is
    followed by sections that cover different aspects of text layout
    in more detail.
  </p>

  <p>
    Text is first laid out inside a <a>content area</a>.
    The <a>content area</a> may be explictly declared by setting the
    <a>'text/width'</a> attribute (for horizontal text) or the
    <a>'text/height'</a> attribute (for vertical text), or by setting
    the <a>'shape-inside'</a> property that defines or references an
    SVG <a>shape</a>. If a <a>content area</a> is not declared, it
    defaults to a rectangle of infinite width and height. The rules
    for text layout within the <a>content area</a> are the same as for
    text layout in a
    <a href="http://www.w3.org/TR/CSS2/box.html#box-dimensions">CSS
    content area</a> except as noted in this chapter.
  </p>

  <p>
    After the initial text layout, SVG transforms are applied. These
    transforms may shift and/or rotate parts of or all of the
    text. The rules for which transforms are allowed depend on if
    the <a>content area</a> was explictly declared or not. If not
    explicitly declared, the rules define the layout of
    <em>pre-formatted</em> text. If declared, the rules define the
    layout of <em>auto-wrapped</em> text. In addition, a
    <a>'textPath'</a> element can convert a single line of
    <em>pre-formatted</em> text to <em>text on a path</em>.
    Examples of the different types of text follow:
  </p>

  <dl>
    <dt>Pre-formatted:</dt>
    <dd>For short strings of text (e.g. labels) or where exact
      placement of glyphs is required (e.g. hand-kerned titles).

      <div class="example">
	<p>An example of multi-line pre-formatted text.</p>

	<pre><![CDATA[
<svg xmlns="http://www.w3.org/2000/svg">
     width="300" height="100" viewBox="0 0 300 100"

     <text x="20" y="45" 
           font-family="sans-serif"
	   font-size="24" >
       Example of multi-line,
       <tspan x="20" y="75">pre-formatted text.</tspan>
     </text>

</svg>
]]></pre>

	<div class="figure">
	  <img class="bordered" src="images/text/text-preformatted.svg"
               alt="Image showing two lines of pre-formatted text."/>
	  <p class="caption">Pre-formatted text where a <a>'tspan'</a> element has
	    been used to create multi-line text.</p>
	</div>
      </div>

    </dd>

    <dt>Wrapped text:</dt>
    <dd>For long strings of text where automatic text wrapping is
      required.
      <div class="example">
	<p>An example of auto-wrapped text.</p>

	<pre><![CDATA[
<svg xmlns="http://www.w3.org/2000/svg">
     width="300" height="100" viewBox="0 0 300 100"

  <text x="20" y="45" 
        font-family="sans-serif"
	font-size="24"
	width="250">
    Example of text auto-wrapped.</text>

</svg>
]]></pre>

	<div class="figure">
	  <img class="bordered" src="images/text/text-wrapped.svg"
               alt="Image showing auto-wrapped text on two lines."/>
	  <p class="caption">Auto-wrapped text. The <a>'text/width'</a>
	    parameter defines a rectangular content area (shown
	    in light blue).</p>
	</div>
      </div>

    </dd>

    <dt>Text on path:</dt>
    <dd>For text that follows a specified path.
      <div class="example">
	<p>An example of text on a path.</p>

	<pre><![CDATA[
<svg xmlns="http://www.w3.org/2000/svg">
     xmlns:xlink="http://www.w3.org/1999/xlink"
     width="300" height="100" viewBox="0 0 300 100"

  <path id="MyPath" stroke="lightblue" fill="none"
	d="M 50,50 C 100,0 200,100 250,50"/>

  <text font-family="sans-serif"
	font-size="24">
    <textPath xlink:href="#MyPath">Text on a path.</textPath>
  </text>

</svg>
]]></pre>

	<div class="figure">
	  <img class="bordered" src="images/text/text-path.svg"
               alt="Image showing text following a path."/>
	  <p class="caption">Text on a path. The <a>'textPath'</a>
	    element references a <a>'path'</a> element (shown in light
	    blue).</p>
	</div>
      </div>

    </dd>
  </dl>

  <p class="note">
    SVG 2 introduces the ability to automatically wrap text inside a
    rectangle or other shape by specifying a <a>content area</a>. The
    design of SVG wrapped text is motivated by the desire that SVG
    text wrapping be as compatible as possible with text wrapping in
    CSS inorder that renderers that support CSS text wrapping can
    implement SVG text wrapping easily (but without requiring non-HTML
    compatable SVG renderers to implement HTML). There are several
    differences between SVG and CSS text wrapping. The most important
    is that in SVG, a <a>content area</a> must be explicitly provided
    as SVG does not have an automatic finite (or semi-finite)
    <a>content area</a> (provided in CSS by the box model). Another
    difference is that SVG does not have the &lt;p&gt;&lt;/p&gt; and
    &lt;br/&gt; elements which create line breaks. Instead, SVG relies
    on the <span class="prop-value">pre</span> and
    <span class="prop-value">pre-line</span> values of
    <a>'white-space'</a> to provide line breaks. SVG wrapped text also
    allows a content-creation tool to provide a natural fallback for
    SVG 1.1 renderers that do not support wrapped text (by use of
    <a>'text/x'</a> and <a>'text/y'</a> attributes in the <a>'text'</a> and
    <a>'tspan'</a> elements, which are ignored by SVG 2 renderers for
    auto-wrapped text).
  </p>

  <p>
    SVG's text layout options are designed to cover most general use
    cases. If more complex layout is required (bulleted lists, tables,
    etc.), text can be rendered in another XML namespace such as XHTML
    [<a href="refs.html#ref-XHTML">XHTML</a>] embedded inline within a
    <a>'foreignObject'</a> element.  (Note: the exact semantics of
    this approach are not completely defined at this time.)
  </p>

  <p class="issue">Define semantics of foriegnObject.</p>

<h2 id="TextLayoutContentArea">Text layout &#x2013; Content Area</h2>

  <p>
    A <dfn>content area</dfn> is defined by specifying in
    a <a>'text'</a> element either a <a>'text/width'</a> attribute
    (for horizontal text), a <a>'text/height'</a> attribute (for
    vertical text), or a <a>'shape-inside'</a> property that defines
    or references an SVG <a>shape</a>. If no <a>content area</a> is
    provided, the <a>content area</a> defaults to a rectangle of
    infinite width and height (see the
    <a href="text.html#TextLayoutPre">pre-formatted text</a> section).
  </p>

  <p class="note">
    An SVG <a>content area</a> corresponds to the <em>content
    area</em> defined in the
    <a href="http://www.w3.org/TR/CSS2/box.html#box-dimensions">CSS
    box model</a> and in
    <a href="http://www.w3.org/TR/css3-exclusions/#content-area">CSS
    Exclusions</a>.
  </p>

  <p id="TextLayoutWrappingArea">
    Wrapped text is laid out in a <dfn>wrapping area</dfn>. The
    <a>wrapping area</a> is normally the same as the <a>content
    area</a>. It is possible to exclude part of the <a>content
    area</a> by defining a <dfn>wrapping context</dfn> using
    the <a>'shape-outside'</a> property. The <a>wrapping area</a> then
    is defined by subtracting the <a>wrapping context</a> from
    the <a>content area</a>.  When the <a>content area</a> is defined
    using the <a>'shape-inside'</a> property, the <a>wrapping area</a>
    can be reduced by the value of the <a>'shape-padding'</a>
    property.
  </p>

  <p class="note">
    The terms <em>wrapping area</em> and <em>wrapping context</em> are
    defined in
    <a href="http://www.w3.org/TR/css3-exclusions/#wrapping-context">CSS
    Exclusions</a>.
  </p>


<h3 id='TextLayoutWidthHeight'>The 'width' and/or 'height' attributes</h3>

  <p>
    There are three possible ways to define a <a>content area</a> using the
    <a>'text'</a> element attributes <a>'text/width'</a> and
    <a>'text/height'</a>:
  </p>

  <dl>
    <dt><a>'text/width'</a> only</dt>
    <dd>
      For horizontal text, specifies a width for a
      "rectangular" <a>content area</a> of infinite height.

      For left-to-right text, the initial <a>current text
      position</a> is at the left of the rectangle. For
      right-to-left text it is at the right of the rectangle.

      For vertical text, it is ignored.
    </dd>

    <dt><a>'text/height'</a> only</dt>
    <dd>
      For vertical text specifies, a height for a
      "rectangular" <a>content area</a> of infinite width. The
      initial <a>current text position</a> is at the top of the
      rectangle.

      For horizontal text, it is ignored.
    </dd>

    <dt><a>'text/height'</a> and <a>'text/width'</a></dt>
    <dd>
      For both horizontal and vertical text, specifies a height and
      with for a "rectangular" <a>content area</a>.

      <p class="issue">
        This is really, really ugly due to the normal positioning of
        the initial current text position. We could avoid the issue
        of shifting x and y (e.g. using baseline='text-before-edge')
        by not allowing this option. It is trivial to define a
        rectangluar box content area using
        shape-inside="rectangle(x,y,width,height)" as shown in
        the example in the <a>'shape-inside'</a> section.
      </p>
    </dd>
  </dl>

  <p>
    In all cases, the initial <a>current text position</a> is taken
    from the <a>'text/x'</a> and <a>'text/y'</a> attributes of
    the <a>'text'</a> element.
  </p>


  <div class="example">
    <p>An example of using <a>'text/width'</a> for wrapping horizontal text.</p>

    <pre><![CDATA[
<svg xmlns="http://www.w3.org/2000/svg"
     width="300" height="100" viewBox="0 0 300 100">

  <text x="50" y="30" width="200" 
        font-family="sans-serif"
	font-size="20px" >This text wraps at 200 pixels.</text>

</svg>
]]></pre>

    <div class="figure">
      <img class="bordered" src="images/text/text-wrap-horizontal.svg"
           alt="Image showing English text wrapped into two lines."/>
      <p class="caption">
	Horizontal text wrapping. The light-blue lines indicate the
	limits of the <a>content area</a>. Note that the content
	area is of infinite height. The red dot shows the initial
	<a>current text
	  position</a>.
      </p>
    </div>
  </div>

  <div class="example">
    <p>An example of using <a>'text/width'</a> for wrapping right to left horizontal text.</p>

    <pre><![CDATA[
<svg xmlns="http://www.w3.org/2000/svg"
     width="300" height="100" viewBox="0 0 300 100">

  <text x="250" y="30" width="200" 
	writing-mode="rl-tb"
        font-family="PakType Naqsh"
	font-size="20px" >هذا النص يلتف في 200 بكسل.</text>

</svg>
]]></pre>

    <div class="figure">
      <img class="bordered" src="images/text/text-wrap-horizontal-rl.svg"
           alt="Image showing Arabic text wrapped into two lines."/>
      <p class="caption">
	Horizontal text wrapping for right to left text.
	The light-blue lines indicate the
	limits of the <a>content area</a>. Note that the content
	area is of infinite height. The red dot shows the initial
	<a>current text
	  position</a>.
      </p>
    </div>
    <p class="issue">Check Arabic text.</p>
    <p class="issue">None of the browsers render this SVG 1.1 figure
      correctly. Only Batik seems to get it right.</p>
  </div>

  <div class="example">
    <p>An example of using <a>'text/height'</a> for wrapping vertical text.</p>

    <pre><![CDATA[
<svg xmlns="http://www.w3.org/2000/svg"
     width="100" height="300" viewBox="0 0 100 300">

  <text x="62.5" y="25" height="200"
	writing-mode="tb-rl"
        font-family="IPAMincho"
	font-size="25px" >テキストは１０文字後に折り返されます。</text>

</svg>
]]></pre>

    <div class="figure">
      <img class="bordered" src="images/text/text-wrap-vertical.svg"
           alt="Image showing vertical Japanese text wrapped into two columns."/>
      <p class="caption">
	Vertical text wrapping. The light-blue lines indicate the
	limits of the <a>content area</a>. Note that the content
	area is of infinite width. The red dot shows the initial
	<a>current text
	  position</a>.
      </p>
    </div>
    <p class="issue">This SVG image doesn't work in Firefox, even nightly.</p>
    <p class="issue">Check translation.</p>
  </div>

<h3 id='TextShapeInside'>The <span class="property">'shape-inside'</span> property</h3>

  <p>
    The <a>'shape-inside'</a> property allows one to set the
    <a>content area</a> to a <a>CSS basic shape</a> or to an
    SVG <a>shape</a>.
  </p>
  <p class="note">
    In CSS/HTML <a>'shape-inside'</a> applies to block-level elements
    and absolute and percentage values are defined relative to the
    block-level element.

    In SVG absolute and percentage values are defined relative to the
    current <a>user coordinate system</a> and the <a>'viewBox'</a>.
  </p>
  <p class="issue">
    The values 'outside-shape' and 'auto' are probably not useful in SVG.
    A new value of 'none' is probably needed for SVG. This would indicate
    that the text should be rendered using a 'width' and/or 'height' attribute,
    or absent those attributes, as pre-formatted text.
  </p>

  <table class="propdef">
    <tr>
      <th>Name:</th>
      <td><dfn id="ShapeInsideProperty">shape-inside</dfn></td>
    </tr>
    <tr>
      <th>Value:</th>
      <td>none | &lt;basic-shape&gt; | &lt;uri&gt;</td>
    </tr>
    <tr>
      <th>Initial:</th>
      <td>none</td>
    </tr>
    <tr>
      <th>Applies to:</th>
      <td><a>'text'</a> elements</td>
    </tr>
    <tr>
      <th>Inherited:</th>
      <td>no</td>
    </tr>
    <tr>
      <th>Percentages:</th>
      <td>N/A</td>
    </tr>
    <tr>
      <th>Media:</th>
      <td>visual</td>
    </tr>
    <tr>
      <th>Computed&#160;value:</th>
      <td>computed lengths for &lt;shape&gt;, the absolute URI for &lt;uri&gt;, otherwise as specified </td>
    </tr>
    <tr>
      <th><a>Animatable</a>:</th>
      <td>yes, see <a href="http://dev.w3.org/csswg/css-shapes/#basic-shape-interpolation">Interpolation of Basic Shapes</a></td>
    </tr>
  </table>

  <dl>
    <dt><span class="attr-value">outside-shape</span></dt>
    <dd>
      The shape is computed based on the computed value of the ‘shape-outside’ property.
      <p class="issue">This value is probably not useful.</p>
    </dd>

    <dt><span class="attr-value">auto</span></dt>
    <dd>
      The shape is computed based on the content box of the element.
      <p class="issue">This value is probably not useful.</p>
    </dd>

    <dt><span class="attr-value">&lt;basic-shape&gt;</span></dt>
    <dd>
      The shape is computed based on the values of one of
      ‘rectangle’,‘ circle’, ‘ellipse’ or ‘polygon’.

      <div class="example">
	<p>
	  An example of using a CSS basic-shape for wrapping horizontal text.
	</p>

	<pre><![CDATA[
<svg xmlns="http://www.w3.org/2000/svg"
     width="300" height="100" viewBox="0 0 300 100">

  <text shape-inside="rectangle(50,10,200,80)"
	font-family="sans-serif"
	font-size="20px" >This text wraps in a rectangle.</text>

</svg>
]]></pre>

	<div class="figure">
	  <img class="bordered" src="images/text/text-wrap-rectangle.svg"
	       alt="Image showing text wrapped inside a rectangle."/>
	  <p class="caption">
	    Horizontal text wrapping inside a CSS rectangle shape.
	    The light-blue lines indicate the limits of the
	    <a>content area</a>.
	  </p>
	</div>
      </div>

      <div class="issue">
        <p>
          Shapes also defines 'inset-rectangle'. It might be
          interesting to be able to write:
        </p>

	      <pre><![CDATA[
<rect ...>
  <text shape-inside="inset-rectangle(20px,10px,20px,10px)">...</text>
</rect>
]]></pre>

        <p>
          where the insets are based on the rectangle geometry (or
          the bounding-box before any transformation).
        </p>
      </div>
    </dd>

    <dt><span class="attr-value">&lt;uri&gt;</span></dt>
    <dd>
      If the &lt;uri&gt; references an SVG <a>shape</a> element,
      that element defines the shape. Otherwise, if the &lt;uri&gt;
      references an image, the shape is extracted and computed based
      on the alpha channel of the specified image. If the
      &lt;uri&gt; does not reference an SVG shape element or an
      image, the effect is as if the value ‘auto’ had been
      specified.
      <p class="issue">Check if we allow referencing an image. There
	are security issues. If we allow it, then the
	'shape-image-threshold' property is also required.</p>

      <div class="example">
	<p>
	  An example of using a reference to an SVG <a>shape</a> for wrapping horizontal text.
	</p>

	<pre><![CDATA[
<svg xmlns="http://www.w3.org/2000/svg"
     width="300" height="100" viewBox="0 0 300 100">

  <defs>
    <rect id="wrap" x="50" y="10" width="200" height="80"/>
  </defs>

  <text shape-inside="url(#wrap)"
	font-family="sans-serif"
	font-size="20px" >This text wraps in a rectangle.</text>

</svg>
]]></pre>

	<div class="figure">
	  <img class="bordered" src="images/text/text-wrap-rectangle.svg"
	       alt="Image showing text wrapped inside a rectangle."/>
	  <p class="caption">
	    Horizontal text wrapping inside an SVG rectangle shape.
	    The light-blue lines indicate the limits of the
	    <a>content area</a>.
	  </p>
	</div>
      </div>
    </dd>

  </dl>


  <p class="note">
    Except as noted, see the CSS Shapes Module Level 2 for the definition of
    <a href="http://www.w3.org/TR/2012/WD-css3-exclusions-20120503/#shape-inside-property">'shape-inside'</a>.
    [<a href="refs.html#ref-CSS21">CSSXX</a>]
  </p>

  <p class="issue">
    'shape-inside' was removed when the CSS Exclusions and Shapes
    Module was split into separate Exclusions and Shapes modules. At
    the Tokyo joint SVG/CSS F2F meeting, it was agreed that it would
    reappear in CSS Shapes Module Level 2.
  </p>

<h3 id='TextShapeOutside'>The <span class="property">'shape-outside'</span> property</h3>

  <p>
    The <a>'shape-outside'</a> property allows one to exclude part of
    the <a>content area</a> from the <a>wrapping area</a>. The
    exclusion can be a <a>CSS basic shape</a> or to an
    SVG <a>shape</a>.
  </p>
  <p class="note">
    In CSS/HTML <a>'shape-outside'</a> applies to floats and
    absolute and percentage values are defined relative to the
    float.

    In SVG absolute and percentage values are defined relative to the
    current <a>user coordinate system</a> and the <a>'viewBox'</a>.

    <span class="issue">We could use the content area.</span>
  </p>
  <p class="issue">
    The value 'auto' is probably not useful in SVG.
    A new value of 'none' is probably needed in which case
    the property is ignored.
  </p>

  <table class="propdef">
    <tr>
      <th>Name:</th>
      <td><dfn id="ShapeOutsideProperty">shape-outside</dfn></td>
    </tr>
    <tr>
      <th>Value:</th>
      <td>none | &lt;basic-shape&gt; | &lt;uri&gt;</td>
    </tr>
    <tr>
      <th>Initial:</th>
      <td>none</td>
    </tr>
    <tr>
      <th>Applies to:</th>
      <td><a>'text'</a> elements</td>
    </tr>
    <tr>
      <th>Inherited:</th>
      <td>no</td>
    </tr>
    <tr>
      <th>Percentages:</th>
      <td>N/A</td>
    </tr>
    <tr>
      <th>Media:</th>
      <td>visual</td>
    </tr>
    <tr>
      <th>Computed&#160;value:</th>
      <td>computed lengths for &lt;basic-shape&gt;, the absolute URI for &lt;uri&gt;, otherwise as specified </td>
    </tr>
    <tr>
      <th><a>Animatable</a>:</th>
      <td>yes, see <a href="http://dev.w3.org/csswg/css-shapes/#basic-shape-interpolation">Interpolation of Basic Shapes</a></td>
    </tr>
  </table>

  <dl>
    <dt><span class="attr-value">&lt;basic-shape&gt;</span></dt>
    <dd>
      The shape is computed based on the values of one of
      ‘rectangle’,‘ circle’, ‘ellipse’ or ‘polygon’.
    </dd>

    <dt><span class="attr-value">&lt;uri&gt;</span></dt>
    <dd>
      If the &lt;uri&gt; references an SVG <a>shape</a> element,
      that element defines the shape. Otherwise, if the &lt;uri&gt;
      references an image, the shape is extracted and computed based
      on the alpha channel of the specified image. If the
      &lt;uri&gt; does not reference an SVG shape element or an
      image, the effect is as if the value ‘auto’ had been
      specified.
      <p class="issue">
	Check if we allow referencing an image. There are security
	issues. If we allow it, then the 'shape-image-threshold'
	property is also required.
      </p>
    </dd>

  </dl>

  <div class="example">
    <p>
      An example of using <a>'shape-outside'</a>.
    </p>.

    <pre><![CDATA[
<svg xmlns="http://www.w3.org/2000/svg"
     width="450" height="300" viewBox="0 0 450 300">

  <rect id="rect1" x="25"  y="25"  width="225" height="175" fill="white" stroke="black"/>
  <rect id="rect2" x="200" y="125" width="225" height="150" fill="white" stroke="black"/>

  <text shape-inside="url(#rect1)"
	shape-outside="url(#rect2)"
	shape-padding="25"
	shape-margin="25"
        font-family="DejaVu Sans"
	font-size="12px"
	text-align="justified"
	line-height="110%">Lorem ipsum ...</text>
  <text shape-inside="url(#rect2)"
	shape-padding="25"
        font-family="DejaVu Sans"
	font-size="12px"
	text-align="justified"
	line-height="110%">Lorem ipsum ...</text>
</svg>
]]></pre>

    <div class="figure">
      <img class="bordered" src="images/text/text-wrap-complex.png"
           alt="Image showing horizontal text wrapped inside two overlapping rectangles."/>
      <p class="caption">
	Horizontal text wrapping inside two overlapping rectangles
	using <a>'shape-outside'</a> as well as
	<a>'shape-inside'</a>, <a>'shape-padding'</a> and
        <a>'shape-margin'</a>. The black rectangles show
	the <a>content area</a>s. The inner blue lines show
	the <a>wrapping area</a>s.
      </p>
    </div>
  </div>

  <p class="note">
    Except as noted, see the CSS Shapes Module Level 1 for the definition of
    <a href="http://dev.w3.org/csswg/css-shapes/#shape-outside-property">'shape-outside'</a>.
    [<a href="refs.html#ref-CSS21">CSSXX</a>]
  </p>

<h3 id='TextShapeMargin'>The <span class="property">'shape-margin'</span> property</h3>

  <p>
    The <a>'shape-margin'</a> property adds a margin to a
    <a>'shape-outside'</a>. This defines a new shape where every
    point is the specified distance from the shape-outside. This
    property takes on positive values only.
  </p>

  <table class="propdef">
    <tr>
      <th>Name:</th>
      <td><dfn id="ShapeMarginProperty">shape-margin</dfn></td>
    </tr>
    <tr>
      <th>Value:</th>
      <td><a href="types.html#DataTypeLengths">&lt;length&gt;</a></td>
    </tr>
    <tr>
      <th>Initial:</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Applies to:</th>
      <td><a>'text'</a> elements</td>
    </tr>
    <tr>
      <th>Inherited:</th>
      <td>no</td>
    </tr>
    <tr>
      <th>Percentages:</th>
      <td>N/A</td>
    </tr>
    <tr>
      <th>Media:</th>
      <td>visual</td>
    </tr>
    <tr>
      <th>Computed&#160;value:</th>
      <td>the absolute length </td>
    </tr>
    <tr>
      <th><a>Animatable</a>:</th>
      <td>yes</td>
    </tr>
  </table>

  <p class="note">
    Except as noted, see the CSS Shapes Module Level 1 for the definition of
    See <a href="http://dev.w3.org/csswg/css-shapes/#shape-margin-property">'shape-margin'</a>.
    [<a href="refs.html#ref-CSS21">CSSXX</a>]
  </p>

<h3 id='TextShapePadding'>The <span class="property">'shape-padding'</span> property</h3>

  <p>
    The <a>'shape-padding'</a> property can be used to offset the
    inline flow content wrapping on the inside of elements. Offsets
    created by the ‘wrap-padding’ property are offset from the content
    area of the element. This property takes on positive values only.
  </p>
    
  <div class="example">
    <p>An example of using <a>'shape-padding'</a></p>.

    <pre><![CDATA[
<svg xmlns="http://www.w3.org/2000/svg"
     width="300" height="300" viewBox="0 0 300 300">

  <circle id="circle" cx="150" cy="150" r="125" fill="none" stroke="black"/>
  <text shape-inside="url(#circle)"
	shape-padding="25"
        font-family="DejaVu Sans"
	font-size="18px"
	text-align="justified"
	line-height="110%">This is an example of
  wrapped text in SVG 2! There should be 25
  pixel pixel around the text. The text is
  justified on both sides. It looks good!</text>

</svg>
]]></pre>

    <div class="figure">
      <img class="bordered" src="images/text/text-shape-padding.png"
           alt="Image showing horizontal text wrapped inside a circle with a padding."/>
      <p class="caption">
	Horizontal text wrapping inside a circle with
	a <a>'shape-padding'</a>. The outer black circle shows
	the <a>content area</a>. The inner blue circle shows
	the <a>wrapping area</a>.
      </p>
    </div>
    <p class="issue">This image is a PNG. Figure out how to make a good SVG.</p>
  </div>

  <p class="note">
    Except as noted, see the CSS Shapes Module Level 2 for the definition of
    <a href="http://www.w3.org/TR/2012/WD-css3-exclusions-20120503/#wrap-padding-property">'shape-padding'</a>
    (wrap-padding renamed to shape-padding).
  </p>

<h2 id="TextLayoutDirections">Text layout &#x2013; Directions</h2>

  <div class="annotation svg2-requirement">
    <table>
      <tr>
	<th>SVG 2 Requirement:</th>
	<td>Align with CSS for text layout functionality.</td>
      </tr>
      <tr>
	<th>Resolution:</th>
	<td><a href="http://www.w3.org/2011/07/29-svg-minutes.html#item08">SVG 2 Will use CSS3 definitions for text layout (white space, bidi, etc.) that is not specific to SVG.</a></td>
      </tr>
      <tr>
	<th>Purpose:</th>
	<td>To facilitate shared specification and implementation of text layout in HTML and SVG.</td>
      </tr>
      <tr>
	<th>Owner:</th>
	<td>Cameron and Chris (<a href="http://www.w3.org/Graphics/SVG/WG/track/actions/3004">ACTION-3004</a>,
          <a href="http://www.w3.org/Graphics/SVG/WG/track/actions/3005">ACTION-3005</a>)</td>
      </tr>
    </table>
  </div>

  <p>
    This section describes the text layout rules that govern direction
    of text flow inside a <a>content area</a> in order to support
    various international writing directions, such as left-to-right
    (e.g., Latin scripts) and bidirectional (e.g., Hebrew or Arabic),
    and vertical (e.g., Asian scripts).
  </p>

  <p class="issue">
    We cannot simply reference CSS 2 as it doesn't include the
    <a>'writing-mode'</a> property. The
    <a href="http://www.w3.org/TR/css3-writing-modes/">CSS Writing
    Modes Module Level 3</a> spec does include <a>'writing-mode'</a>
    but its definition is a bit different from SVG 1.1. The spec also
    has a different structure, putting 'direction' and 'unicode-bidi'
    before 'writing-mode'.
  </p>


<h3 id="BasicLayoutMetrics">Layout Orientations</h3>

  <p id="ReferenceOrientation">
    For each <a>'text'</a> element, the SVG user agent determines the
    current <dfn>reference orientation</dfn>. For standard horizontal
    or vertical text (i.e., not text-on-a-path), the reference
    orientation is the vector pointing towards negative infinity in Y
    within the current user coordinate system. (Note: in
    the <a>initial coordinate system</a>, the reference orientation is
    up.)  For <a href="text.html#TextLayoutPath">text on a path</a>,
    the reference orientation is determined at each character's
    position along the path. It is 90 degrees counter-clockwise
    relative to the path direction for horizontal text and 180 degrees
    relative to the path direction for vertical text.
  </p>
  <p class="issue">In the model that text-on-a-path is text that is
    first layed out according to CSS and then warped along a path, we
    can get rid of the distinction made above.</p>

  <p id="InlineProgressionDirection">
    Based on the reference orientation and the value for
    property <a>'writing-mode'</a>, the SVG user agent determines the
    current <dfn>inline-progression-direction</dfn>. For left-to-right
    text, the inline-progression-direction points 90 degrees clockwise
    from the reference orientation vector. For right-to-left text, the
    inline progression points 90 degrees counter-clockwise from the
    reference orientation vector. For top-to-bottom text, the
    inline-progression-direction points 180 degrees from the reference
    orientation vector.
  </p>

  <p id="BlockProgressionDirection">
    Based on the reference orientation and the value for
    property <a>'writing-mode'</a>, the SVG user agent determines the
    current <dfn>block-progression-direction</dfn>. For left-to-right
    and right-to-left text, the block-progression-direction points 180
    degrees from the reference orientation vector because the only
    available horizontal <a>'writing-mode'</a>s
    are <span class="prop-value">lr-tb</span>
    and <span class="prop-value">rl-tb</span>. For top-to-bottom text,
    the block-progression-direction always points 90 degrees
    counter-clockwise from the reference orientation vector because
    the only available top-to-bottom <a>'writing-mode'</a>
    is <span class="prop-value">tb-rl</span>.
  </p>

  <p class="issue">Insert figure.</p>

  <p id="ShiftDirection">The <dfn>shift direction</dfn> is the
    direction towards which the
    <a href="#FontsTablesBaselines">baseline table</a> moves due
    to positive values for property <a>'baseline-shift'</a>. The shift
    direction is such that a positive value shifts the baseline table
    towards the topmost entry in the parent's
    <a href="#FontsTablesBaselines">baseline table</a>.
  </p>

<h4 id="SettingInlineProgressionDirection">The inline-progression-direction: the <span class="property">'writing-mode'</span> property</h4>

  <div class="issue">
    <p>
      Do we align with CSS Writing Modes Module Level 3? In CSS3,
      inline progression direction is separated from block progression
      direction. The CSS Writing Modes Module redefines
      'writing-mode'. Note: SVG does not have tb-lr required
      for Mongolian.
    </p>
    <ul>
      <li>SVG 1.1:  	lr-tb | rl-tb | tb-rl | lr | rl | tb</li>
      <li>CSS Writing Modes: horizontal-tb | vertical-rl | vertical-lr</li>
    </ul>
    <p>
      See: <a href="http://www.w3.org/Style/CSS/Tracker/issues/183">CSS Issue-183</a>
    </p>
  </div>

  <p>
    The <a>'writing-mode'</a> property specifies whether the initial
    inline-progression-direction for a <a>'text'</a> element shall be
    left-to-right, right-to-left, or top-to-bottom. The
    <a>'writing-mode'</a> property applies only to <a>'text'</a>
    elements; the property is ignored for <a>'tspan'</a>, <a>'tref'</a>,
    <a>'altGlyph'</a>, and <a>'textPath'</a> sub-elements. (Note that
    the inline-progression-direction can change within a <a>'text'</a>
    element due to the Unicode bidirectional algorithm and
    properties <a>'direction'</a> and <a>'unicode-bidi'</a>. For more on
    bidirectional text, see
    <a href="text.html#RelationshipWithBiDirectionality">Relationship
    with bidirectionality</a>.)
  </p>

  <table  class="propdef">
    <tr>
      <th>Name:</th>
      <td><dfn id="WritingModeProperty">writing-mode</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td>lr-tb | rl-tb | tb-rl | lr | rl | tb</td>
    </tr>
    <tr>
      <td>Initial:</td>
      <td>lr-tb</td>
    </tr>
    <tr>
      <td>Applies to:</td>
      <td><a>'text'</a> elements</td>
    </tr>
    <tr>
      <td>Inherited:</td>
      <td>yes</td>
    </tr>
    <tr>
      <td>Percentages:</td>
      <td>N/A</td>
    </tr>
    <tr>
      <td>Media:</td>
      <td>visual</td>
    </tr>
    <tr>
      <th>Computed&#160;value:</th>
      <td></td>
    </tr>
    <tr>
      <th><a>Animatable</a>:</th>
      <td>no</td>
    </tr>
  </table>

  <dl>
    <dt><span class="attr-value">lr-tb | lr</span></dt>
    <dd>
      Sets the initial inline-progression-direction to left-to-right,
      as is common in most Latin-based documents.  For most
      characters, the <em>current text position</em> is advanced from
      left to right after each glyph is rendered.  (When the character
      data includes characters which are subject to the Unicode
      bidirectional algorithm, the text advance rules are more
      complex. See <a href="text.html#RelationshipWithBiDirectionality">Relationship
      with bidirectionality</a>).
    </dd>

    <dt><span class="attr-value">rl-tb | rl</span></dt>
    <dd>
      Sets the initial inline-progression-direction to
      right-to-left, as is common in Arabic or Hebrew scripts. (See
      <a href="text.html#RelationshipWithBiDirectionality">Relationship
	with bidirectionality</a>.)
    </dd>

    <dt><span class="attr-value">tb-rl | tb</span></dt>
    <dd>
      Sets the initial inline-progression-direction to top-to-bottom,
      as is common in some Asian scripts, such as Chinese and
      Japanese. Though hardly as frequent as horizontal, this type of
      vertical layout also occurs in Latin based documents,
      particularly in table column or row labels.  In most cases, the
      vertical baselines running through the middle of each glyph are
      aligned.
    </dd>
  </dl>

<h3 id="RelationshipWithBiDirectionality">Relationship with bidirectionality</h3>

  <p>
    The characters in certain scripts are written from right to
    left. In some documents, in particular those written with the
    Arabic or Hebrew script, and in some mixed-language contexts, text
    in a single line may appear with mixed directionality. This
    phenomenon is called bidirectionality, or "bidi" for short.
  </p>

  <p>
    The Unicode standard
    ([<a href="refs.html#ref-UNICODE">UNICODE</a>], specifically
    [<a href="refs.html#ref-UAX9">UAX9</a>]) defines a complex
    algorithm for determining the proper directionality of text. The
    algorithm consists of an implicit part based on character
    properties, as well as explicit controls for embeddings and
    overrides. The <a>SVG user agent</a> applies this bidirectional
    algorithm when determining the layout of characters within a
    <a>text content block element</a>.
  </p>

  <p>
    The <a>'direction'</a> and <a>'unicode-bidi'</a> properties allow
    authors to override the inherent directionality of the content
    characters and thus explicitly control how the elements and
    attributes of a document language map to this algorithm. These two
    properties are applicable to all characters whose glyphs are
    perpendicular to the inline-progression-direction.
  </p>

  <p>
    In many cases, the bidirectional algorithm from Unicode
    [<a href="refs.html#ref-UNICODE">UNICODE</a>] produces the desired
    result automatically, and in such cases the author does not need
    to use these properties. For other cases, such as when using
    right-to-left languages, it may be sufficient to add the
    <a>'direction'</a> property to the <a>rootmost 'svg' element</a>,
    and allow that direction to inherit to all text elements, as in the
    following example (which may be used as a template):
  </p>

  <edit:example href="images/text/rtl-text.svg" link="yes" image="yes"/>

  <p class="issue">
    Is the PNG image above correct? Shouldn't the period be on the
    other side?
  </p>

  <p>
    Below is another example, where where implicit bidi reordering is not sufficient:
  </p>

  <edit:example href="images/text/rtl-complex.svg" link="yes" image="yes"/>

  <p>
    Within <a>text content elements</a>, the alignment of text with
    regards to the <a>'text-anchor'</a> property is determined by the
    value of the <a>'direction'</a> property. For example, given
    a <a>'text'</a> element with a <a>'text-anchor'</a> value
    of <span class="prop-value">"end"</span>, for a <a>'direction'</a>
    value of <span class="prop-value">"ltr"</span>, the text will
    extend to the left of the position of the <a>'text'</a>
    element's <a>'text/x'</a> attribute value, while for
    <a>'direction'</a> value of <span class="prop-value">"rtl"</span>,
    the text will extend to the right of the position of the
    <a>'text'</a> element's <a>'text/x'</a> attribute value.
  </p>

  <p>
    A more complete discussion of bidirectionality can be found in the
    <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/visuren.html#direction">Text
      direction</a> section of CSS 2.1
    ([<a href="refs.html#ref-CSS21">CSS21</a>], section 9.10).
  </p>

  <p>
    The processing model for bidirectional text is as follows. The
    user agent processes the characters which are provided in
    <em>logical order</em> (i.e., the order the characters appear in
    the original document, either via direct inclusion or via indirect
    reference due a <a>'tref'</a> element). The user agent determines
    the set of independent blocks within each of which it should apply
    the Unicode bidirectional algorithm. Each
    <a href="text.html#TextChunk">text chunk</a> represents an
    independent block of text. Additionally, any change in glyph
    orientation due to processing of properties
    <a>'glyph-orientation-horizontal'</a> or
    <a>'glyph-orientation-vertical'</a> will subdivide the independent
    blocks of text further. After processing the Unicode bidirectional
    algorithm and properties <a>'direction'</a> and
    <a>'unicode-bidi'</a> on each of the independent text blocks, the
    user agent will have a potentially re-ordered list of characters
    which are now in left-to-right rendering order. Simultaneous with
    re-ordering of the characters, the <a>'tspan/dx'</a>,
    <a>'tspan/dy'</a>, and <a>'tspan/rotate'</a> attributes on the
    <a>'tspan'</a> and <a>'tref'</a> elements are also re-ordered to
    maintain the original correspondence between characters and
    attribute values. While kerning or ligature processing might be
    font-specific, the preferred model is that kerning and ligature
    processing occurs between combinations of characters or glyphs
    after the characters have been re-ordered.
  </p>

<h4 id="BaseDirection">The <span class="property">'direction'</span> property</h4>

  <table class="propdef">
    <tr>
      <th>Name:</th>
      <td><dfn id="DirectionProperty">direction</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td>ltr | rtl</td>
    </tr>
    <tr>
      <td>Initial:</td>
      <td>ltr</td>
    </tr>
    <tr>
      <td>Applies to:</td>
      <td><a>text content elements</a></td>
    </tr>
    <tr>
      <td>Inherited:</td>
      <td>yes</td>
    </tr>
    <tr>
      <td>Percentages:</td>
      <td>N/A</td>
    </tr>
    <tr>
      <td>Media:</td>
      <td>visual</td>
    </tr>
    <tr>
      <th>Computed&#160;value:</th>
      <td></td>
    </tr>
    <tr>
      <th><a>Animatable</a>:</th>
      <td>no</td>
    </tr>
  </table>

  <p>
    This property specifies the base writing direction of text and the
    direction of embeddings and overrides (see <a>'unicode-bidi'</a>)
    for the Unicode bidirectional algorithm. For
    the <a>'direction'</a> property to have any effect on an element
    that does not by itself establish a
    new <a href="text.html#TextChunks">text chunk</a> (such as
    a <a>'tspan'</a> element without absolute position adjustments due
    to <a>'tspan/x'</a> or <a>'tspan/y'</a> attributes),
    the <a>'unicode-bidi'</a> property's value must
    be <span class='prop-value'>embed</span>
    or <span class='prop-value'>bidi-override</span>.
  </p>

  <p class="note">
    Except for any additional information provided in this
    specification, the
    <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/visuren.html#propdef-direction">normative
    definition</a> of the <a>'direction'</a> property is in CSS 2.1
    ([<a href="refs.html#ref-CSS21">CSS21</a>], section 9.10).
  </p>

  <p>
    The <a>'direction'</a> property applies only to glyphs oriented
    perpendicular to the
    <a href="text.html#SettingInlineProgressionDirection">inline-progression-direction</a>,
    which includes the usual case of horizontally-oriented Latin or
    Arabic text and the case of narrow-cell Latin or Arabic characters
    rotated 90 degrees clockwise relative to a top-to-bottom
    inline-progression-direction.
  </p>

<h4 id="SettingDirection">The <span class="property">'unicode-bidi'</span> property</h4>

  <table  class="propdef">
    <tr>
      <th>Name:</th>
      <td><dfn id="UnicodeBidiProperty">unicode-bidi</dfn></td>
    </tr>
    <tr>
      <th>Value:</th>
      <td>normal | embed | bidi-override</td>
    </tr>
    <tr>
      <th>Initial:</th>
      <td>normal</td>
    </tr>
    <tr>
      <th>Applies to:</th>
      <td><a>text content elements</a></td>
    </tr>
    <tr>
      <th>Inherited:</th>
      <td>no</td>
    </tr>
    <tr>
      <th>Percentages:</th>
      <td>N/A</td>
    </tr>
    <tr>
      <th>Media:</th>
      <td>visual</td>
    </tr>
    <tr>
      <th>Computed&#160;value:</th>
      <td></td>
    </tr>
    <tr>
      <th><a>Animatable</a>:</th>
      <td>no</td>
    </tr>
  </table>

  <p class="note">
    Except for any additional information provided in this
    specification, the
    <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/visuren.html#propdef-unicode-bidi">normative
      definition</a> of the <a>'unicode-bidi'</a> property is in CSS 2.1
    ([<a href="refs.html#ref-CSS21">CSS21</a>], section 9.10).
  </p>

<h3 id="GlyphOrientation">Glyph orientation within a text run</h3>

  <p class="issue">
    CSS Writing Modes Module Level 3 replaces
    'glyph-orientation-vertical' with
    <a href="http://www.w3.org/TR/css3-writing-modes/#text-orientation">'text-orientation'</a>
    but does not provide a replacement for 'glyph-orientation
    horizontal'. There is, however, a value 'use-glyph-orientation',
    only valid for SVG, which directs an implementation to use the
    values of 'glyph-orientation-veritical' and
    'glyph-orientation-horizontal'. Note that this value is marked
    as <em>at risk</em>.
  </p>

  <p>
    In some cases, it is required to alter the orientation of a
    sequence of characters relative to the
    inline-progression-direction. The requirement is particularly
    applicable to vertical layouts of East Asian documents, where
    sometimes narrow-cell Latin text is to be displayed horizontally
    and other times vertically.
  </p>

  <p>
    Two properties control the glyph orientation relative to the
    reference orientation for each of the two possible
    inline-progression-directions. <a>'glyph-orientation-vertical'</a>
    controls glyph orientation when the inline-progression-direction
    is vertical. <a>'glyph-orientation-horizontal'</a> controls glyph
    orientation when the inline-progression-direction is horizontal.
  </p>

<h4 id="GlyphOrientationVertical">The <span class="property">'glyph-orientation-vertical'</span> property</h4>

  <p class="issue">
    Reference CSS3 text? CSS3 has additional values: upright, inline.
  </p>

  <table class="propdef">
    <tr>
      <th>Name:</th>
      <td><dfn id="GlyphOrientationVerticalProperty">glyph-orientation-vertical</dfn></td>
    </tr>
    <tr>
      <th>Value:</th>
      <td>auto | <a>&lt;angle&gt;</a> | <a>&lt;number&gt;</a></td>
    </tr>
    <tr>
      <th>Initial:</th>
      <td>auto</td>
    </tr>
    <tr>
      <th>Applies to:</th>
      <td><a>text content elements</a></td>
    </tr>
    <tr>
      <th>Inherited:</th>
      <td>yes</td>
    </tr>
    <tr>
      <th>Percentages:</th>
      <td>N/A</td>
    </tr>
    <tr>
      <th>Media:</th>
      <td>visual</td>
    </tr>
    <tr>
      <th>Computed&#160;value:</th>
      <td></td>
    </tr>
    <tr>
      <th><a>Animatable</a>:</th>
      <td>no</td>
    </tr>
  </table>

  <dl>
    <dt><span class="prop-value">auto</span></dt>
    <dd>
      <ul>
	<li>
          <p>
	    Fullwidth ideographic and fullwidth Latin text will be set
            with a glyph-orientation of 0-degrees.
	  </p>
          <p>
	    Ideographic punctuation and other ideographic characters
            having alternate horizontal and vertical forms will use
            the vertical form of the glyph.
	  </p>
	</li>
	<li>
          <p>
	    Text which is not fullwidth will be set with a
            glyph-orientation of 90-degrees.
	  </p>
          <p>
	    This reorientation rule applies only to the first-level
            non-ideographic text. All further embedding of
            writing-modes or bidi processing will be based on the
            first-level rotation.
	  </p>

	  <div class="note">
            <ul>
	      <li>
		<p>This is equivalent to having set the
		  non-ideographic text string horizontally honoring
		  the bidi-rule, then rotating the resultant
		  sequence of inline-areas (one area for each
		  change of glyph direction) 90-degrees
		  clockwise.
		</p>
		<p>It should be noted that text set in this
		  "rotated" manner may contain ligatures or other
		  glyph combining and reordering common to the
		  language and script. (This "rotated" presentation
		  form does not disable auto-ligature formation or
		  similar context-driven variations.)
		</p>
	      </li>
	      <li>
		The determination of which characters should be
		auto-rotated may vary across user agents. The
		determination is based on a complex interaction
		between country, language, script, character
		properties, font, and character context. It is
		suggested that one consult the Unicode TR 11 and the
		various JIS or other national standards.
	      </li>
            </ul>
	  </div>
	</li>
      </ul>
    </dd>

    <dt><span class="prop-value"><a>&lt;angle&gt;</a></span></dt>
    <dt><span class="prop-value"><a>&lt;number&gt;</a></span></dt>
    <dd>
      <p>
	The glyph orientation angle. A value specified as a
	<a>&lt;number&gt;</a> is interpreted as an angle in degrees.
	The value of the angle is restricted to 0, 90, 180, and 270
	degrees. The user agent shall round the value of the angle to
	the closest of the permitted values.
      </p>
      <p>
	A value of <span class="prop-value">0deg</span> indicates that
	all glyphs are set with the top of the glyphs oriented towards
	the <a href="text.html#ReferenceOrientation">reference
	orientation</a>. A value
	of <span class="prop-value">90deg</span> indicates an
	orientation of 90 degrees clockwise from
	the <a href="text.html#ReferenceOrientation">reference
	orientation</a>.
      </p>
    </dd>
  </dl>

  <p>
    This property is applied only to text written in a vertical
    <a>'writing-mode'</a>.
  </p>

  <p>
    The glyph orientation affects the amount that the current text
    position advances as each glyph is rendered. When the
    inline-progression-direction is vertical and the
    <a>'glyph-orientation-vertical'</a> results in an orientation
    angle that is a multiple of 180 degrees, then the current text
    position is incremented according to the vertical metrics of the
    glyph. Otherwise, if the <a>'glyph-orientation-vertical'</a>
    results in an orientation angle that is not a multiple of 180
    degrees, then the current text position is incremented according
    to the horizontal metrics of the glyph.
  </p>

  <p>
    The text layout diagrams in this section use the following symbols:
  </p>

  <table>
    <tr><th><img alt="Symbolic wide-cell glyph representation" class="example" width="39" height="39" src="images/text/fullwidth.png" /></th>
      <td>wide-cell glyph (e.g. Han) which is the <em>n</em>-th glyph in the text run</td></tr>
    <tr><th><img alt="Symbolic narrow-cell glyph representation" class="example" width="19" height="39" src="images/text/halfwidth.png" /></th>
      <td>narrow-cell glyph (e.g. Latin) which is the <em>n</em>-th glyph in the text run</td></tr>
  </table>

  <p>
    The orientation which the above symbols assume in the diagrams
    corresponds to the orientation that the Unicode characters they
    represent are intended to assume when rendered in the user
    agent. Spacing between the glyphs in the diagrams is usually
    symbolic, unless intentionally changed to make a point.
  </p>

  <p>
    The diagrams below illustrate different uses of
    <a>'glyph-orientation-vertical'</a>. The diagram on the left shows
    the result of the mixing of full-width ideographic glyphs with
    narrow-cell Latin glyphs when <a>'glyph-orientation-vertical'</a>
    for the Latin characters is either
    <span class="prop-value">auto</span> or
    <span class="prop-value">90</span>. The diagram on the right show
    the result of mixing full-width ideographic glyphs with
    narrow-cell Latin glyphs when Latin glyphs are specified to have
    a <a>'glyph-orientation-vertical'</a> of
    <span class="prop-value">0</span>.
  </p>

  <!-- Redo these images as one? -->
  <p>
    <img alt="Layout of mixed glyphs in vertical-ideographic mode. Wide-cell glyphs are upright, Non-wide-cell glyphs are rotated by 90 degrees."
	 class="example" width="45" height="262"
	 src="images/text/lf-vi.png" />
    <img alt="Example of mixed Japanese and English in vertical-ideographic layout. Japanese glyphs are upright, English rotated."
	 class="example" width="40" height="260"
	 src="images/text/GlyphOrientAuto.png" />
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <img
       alt="Layout of mixed glyphs in vertical mode. All glyphs are upright."
       class="example" width="42" height="342"
       src="images/text/lf-v.png" />
    <img alt="Example of mixed Japanese and English in vertical layout. All glyphs are upright."
	 class="example" width="38" height="340"
	 src="images/text/GlyphOrientZero.png" />
  </p>

<h4 id="GlyphOrientationHorizontal">The <span class="property">'glyph-orientation-horizontal'</span> property</h4>

  <p class="issue">Reference CSS3 text? CSS3 has additional values: auto, inline.</p>

  <table class="propdef">
    <tr>
      <th>Name:</th>
      <td><dfn id="GlyphOrientationHorizontalProperty">glyph-orientation-horizontal</dfn></td>
    </tr>
    <tr>
      <th>Value:</th>
      <td><a>&lt;angle&gt;</a> | <a>&lt;number&gt;</a></td>
    </tr>
    <tr>
      <th>Initial:</th>
      <td>0deg</td>
    </tr>
    <tr>
      <th>Applies to:</th>
      <td><a>text content elements</a></td>
    </tr>
    <tr>
      <th>Inherited:</th>
      <td>yes</td>
    </tr>
    <tr>
      <th>Percentages:</th>
      <td>N/A</td>
    </tr>
    <tr>
      <th>Media:</th>
      <td>visual</td>
    </tr>
    <tr>
      <th>Computed&#160;value:</th>
      <td></td>
    </tr>
    <tr>
      <th><a>Animatable</a>:</th>
      <td>no</td>
    </tr>
  </table>

  <dl>
    <dt><span class="prop-value"><a>&lt;angle&gt;</a></span></dt>
    <dt><span class="prop-value"><a>&lt;number&gt;</a></span></dt>
    <dd>The glyph orientation angle.  A value specified as a
      <a>&lt;number&gt;</a> is interpreted as an angle in degrees.
      The value of the angle is restricted to 0, 90, 180, and
      270 degrees. The user agent shall round the value of the
      angle to the closest of the permitted values.<br />
      A value of <span class="prop-value">0deg</span> indicates
      that all glyphs are set with the top of the glyphs oriented
      towards the <a
		     href="text.html#ReferenceOrientation">reference
	orientation</a>. A value of <span
				       class="prop-value">90deg</span> indicates an orientation of
      90 degrees clockwise from the <a
				       href="text.html#ReferenceOrientation">reference
	orientation</a>.</dd>
  </dl>

  <p>
    This property is applied only to text written in a
    horizontal <a>'writing-mode'</a>.
  </p>

  <p>
    The glyph orientation affects the amount that the current text
    position advances as each glyph is rendered. When the reference
    orientation direction is horizontal and the
    <a>'glyph-orientation-horizontal'</a> results in an orientation
    angle that is a multiple of 180 degrees, then the current text
    position is incremented according to the horizontal metrics of the
    glyph. Otherwise, if the <a>'glyph-orientation-horizontal'</a>
    results in an orientation angle that is not a multiple of 180
    degrees, then the current text position is incremented according
    to the vertical metrics of the glyph.
  </p>

<h2 id="TextLayoutPositioning">Text layout &#x2013; Positioning</h2>

  <p class="issue">
    Current text position is referred to throughout the document
    (almost 100 times!).
    The idea of current text position needs to be reconciled with
    CSS inline boxes. See:
    <a href="http://dev.w3.org/csswg/css-inline/">CSS-Inline</a> as
    well as with the idea that text is laid out first using CSS rules
    and then tranformed, if necessary, with SVG rules.
  </p>
      
  <p>
    The section covers the general rules for positiong glyphs. In SVG,
    the first step in positioning a glyph is to find its inline
    position which is determined by the <a>current text
    position</a>. Next, the glyph is aligned relative to a particular
    <a href="text.html#BaselineAlignmentProperties">baseline</a>.
    Once a glyph is positioned, the <a>current text position</a> is
    advanced and the next glyph is placed.
  </p>


<h3 id="CurrentTextPosition">Current text position</h3>

  <p>
    In processing a given <a>'text'</a> element, the SVG user agent
    keeps track of the <dfn>current text position</dfn>. The initial
    current text position is established by the <a>'text/x'</a>
    and <a>'text/y'</a> attributes on the <a>'text'</a> element for
    pre-formatted and in some cases for auto-wrapped text.
    <span class="issue">FIX FOR AUTO-WRAPPED TEXT IN SHAPE</span>
  </p>

  <p>
    The current text position is adjusted after each glyph to
    establish a new current text position at which the next glyph
    shall be rendered. The adjustment to the current text position is
    based on:
  </p>
  <ul>
    <li>The current
    <a href="text.html#SettingInlineProgressionDirection">inline-progression-direction</a>.</li>
    <li>Glyph-specific advance values corresponding to
    the <a href="text.html#GlyphOrientation">glyph orientation</a> of
    the glyph just rendered.</li>
    <li>Kerning tables in the font.</li>
    <li>The current values of various attributes and properties, such as
    the <a href="text.html#SpacingProperties">spacing properties</a>.</li>
    <!-- Removed in SVG2: <li>For pre-formatted and text on a a path, the ‘x’, ‘y’, ‘dx’, and ‘dy’ attributes on ‘text’, ‘tspan’, ‘tref’, or ‘altGlyph’ elements.</li>-->
    <li>New lines in pre-formatted or auto-wrapped text.<!-- Added in SVG2--></li>
  </ul>
  <p>
    If a glyph does not provide explicit advance values corresponding
    to the current <a href="text.html#GlyphOrientation">glyph
    orientation</a>, then an appropriate approximation should be
    used. For vertical text, a suggested approximation is the sum of
    the ascent and descent values for the glyph. Another suggested
    approximation for an advance value for both horizontal and
    vertical text is the size of an <em>em</em> (see
    <a href="fonts.html#FontFaceElementUnitsPerEmAttribute">units-per-em</a>).
  </p>

  <p id="AlignmentPoint">
    For each glyph to be rendered, the SVG user agent determines an
    appropriate <dfn>alignment-point</dfn> on the glyph which will be
    placed exactly at the current text position. The alignment-point is
    determined based on glyph cell metrics in the glyph itself, the
    current <a href="text.html#SettingInlineProgressionDirection">inline-progression-direction</a>
    and the <a href="text.html#GlyphOrientation">glyph orientation</a>
    relative to the inline-progression-direction.  For example, in most
    uses of pre-formatted Latin text (i.e.,

    <span class='attr-value'>writing-mode:lr</span>,
    <span class='attr-value'>text-anchor:start</span>, and
    <span class='attr-value'>alignment-baseline:baseline</span>)

    the alignment-point in the glyph will be the intersection of left
    edge of the glyph cell (or some other glyph-specific x-axis
    coordinate indicating a left-side origin point) with the Latin
    baseline of the glyph. For many cases with top-to-bottom vertical
    text layout, the reference point will be either a glyph-specific
    origin point based on the set of vertical baselines for the font
    or the intersection of the center of the glyph with its <em>top
    line</em>

    (see
    <a href="http://dev.w3.org/csswg/css3-linebox/#AlignmentBaselineType">top
      baseline</a>; in
    [<a href="refs.html#ref-CSS3LINEBOX">CSS3LINEBOX</a>], section
    4.2).

    If a glyph does not provide explicit origin points corresponding
    to the current <a href="text.html#GlyphOrientation">glyph
    orientation</a>, then an appropriate approximation should be used,
    such as the intersection of the left edge of the glyph with the
    appropriate horizontal baseline for the glyph or intersection of
    the top edge of the glyph with the appropriate vertical
    baseline. If baseline tables are not available, user agents should
    establish baseline tables that reflect common practice.
  </p>

  <p class="issue">
    The distinction between absolute and relative position adjustments
    seems mostly made to define text chunks.  'x' and 'y' attributes
    are ignored for wrapped text and partially ignored for text on a
    path. Does this impact text chunks?  How are new lines (either
    manual or auto) handled?
  </p>

  <p id="TextChunks">
    Once all the glyphs in a <a>'text'</a> element are laid out
    according to the above rules, the position of the glyphs maybe
    adjusted according to SVG specific rules.
    Adjustments to the current text position are either
    <dfn id='absolute-position-adjustment'>absolute position adjustments</dfn> or
    <dfn id='relative-position-adjustment'>relative position
    adjustments</dfn>. An absolute position adjustment occurs in the
    following circumstances:
  </p>

  <ul>
    <li>At the start of a <a>'text'</a> element</li>
    <li>At the start of each <a>'textPath'</a> element</li>
    <li>For each character within a <a>'text'</a>, <a>'tspan'</a>,
    <a>'tref'</a> and <a>'altGlyph'</a> element which for
    pre-formatted text has an explicit
    <span class='attr-name'>'x'</span> or
    <span class='attr-name'>'y'</span> value,
    or for text on a path has an explicit
    <span class='attr-name'>'x'</span> value if horizontal or
    <span class='attr-name'>'y'</span> value if vertical.</li>
  </ul>

  <p>
    All other position adjustments to the current text position are
    relative position adjustments.
  </p>

  <p id="TextChunk">
    Each absolute position adjustment defines a new
    <dfn>text chunk</dfn>. Absolute position adjustments impact text
    layout in the following ways:
  </p>

  <ul>
    <li>
      Ligatures only occur when a set of characters which might map
      to a ligature are all in the same text chunk.
    </li>
    <li>
      Each text chunk represents a separate block of text for
      alignment due to <a>'text-anchor'</a> property values.
    </li>
    <li>
      Reordering of characters due to
      <a href="text.html#RelationshipWithBiDirectionality">bidirectionality</a>
      only occurs within a text chunk. Reordering does <em>not</em>
      happen across text chunks.
    </li>
  </ul>

  <p>
    The following additional rules apply to ligature formation:
  </p>

  <ul>
    <li>
      As <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/text.html#spacing-props">defined
      in CSS 2.1</a>, ([<a href="refs.html#ref-CSS21">CSS21</a>],
      section 16.4), when the resultant space between two characters
      is not the same as the default space, user agents should not
      use ligatures; thus, if there is a non-default value for
      <a>'letter-spacing'</a>, the user agent should not use
      ligatures.
    </li>

    <li>
      Ligature formation should not be enabled for the glyphs
      corresponding to characters within different DOM text nodes;
      thus, characters separated by markup should not use ligatures.
    </li>

    <li>
      As mentioned above, ligature formation should not be
      enabled for the glyphs corresponding to characters within
      different text chunks.
    </li>
  </ul>

<h3 id="WhiteSpace">White Space</h3>

  <p class="note">
    New in SVG 2. Added <a>'white-space'</a> to allow a more useful
    way to control whitespace handling.  Aligns SVG and HTML/CSS text
    processing. <a>'xml:space'</a> deprecated in new content, retained
    for backwards compatibility.
  </p>

  <h4 id="TextWhiteSpace">SVG 2 Preferred white space handling, the <span class='property'>'white-space'</span> property</h4>

  <p>
    Rendering of white space in SVG 2 is controlled by the <a>'white-space'</a>
    property. This specifies two things:
  </p>
  <ul>
    <li>whether and how white space inside the element is collapsed</li>
    <li>whether lines may wrap at unforced soft wrap opportunities</li>
  </ul>

  <table class="propdef">
    <tr>
      <th>Name:</th>
      <td><dfn id="WhiteSpaceProperty">white-space</dfn></td>
    </tr>
    <tr>
      <th>Value:</th>
      <td>normal | pre | nowrap | pre-wrap | pre-line </td>
    </tr>
    <tr>
      <th>Initial:</th>
      <td>not defined for shorthand properties </td>
    </tr>
    <tr>
      <th>Applies to:</th>
      <td><a>text content elements</a></td>
    </tr>
    <tr>
      <th>Inherited:</th>
      <td>yes</td>
    </tr>
    <tr>
      <th>Percentages:</th>
      <td>N/A</td>
    </tr>
    <tr>
      <th>Media:</th>
      <td>visual</td>
    </tr>
    <tr>
      <th>Computed&#160;value:</th>
      <td>see individual properties </td>
    </tr>
    <tr>
      <th><a>Animatable</a>:</th>
      <td>yes</td>
    </tr>
  </table>

  <p class="note">
    Values and their meanings are defined in
    [<a href="http://dev.w3.org/csswg/css3-text/#white-space">CSS3
    Text</a>].
  </p>

  <div class="example">
    <p>
      An example of using the <a>'white-space'</a>
      value <span class="prop-value">pre-line</span>.
    </p>

    <pre><![CDATA[
<svg xmlns="http://www.w3.org/2000/svg">
     width="200" height="200" viewBox="0 0 200 200">

     <text x="150" y="30" 
           font-family="IPAMincho"
	   font-size="20px"
	   writing-mode="tb-rl"
	   white-space="pre-line">千利奴流乎和加
                                  餘多連曽津祢那
                                  良牟有為能於久
                                  耶万計不己衣天
                                  阿佐伎喩女美之
                                  恵比毛勢須</text>
</svg>
]]></pre>

    <div class="figure">
      <img class="bordered" src="images/text/text-whitespace-vertical.svg"
           alt="Japanese poem showing traditional line-breaking after every seven kanji."/>
      <p class="caption">
	Example of multi-line vertical text with line breaks. The text
	is from the Japanese poem <em>Iroha</em>. The lines are broken
	at traditional places. <span class="issue">Example does not
	  render properly in Firefox. It is SVG 1.1 text. Bad Firefox.</span>
      </p>
    </div>
  </div>


<h4 id="LegacyXMLSpace">Legacy whitespace handling, the <span class='property'>'xml:space'</span> property</h4>

  <p id="XMLSpaceAttribute">
    For compatibility, SVG 2 also supports the  XML attribute
    <a>'xml:space'</a> to specify the handling of white space
    characters within a given <a>'text'</a> element's character
    data. New content should not use <a>'xml:space'</a> but
    instead, use the <a>'white-space'</a> property.
  </p>

  <p>
    Note that any child element of a <a>'text'</a> element may also
    have an <a>'xml:space'</a> attribute which will apply to that
    child element's text content.  The SVG user agent has special
    processing rules associated with this attribute as described
    below. These are behaviors that occur subsequent to XML parsing
    [<a href="http://www.w3.org/TR/2008/REC-xml-20081126/">XML10</a>]
    and any construction of a DOM.
  </p>

  <p>
    <a>'xml:space'</a> is an inheritable attribute which can have one of
    two values:
  </p>

  <dl>
    <dt><span class='attr-value'>'default'</span></dt>
    <dd>
      (The initial/default value for <a>'xml:space'</a>.) When
      <span class='attr-value'>xml:space="default"</span>, the SVG
      user agent will do the following using a copy of the original
      character data content. First, it will remove all newline
      characters. Then it will convert all tab characters into space
      characters. Then, it will strip off all leading and trailing
      space characters. Then, all contiguous space characters will be
      consolidated.
    </dd>

    <dt><span class='attr-value'>'preserve'</span></dt>
    <dd>
      When <span class='attr-value'>xml:space="preserve"</span>, the
      SVG user agent will do the following using a copy of the
      original character data content. It will convert all newline and
      tab characters into space characters. Then, it will draw all
      space characters, including leading, trailing and multiple
      contiguous space characters. Thus, when drawn with
      <span class='attr-value'>xml:space="preserve"</span>, the string
      <code>"a&nbsp;&nbsp;&nbsp;b"</code> (three spaces between "a"
      and "b") will produce a larger separation between "a" and "b"
      than <code>"a&nbsp;b"</code> (one space between "a" and "b").
    </dd>
  </dl>

  <p>
    The following example illustrates that line indentation can be
    important when using
    <span class='attr-value'>xml:space="default"</span>.  The fragment
    below show two pairs of similar <a>'text'</a> elements, with
    both <a>'text'</a> elements using
    <span class="attr-value">xml:space="default"</span>. For
    these examples, there is no extra white space at the end of any of
    the lines (i.e., the line break occurs immediately after the last
    visible character).
  </p>

  <pre>
[01]  &lt;text xml:space='default'&gt;
[02]    WS example
[03]    indented lines
[04]  &lt;/text&gt;
[05]  &lt;text xml:space='preserve'&gt;WS example indented lines&lt;/text&gt;
[06]
[07]  &lt;text xml:space='default'&gt;
[08]WS example
[09]non-indented lines
[10]  &lt;/text&gt;
[11]  &lt;text xml:space='preserve'&gt;WS examplenon-indented lines&lt;/text&gt;
  </pre>

  <p>
    The first pair of <a>'text'</a> elements above show the
    effect of indented character data. The attribute
    <span class="attr-value">xml:space="default"</span> in the first
    <a>'text'</a> element instructs the user agent to:
  </p>

  <ul>
    <li>convert all tabs (if any) to space characters,</li>
    <li>strip out all line breaks (i.e., strip out the line
    breaks at the end of lines [01], [02] and [03]),</li>
    <li>strip out all leading space characters (i.e., strip out
    space characters before "WS example" on line [02]),</li>
    <li>strip out all trailing space characters (i.e., strip out
    space characters before "&lt;/text&gt;" on line [04]),</li>
    <li>consolidate all intermediate space characters (i.e., the
    space characters before "indented lines" on line [03]) into a
    single space character.</li>
  </ul>

  <p>
    The second pair of <a>'text'</a> elements above show the
    effect of non-indented character data. The attribute
    <span class="attr-value">xml:space="default"</span> in the third
    <a>'text'</a> element instructs the user agent to:
  </p>

  <ul>
    <li>convert all tabs (if any) to space characters,</li>
    <li>strip out all line breaks (i.e., strip out the line
    breaks at the end of lines [07], [08] and [09]),</li>
    <li>strip out all leading space characters (there are no
    leading space characters in this example),</li>
    <li>strip out all trailing space characters (i.e., strip out
    space characters before "&lt;/text&gt;" on line [10]),</li>
    <li>consolidate all intermediate space characters into a
    single space character (in this example, there are no
    intermediate space characters).</li>
  </ul>

  <p>
    Note that XML parsers are required to convert the standard
    representations for a newline indicator (e.g., the literal
    two-character sequence "#xD#xA" or the stand-alone literals #xD or
    #xA) into the single character #xA before passing character data
    to the application. Thus, each newline in SVG will be represented
    by the single character #xA, no matter what representation for
    newlines might have been used in the original resource. (See
    <a href="http://www.w3.org/TR/2008/REC-xml-20081126/#sec-line-ends">XML
    end-of-line handling</a>.)
  </p>

  <p>
    Any features in the SVG language or the SVG DOM that are based
    on character position number, such as the <a>'tspan/x'</a>,
    <a>'tspan/y'</a>, <a>'tspan/dx'</a>, <a>'tspan/dy'</a> and
    <a>'tspan/rotate'</a> attributes on the <a>'text'</a>, <a>'tspan'</a>,
    <a>'tref'</a> and <a>'altGlyph'</a> elements, are based on
    character position after applying the white space handling rules
    described here.  In particular,
    if <span class='attr-value'>xml:space="default"</span>, it is
    often the case that white space characters are removed as part of
    processing. Character position numbers index into the text string
    after the white space characters have been removed per the rules
    in this section.
  </p>

  <p>
    Note that a glyph corresponding to a whitespace character should
    only be displayed as a visible but blank space, even if the glyph
    itself happens to be non-blank.
    See <a href="http://www.unicode.org/faq/unsup_char.html">display
    of unsupported characters</a>
    [<a href="refs.html#ref-UNICODE">UNICODE</a>].
  </p>

  <p>
    The <a>'xml:space'</a> attribute is:
  </p>
  <p>
    &nbsp;&nbsp;&nbsp;&nbsp;<span class="anim-target"><a href="animate.html#Animatable">Animatable</a>:
    no.</span>
  </p>

<h4 id="DuplicateWhiteSpace">Duplicate whitespace directives</h4>

  <p>
    Older, SVG 1.1 content will use <a>'xml:space'</a>. New content,
    and older content that is being reworked, will use
    <a>'white-space'</a> and remove any existing
    <a>'xml:space'</a>. However, user agents may come across content
    which uses both methods on the same element. If
    the <a>'white-space'</a> property is set on any element, then the
    value of <a>'xml:space'</a> is ignored.
  </p>

<h4 id="TabSizeProperty">Tab character size: the <span class="property">‘tab-size’</span> property</h4>
  <p class="note">
    See the CSS Text Module Level 3 specification for the definition
    of <a href="http://dev.w3.org/csswg/css-text/#tab-size">'tab-size'</a>.
    [<a href="refs.html#ref-CSS21">CSSXX</a>]
  </p>


<h3 id='TextLineHeight'>Line spacing, the <span class="property">'line-height'</span> property</h3>

  <p class="note">
    New in SVG 2.

    Added for multi-line pre-formatted and auto-wrapped text. Aligns SVG and HTML/CSS
    text processing.
  </p>

  <p>
    SVG uses the <a>'line-height'</a> property to determine the amount
    of leading space which is added between lines in multi-line text
    (both horizontal and vertical). It is not applicable to text on a
    path.
  </p>

  <p class="issue">
    Is this correct for vertical text?
  </p>

  <table class="propdef" >
    <tr>
      <th>Name:</th>
      <td><dfn id="LineHeightProperty">line-height</dfn></td>
    </tr>
    <tr>
      <th>Value:</th>
      <td>normal | <a>&lt;number&gt;</a> | <a>&lt;length&gt;</a>| <a>&lt;percentage&gt;</a></td>
    </tr>
    <tr>
      <th>Initial:</th>
      <td>normal</td>
    </tr>
    <tr>
      <th>Applies to:</th>
      <td><a>text content elements</a></td>
    </tr>
    <tr>
      <th>Inherited:</th>
      <td>yes</td>
    </tr>
    <tr>
      <th>Percentages:</th>
      <td>refer to the font size of the element itself</td>
    </tr>
    <tr>
      <th>Media:</th>
      <td>visual</td>
    </tr>
    <tr>
      <th>Computed&#160;value:</th>
      <td>see individual properties </td>
    </tr>
    <tr>
      <th><a>Animatable</a>:</th>
      <td>yes</td>
    </tr>
  </table>

  <p class="note">
    See the CSS2.1 specification for the definition of
    <a href="http://www.w3.org/TR/CSS2/visudet.html#propdef-line-height">'line-height'</a>.
    [<a href="refs.html#ref-CSS21">CSS21</a>]
  </p>
  <p class="note">
    See the CSS Line Layout Module 3 specification for the definition
    of
    <a href="http://dev.w3.org/csswg/css-inline/#InlineBoxHeight">'line-height'</a>.
    [<a href="refs.html#ref-CSS3LINEBOX">CSS3LINEBOX</a>]
    <span class="issue">CSS 3 adds the value 'none'.</span>
  </p>

<h3 id="SpacingProperties">Spacing within lines</h3>

  <p>
    Two properties affect the space between characters and words:
  </p>

  <ul>
    <li>
      <a>'letter-spacing'</a> indicates an amount of space that is
      to be added between text characters.
    </li>

    <li>
      <a>'word-spacing'</a> indicates the spacing behavior between words.
    </li>
  </ul>

  <p class='issue'>
    Note that the <span class='property'>'kerning'</span> property
    from SVG 1.1 has been removed in favor of using
    <a>'letter-spacing'</a> to add or remove spacing between glyphs
    and the <span class='property'>'font-kerning'</span> property to
    disable kerning based on information from the font.
  </p>

  <p class='issue'>
    We need to require <span class='property'>'font-kerning'</span>.
  </p>

<h4 id='TextLetterSpacing'>The <span class="property">'letter-spacing'</span> property</h4>

  <table class="propdef">
    <tr>
      <th>Name:</th>
      <td><dfn id="LetterSpacingProperty">'letter-spacing'</dfn></td>
    </tr>
    <tr>
      <th>Value:</th>
      <td>normal | &lt;length&gt;</td>
    </tr>
    <tr>
      <th>Initial:</th>
      <td>normal</td>
    </tr>
    <tr>
      <th>Applies to:</th>
      <td><a>text content elements</a></td>
    </tr>
    <tr>
      <th>Inherited:</th>
      <td>yes</td>
    </tr>
    <tr>
      <th>Percentages:</th>
      <td>N/A</td>
    </tr>
    <tr>
      <th>Media:</th>
      <td>visual</td>
    </tr>
    <tr>
      <th>Computed&#160;value:</th>
      <td>'normal' or absolute length</td>
    </tr>
    <tr>
      <th><a>Animatable</a>:</th>
      <td>yes</td>
    </tr>
  </table>

  <p>
    This property specifies spacing behavior between text characters.
  </p>

  <p>
    For SVG, if a <span class="prop-value">&lt;length&gt;</span> is
    provided without a unit identifier (e.g., an unqualified number
    such as <span class="attr-value">128</span>), the SVG user agent
    processes the <span class="prop-value">&lt;length&gt;</span> as a
    width value in the current user coordinate system.
  </p>

  <p>
    If a <span class="prop-value">&lt;length&gt;</span> is provided
    with one of the <a href="coords.html#Units">unit identifiers</a>
    (e.g., <span class="attr-value">.25em</span>
    or <span class="attr-value">1%</span>), then the SVG user agent
    converts the <span class="prop-value">&lt;length&gt;</span> into a
    corresponding value in the current user coordinate system by
    applying the rules described
    in <a href="coords.html#Units">Units</a>.
  </p>

  <p class="note">
    Except for any additional information provided in this
    specification, the
    <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/text.html#propdef-letter-spacing">normative
    definition of the property</a> is in CSS 2.1
    ([<a href="refs.html#ref-CSS21">CSS21</a>], section 16.4).
  </p>

<h4 id='TextWordSpacing'>The <span class="property">'word-spacing'</span> property</h4>

  <table class="propdef">
    <tr>
      <th>Name:</th>
      <td><dfn id="WordSpacingProperty">word-spacing</dfn></td>
    </tr>
    <tr>
      <th>Value:</th>
      <td>normal | &lt;length&gt;</td>
    </tr>
    <tr>
      <th>Initial:</th>
      <td>normal</td>
    </tr>
    <tr>
      <th>Applies to:</th>
      <td><a>text content elements</a></td>
    </tr>
    <tr>
      <th>Inherited:</th>
      <td>yes</td>
    </tr>
    <tr>
      <th>Percentages:</th>
      <td>N/A</td>
    </tr>
    <tr>
      <th>Media:</th>
      <td>visual</td>
    </tr>
    <tr>
      <th>Computed&#160;value:</th>
      <td>for 'normal' the value '0'; otherwise the absolute length</td>
    </tr>
    <tr>
      <th><a href="animate.html#Animatable">Animatable</a>:</th>
      <td>yes</td>
    </tr>
  </table>

  <p>
    This property specifies spacing behavior between words. For SVG,
    if a <span class="prop-value">&lt;length&gt;</span> is provided
    without a unit identifier (e.g., an unqualified number such
    as <span class="attr-value">128</span>), the SVG user agent
    processes the <span class="prop-value">&lt;length&gt;</span> as a
    width value in the current user coordinate system.
  </p>

  <p>
    If a <span class="prop-value">&lt;length&gt;</span> is provided
    with one of the <a href="coords.html#Units">unit identifiers</a>
    (e.g., <span class="attr-value">.25em</span> or
    <span class="attr-value">1%</span>), then the SVG user agent
    converts the <span class="prop-value">&lt;length&gt;</span> into a
    corresponding value in the current user coordinate system by
    applying the rules described in <a href="coords.html#Units">Units</a>.
  </p>

  <p class="note">
    Except for any additional information provided in this
    specification, the
    <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/text.html#propdef-word-spacing">normative
    definition of the property</a> is in CSS 2.1
    ([<a href="refs.html#ref-CSS21">CSS21</a>], section 16.4).
  </p>

<h3 id="BaselineAlignmentProperties">Baseline alignment properties</h3>

  <div class="annotation svg2-requirement">
    <table>
      <tr>
	<th>SVG 2 Requirement:</th>
	<td>Align with CSS for baseline alignment functionality.</td>
      </tr>
      <tr>
	<th>Resolution:</th>
	<td><a href="http://www.w3.org/2012/01/13-svg-irc#T03-24-06">SVG 2 will deprecate <span class="property">'baseline-shift'</span> and use <span class="property">'vertical-align'</span> instead.</a></td>
      </tr>
      <tr>
	<th>Purpose:</th>
	<td>To align with CSS.</td>
      </tr>
      <tr>
	<th>Owner:</th>
	<td>Cameron (<a href="http://www.w3.org/Graphics/SVG/WG/track/actions/3281">ACTION-3281</a>)</td>
      </tr>
    </table>
  </div>

  <p class="issue">
    <a href="http://dev.w3.org/csswg/css-inline/#baseline-shift">'baseline-shift'</a>
    is still in CSS Line Layout Module 3. It is important for aligning
    subscripts and superscripts (Inkscape relies on it for this
    purpose).
    <a href="http://dev.w3.org/csswg/css-inline/#vertical-align">'vertical-align'</a>
    is a shorthand for changing multiple properties at once,
    including 'baseline-shift'.
  </p>

  <p>
    An overview of baseline alignment and baseline tables can be
    found above in <a href="text.html#FontsTablesBaselines">Fonts,
      font tables and baselines</a>.
  </p>

  <p>
    One of the characteristics of international text is that there are
    different baselines (different alignment points) for glyphs in
    different scripts. For example, in horizontal writing, ideographic
    scripts, such as Han Ideographs, Katakana, Hiragana, and Hangul,
    alignment occurs with a baseline near the bottoms of the glyphs;
    alphabetic based scripts, such as Latin, Cyrillic, Hebrew, Arabic,
    align a point that is the bottom of most glyphs, but some glyphs
    descend below the baseline; and Indic based scripts are aligned at
    a point that is near the top of the glyphs.
  </p>

  <p>
    When different scripts are mixed on a line of text, an adjustment
    must be made to ensure that the glyphs in the different scripts
    are aligned correctly with one another.  OpenType
    [<a href="http://www.microsoft.com/typography/otspec/">OPENTYPE</a>]
    fonts have a Baseline table (BASE)
    [<a href="http://www.microsoft.com/typography/otspec/base.htm">OPENTYPE-BASETABLE</a>]
    that specifies the offsets of the alternative baselines from the
    current baseline.
  </p>

  <p>
    SVG uses a similar baseline table model that assumes one script
    (at one font-size) is the "dominant run" during processing of
    a <a>'text'</a> element; that is, all other baselines are defined
    in relation to this dominant run.  The baseline of the script with
    the dominant run is called the <dfn>dominant baseline</dfn>. So,
    for example, if the dominant baseline is the alphabetic baseline,
    there will be offsets in the baseline table for the alternate
    baselines, such as the ideographic baseline and the Indic
    baseline. There will also be an offset for the math baseline which
    is used for some math fonts. Note that there are separate baseline
    tables for horizontal and vertical writing-modes. The offsets in
    these tables may be different for horizontal and vertical writing.
  </p>

  <p>
    The baseline table established at the start of processing of
    a <a>'text'</a> element is called the
    <dfn>dominant baseline table</dfn>.
  </p>

  <p>
    Because the value of the <a>'font-family'</a> property is a list
    of fonts, to insure a consistent choice of baseline table we
    define the <em>nominal font</em> in a font list as the first font
    in the list for which a glyph is available. This is the first font
    that could contain a glyph for each character encountered. (For
    this definition, glyph data is assumed to be present if a font
    substitution is made or if the font is synthesized.) This
    definition insures a content independent determination of the font
    and baseline table that is to be used.
  </p>

  <p>
    The value of the <a>'font-size'</a> property on the <a>'text'</a>
    element establishes the <dfn>dominant baseline table font size</dfn>.
  </p>

  <p>
    The model assumes that each glyph has a 'alignment-baseline' value
    which specifies the baseline with which the glyph is to be
    aligned. (The 'alignment-baseline' is called the "Baseline Tag" in
    the OpenType baseline table description.) The initial value of
    the <a>'alignment-baseline'</a> property uses the baseline
    identifier associated with the given glyph.  Alternate values
    for <a>'alignment-baseline'</a> can be useful for glyphs such as a
    "*" which are ambiguous with respect to script membership.
  </p>

  <p>
    The model assumes that the font from which the glyph is drawn also
    has a baseline table, the <dfn>font baseline table</dfn>. This
    baseline table has offsets in units-per-em from the (0,0) point to
    each of the baselines the font knows about. In particular, it has
    the offset from the glyph's (0,0) point to the baseline identified
    by the 'alignment-baseline'.
  </p>

  <p>
    The offset values in the baseline table are in "design units"
    which means fractional units of the EM.  Thus, the
    current <a>'font-size'</a> is used to determine the actual offset
    from the dominant baseline to the alternate baselines.
  </p>

  <p>
    The glyph is aligned so that its baseline identified by its
    'alignment-baseline' is aligned with the baseline with the same
    name from the dominant baseline table.
  </p>

  <p>
    The offset from the dominant baseline of the parent to the
    baseline identified by the 'alignment-baseline' is computed using
    the dominant baseline table and dominant baseline table font
    size. The font baseline table and font size applicable to the
    glyph are used to compute the offset from the identified baseline
    to the (0,0) point of the glyph. This second offset is subtracted
    from the first offset to get the position of the (0,0) point in
    the <a href="text.html#ShiftDirection">shift direction</a>. Both
    offsets are computed by multiplying the baseline value from the
    baseline table times the appropriate font size value.
  </p>

  <p>
    If the 'alignment-baseline' identifies the dominant baseline, then
    the first offset is zero and the glyph is aligned with the
    dominant baseline; otherwise, the glyph is aligned with the chosen
    alternate baseline.
  </p>

  <p>
    The baseline-identifiers below are used in this
    specification. Some of these are determined by baseline-tables
    contained in a font
    <a href="http://www.w3.org/TR/2006/REC-xsl11-20061205/#font-model">as
    described in XSL</a> ([<a href="refs.html#ref-XSL">XSL</a>],
    section 7.9.1).  Others are computed from other font
    characteristics as described below.
  </p>

  <dl>
    <dt><b>alphabetic</b></dt>
    <dd>
      This identifies the baseline used by most alphabetic and
      syllabic scripts. These include, but are not limited to, many
      Western, Southern Indic, Southeast Asian (non-ideographic)
      scripts.
    </dd>
    <dt><b>ideographic</b></dt>
    <dd>
      This identifies the baseline used by ideographic scripts. For
      historical reasons, this baseline is at the bottom of the
      ideographic EM box and not in the center of the ideographic EM
      box. See the "central" baseline. The ideographic scripts include
      Chinese, Japanese, Korean, and Vietnamese Chu Nom.
    </dd>
    <dt><b>hanging</b></dt>
    <dd>
      This identifies the baseline used by certain Indic
      scripts. These scripts include Devanagari, Gurmukhi and Bengali.
    </dd>
    <dt><b>mathematical</b></dt>
    <dd>
      This identifies the baseline used by mathematical symbols.
    </dd>
    <dt><b>central</b></dt>
    <dd>
      This identifies a computed baseline that is at the center of the
      EM box. This baseline lies halfway between the text-before-edge
      and text-after-edge baselines.
      <p class="note">
	For ideographic fonts, this baseline is often used to
	align the glyphs; it is an alternative to the ideographic
	baseline.
      </p>
    </dd>
    <dt><b>middle</b></dt>
    <dd>
      This identifies a baseline that is offset from the alphabetic
      baseline in the <b>shift-direction</b> by 1/2 the value of the
      x-height font characteristic. The position of this baseline may
      be obtained from the font data or, for fonts that have a font
      characteristic for "x-height", it may be computed using 1/2 the
      "x-height". Lacking either of these pieces of information, the
      position of this baseline may be approximated by the "central"
      baseline.
    </dd>
    <dt><b>text-before-edge</b></dt>
    <dd>
      This identifies the before-edge of the EM box. The
      position of this baseline may be specified in the
      baseline-table or it may be calculated.
      <p class="note">
	The position of this baseline is normally around or at the top
	of the ascenders, but it may not encompass all accents that
	can appear above a glyph. For these fonts the value of the
	"ascent" font characteristic is used.  For ideographic fonts,
	the position of this baseline is normally 1 EM in
	the <b>shift-direction</b> from the "ideographic"
	baseline. However, some ideographic fonts have a reduced width
	in the inline-progression-direction to allow tighter
	setting. When such a font, designed only for vertical
	writing-modes, is used in a horizontal writing-mode, the
	"text-before-edge" baseline may be less than 1 EM from the
	text-after-edge.
      </p>
    </dd>
    <dt><b>text-after-edge</b></dt>
    <dd>
      This identifies the after-edge of the EM box. The position of
      this baseline may be specified in the baseline-table or it may
      be calculated.
      <p class="note">
	For fonts with descenders, the position of this
	baseline is normally around or at the bottom of the
	descenders. For these fonts the value of the "descent"
	font characteristic is used. For ideographic fonts, the
	position of this baseline is normally at the
	"ideographic" baseline.
      </p>
    </dd>
  </dl>
  <p>
    There are, in addition, two computed baselines that are only
    defined for line areas. Since SVG does not support the notion
    of computations based on line areas, the two computed baselines
    are mapped as follows:
  </p>
  <dl>
    <dt><b>before-edge</b></dt>
    <dd>For SVG, this is equivalent to <b>text-before-edge</b>.</dd>
    <dt><b>after-edge</b></dt>
    <dd>For SVG, this is equivalent to <b>text-after-edge</b>.</dd>
  </dl>
  <p>
    There are also four baselines that are defined only for
    horizontal writing-modes.
  </p>
  <dl>
    <dt><b>top</b></dt>
    <dd>
      This baseline is the same as the "before-edge" baseline in a
      horizontal writing-mode and is undefined in a vertical writing
      mode.
    </dd>
    <dt id="TextTopBaselineDefinition"><b>text-top</b></dt>
    <dd>
      This baseline is the same as the "text-before-edge" baseline in a
      horizontal writing-mode and is undefined in a vertical writing
      mode.
    </dd>
    <dt><b>bottom</b></dt>
    <dd>
      This baseline is the same as the "after-edge" baseline in a
      horizontal writing-mode and is undefined in a vertical writing
      mode.
    </dd>
    <dt id="TextBottomBaselineDefinition"><b>text-bottom</b></dt>
    <dd>
      This baseline is the same as the "text-after-edge"
      baseline in a horizontal writing-mode and is undefined in a
      vertical writing mode.
    </dd>
  </dl>

<h4 id='DominantBaseline'>The <span class='property'>'dominant-baseline'</span> property</h4>

  <p class="note">
    See the CSS Line Layout Module 3 specification for the definition of
    <a href="http://dev.w3.org/csswg/css-inline/#dominant-baseline-prop">'dominant-baseline'</a>.
    [<a href="refs.html#ref-CSS21">CSSXX</a>]
  </p>

  <table class="propdef">
    <tr>
      <th>Name:</th>
      <td><dfn id="DominantBaselineProperty">dominant-baseline</dfn></td>
    </tr>
    <tr>
      <th>Value:</th>
      <td>auto | use-script | no-change | reset-size |
        ideographic | alphabetic | hanging |
        mathematical | central | middle | text-after-edge |
        text-before-edge</td>
    </tr>
    <tr>
      <th>Initial:</th>
      <td>auto</td>
    </tr>
    <tr>
      <th>Applies to:</th>
      <td><a>text content elements</a></td>
    </tr>
    <tr>
      <th>Inherited:</th>
      <td>no</td>
    </tr>
    <tr>
      <th>Percentages:</th>
      <td>N/A</td>
    </tr>
    <tr>
      <th>Media:</th>
      <td>visual</td>
    </tr>
    <tr>
      <th>Computed&#160;value:</th>
      <td></td>
    </tr>
    <tr>
      <th><a>Animatable</a>:</th>
      <td>yes</td>
    </tr>
  </table>

  <p>
    The "dominant-baseline" property is used to determine or
    re-determine a scaled-baseline-table. A scaled-baseline-table is a
    compound value with three components: a baseline-identifier for
    the dominant-baseline, a baseline-table and a baseline-table
    font-size. Some values of the property re-determine all three
    values; other only re-establish the baseline-table font-size. When
    the initial value, <span class='prop-value'>auto</span>, would
    give an undesired result, this property can be used to explicitly
    set the desire scaled-baseline-table.
  </p>

  <p>
    Values for the property have the following meaning:
  </p>

  <dl>
    <dt><span class="attr-value">auto</span></dt>
    <dd>
      <p>
	If this property occurs on a <a>'text'</a> element, then the
	computed value depends on the value of the
	<a>'writing-mode'</a> property. If the 'writing-mode' is
	horizontal, then the value of the dominant-baseline component
	is 'alphabetic', else if the 'writing-mode' is vertical, then
	the value of the dominant-baseline component is 'central'.
      </p>
      <p>
	If this property occurs on a <a>'tspan'</a>, <a>'tref'</a>,
	<a>'altGlyph'</a> or <a>'textPath'</a> element, then the
	dominant-baseline and the baseline-table components remain the
	same as those of the parent <a>text content element</a>. If
	the computed <a>'baseline-shift'</a> value actually shifts the
	baseline, then the baseline-table font-size component is set
	to the value of the <a>'font-size'</a> property on the element
	on which the <a>'dominant-baseline'</a> property occurs,
	otherwise the baseline-table font-size remains the same as
	that of the element. If there is no parent <a>text content
	element</a>, the scaled-baseline-table value is constructed as
	above for <a>'text'</a> elements.
      </p>
    </dd>

    <dt><span class="attr-value">use-script</span></dt>
    <dd>
      The dominant-baseline and the baseline-table components are set
      by determining the predominant script of the character data
      content. The <a>'writing-mode'</a>, whether horizontal or
      vertical, is used to select the appropriate set of
      baseline-tables and the dominant baseline is used to select the
      baseline-table that corresponds to that baseline.  The
      baseline-table font-size component is set to the value of
      the <a>'font-size'</a> property on the element on which
      the <a>'dominant-baseline'</a> property occurs.
    </dd>

    <dt><span class="attr-value">no-change</span></dt>
    <dd>
      The dominant-baseline, the baseline-table, and the
      baseline-table font-size remain the same as that of the
      parent <a>text content element</a>.
    </dd>

    <dt><span class="attr-value">reset-size</span></dt>
    <dd>
      The dominant-baseline and the baseline-table remain the same,
      but the baseline-table font-size is changed to the value of
      the <a>'font-size'</a> property on this element. This re-scales
      the baseline-table for the current <a>'font-size'</a>.
    </dd>

    <dt><span class="attr-value">ideographic</span></dt>
    <dd>
      The baseline-identifier for the dominant-baseline is set to be
      'ideographic', the derived baseline-table is constructed using
      the 'ideographic' baseline-table in the nominal font, and the
      baseline-table font-size is changed to the value of
      the <a>'font-size'</a> property on this element.
    </dd>

    <dt><span class="attr-value">alphabetic</span></dt>
    <dd>
      The baseline-identifier for the dominant-baseline is set to be
      'alphabetic', the derived baseline-table is constructed using
      the 'alphabetic' baseline-table in the nominal font, and the
      baseline-table font-size is changed to the value of
      the <a>'font-size'</a> property on this element.
    </dd>

    <dt><span class="attr-value">hanging</span></dt>
    <dd>
      The baseline-identifier for the dominant-baseline is set
      to be 'hanging', the derived baseline-table is constructed
      using the 'hanging' baseline-table in the nominal font, and
      the baseline-table font-size is changed to the value of the
      <a>'font-size'</a> property on this element.
    </dd>

    <dt><span class="attr-value">mathematical</span></dt>
    <dd>
      The baseline-identifier for the dominant-baseline is set to be
      'mathematical', the derived baseline-table is constructed using
      the 'mathematical' baseline-table in the nominal font, and the
      baseline-table font-size is changed to the value of
      the <a>'font-size'</a> property on this element.
    </dd>

    <dt><span class="attr-value">central</span></dt>
    <dd>
      The baseline-identifier for the dominant-baseline is set to be
      'central'. The derived baseline-table is constructed from the
      defined baselines in a baseline-table in the nominal font. That
      font baseline-table is chosen using the following priority order
      of baseline-table names: 'ideographic', 'alphabetic', 'hanging',
      'mathematical'. The baseline-table font-size is changed to the
      value of the <a>'font-size'</a> property on this element.
    </dd>

    <dt><span class="attr-value">middle</span></dt>
    <dd>
      The baseline-identifier for the dominant-baseline is set to be
      'middle'. The derived baseline-table is constructed from the
      defined baselines in a baseline-table in the nominal font. That
      font baseline -table is chosen using the following priority
      order of baseline-table names: 'alphabetic', 'ideographic',
      'hanging', 'mathematical'. The baseline-table font-size is
      changed to the value of the <a>'font-size'</a> property on this
      element.
    </dd>

    <dt><span class="attr-value">text-after-edge</span></dt>
    <dd>
      The baseline-identifier for the dominant-baseline is set
      to be 'text-after-edge'. The derived baseline-table is
      constructed from the defined baselines in a baseline-table in
      the nominal font. The choice of which font baseline-table to
      use from the baseline-tables in the nominal font is
      implementation defined. The baseline-table font-size is
      changed to the value of the <a>'font-size'</a> property on this
      element.
      <p class="note">
	Using the following priority order of baseline-table names:
	'alphabetic', 'ideographic', 'hanging', 'mathematical' is
	probably a reasonable strategy for determining which font
	baseline-table to use.
      </p>
    </dd>

    <dt><span class="attr-value">text-before-edge</span></dt>
    <dd>
      The baseline-identifier for the dominant-baseline is set
      to be 'text-before-edge'. The derived baseline-table is
      constructed from the defined baselines in a baseline-table in
      the nominal font. The choice of which baseline-table to use
      from the baseline-tables in the nominal font is
      implementation defined. The baseline-table font-size is
      changed to the value of the <a>'font-size'</a> property on this
      element.
      <p class="note">
	Using the following priority order of baseline-table names:
	'alphabetic', 'ideographic', 'hanging', 'mathematical' is
	probably a reasonable strategy for determining which font
	baseline-table to use.
      </p>
    </dd>
  </dl>

  <p>
    If there is no baseline table in the nominal font or if the
    baseline table lacks an entry for the desired baseline, then the
    user agent may use heuristics to determine the position of the
    desired baseline.
  </p>

<h4 id='AlignmentBaseline'>The <span class='property'>'alignment-baseline'</span> property</h4>

  <p class="note">
    See the CSS Line Layout Module 3 specification for the definition of
    <a href="http://dev.w3.org/csswg/css-inline/#alignment-baseline">'alignment-baseline'</a>.
    [<a href="refs.html#ref-CSS21">CSSXX</a>]
  </p>

  <table class="propdef">
    <tr>
      <th>Name:</th>
      <td><dfn id="AlignmentBaselineProperty">alignment-baseline</dfn></td>
    </tr>
    <tr>
      <th>Value:</th>
      <td>auto | baseline | before-edge | text-before-edge
        | middle | central | after-edge | text-after-edge |
        ideographic | alphabetic | hanging | mathematical</td>
    </tr>
    <tr>
      <th>Initial:</th>
      <td>auto</td>
    </tr>
    <tr>
      <th>Applies to:</th>
      <td><a>'tspan'</a>, <a>'tref'</a>, <a>'altGlyph'</a>, <a>'textPath'</a> elements</td>
    </tr>
    <tr>
      <th>Inherited:</th>
      <td>no</td>
    </tr>
    <tr>
      <th>Percentages:</th>
      <td>N/A</td>
    </tr>
    <tr>
      <th>Media:</th>
      <td>visual</td>
    </tr>
    <tr>
      <th>Computed&#160;value:</th>
      <td></td>
    </tr>
    <tr>
      <th><a>Animatable</a>:</th>
      <td>yes</td>
    </tr>
  </table>

  <p>
    This property specifies how an object is aligned with respect to
    its parent. This property specifies which baseline of this element
    is to be aligned with the corresponding baseline of the
    parent. For example, this allows alphabetic baselines in Roman
    text to stay aligned across font size changes. It defaults to the
    baseline with the same name as the computed value of the
    alignment-baseline property. That is, the position of
    "ideographic" alignment-point in the
    <b>block-progression-direction</b> is the position of the
    "ideographic" baseline in the baseline-table of the object being
    aligned.
  </p>

  <p>
    Values have the following meanings:
  </p>

  <dl>
    <dt><b>auto</b></dt>
    <dd>The value is the dominant-baseline of the script to which
      the character belongs &#x2013; i.e., use the dominant-baseline of
      the parent.</dd>

    <dt><b>baseline</b></dt>
    <dd>The alignment-point of the object being aligned is
      aligned with the dominant-baseline of the parent <a>text content element</a>.</dd>

    <dt><b>before-edge</b></dt>
    <dd>The alignment-point of the object being aligned is
      aligned with the "before-edge" baseline of the parent <a>text content element</a>.</dd>

    <dt><b>text-before-edge</b></dt>
    <dd>The alignment-point of the object being aligned is
      aligned with the "text-before-edge" baseline of the parent <a>text content element</a>.</dd>

    <dt><b>middle</b></dt>
    <dd>The alignment-point of the object being aligned is
      aligned with the "middle" baseline of the parent <a>text content element</a>.</dd>

    <dt><b>central</b></dt>
    <dd>The alignment-point of the object being aligned is
      aligned with the "central" baseline of the parent <a>text content element</a>.</dd>

    <dt><b>after-edge</b></dt>
    <dd>The alignment-point of the object being aligned is
      aligned with the "after-edge" baseline of the parent <a>text content element</a>.</dd>

    <dt><b>text-after-edge</b></dt>
    <dd>The alignment-point of the object being aligned is
      aligned with the "text-after-edge" baseline of the parent <a>text content element</a>.</dd>

    <dt><b>ideographic</b></dt>
    <dd>The alignment-point of the object being aligned is
      aligned with the "ideographic" baseline of the parent <a>text content element</a>.</dd>

    <dt><b>alphabetic</b></dt>
    <dd>The alignment-point of the object being aligned is
      aligned with the "alphabetic" baseline of the parent <a>text content element</a>.</dd>

    <dt><b>hanging</b></dt>
    <dd>The alignment-point of the object being aligned is
      aligned with the "hanging" baseline of the parent <a>text content element</a>.</dd>

    <dt><b>mathematical</b></dt>
    <dd>The alignment-point of the object being aligned is
      aligned with the "mathematical" baseline of the parent <a>text content element</a>.</dd>
  </dl>

<h4 id='BaselineShift'>The <span class='property'>'baseline-shift'</span> property</h4>

  <p class="note">
    See the CSS Line Layout Module 3 specification for the definition of
    <a href="http://dev.w3.org/csswg/css-inline/#baseline-shift">'baseline-shift'</a>.
    [<a href="refs.html#ref-CSS21">CSSXX</a>]
  </p>

  <table class="propdef">
    <tr>
      <th>Name:</th>
      <td><dfn id="BaselineShiftProperty">baseline-shift</dfn></td>
    </tr>
    <tr>
      <th>Value:</th>
      <td>baseline | sub | super
        | <a href="types.html#DataTypePercentage">&lt;percentage&gt;</a>
        | <a href="types.html#DataTypeLength">&lt;length&gt;</a>
      </td>
    </tr>
    <tr>
      <th>Initial:</th>
      <td>baseline</td>
    </tr>
    <tr>
      <th>Applies to:</th>
      <td><a>'tspan'</a>, <a>'tref'</a>, <a>'altGlyph'</a>, <a>'textPath'</a> elements</td>
    </tr>
    <tr>
      <th>Inherited:</th>
      <td>no</td>
    </tr>
    <tr>
      <th>Percentages:</th>
      <td>refers to the "line-height" of the <a>'text'</a> element, which
        in the case of SVG is defined to be equal to the <a>'font-size'</a></td>
    </tr>
    <tr>
      <th>Media:</th>
      <td>visual</td>
    </tr>
    <tr>
      <th>Computed&#160;value:</th>
      <td></td>
    </tr>
    <tr>
      <th><a>Animatable</a>:</th>
      <td>yes</td>
    </tr>
  </table>

  <p>
    The <a>'baseline-shift'</a> property allows repositioning of the
    dominant-baseline relative to the dominant-baseline of the
    parent <a>text content element</a>. The shifted object might be a
    sub- or superscript.  Within the shifted object, the whole
    baseline-table is offset; not just a single baseline. The amount
    of the shift is determined from information from the
    parent <a>text content element</a>, the sub- or superscript offset
    from the nominal font of the parent <a>text content element</a>,
    percent of the "line-height" of the parent <a>text content
    element</a> or an absolute value.
  </p>

  <p>
    In SVG, the <a>'baseline-shift'</a> property represents a
    supplemental adjustment to the baseline tables. The
    <a>'baseline-shift'</a> property shifts the baseline tables for
    each glyph to temporary new positions, for example to lift the
    glyph into superscript or subscript position, but it does not
    effect the current text position. When the current text position
    is adjusted after rendering a glyph to take into account glyph
    advance values, the adjustment happens as if there were no
    baseline shift.
  </p>

  <p>
    <a>'baseline-shift'</a> properties can nest. Each nested
    <a>'baseline-shift'</a> is added to previous baseline shift
    values.
  </p>

  <p>
    Values for the property have the following meaning:
  </p>

  <dl>
    <dt><strong>baseline</strong></dt>
    <dd>
      There is no baseline shift; the dominant-baseline remains in its
      original position.
    </dd>

    <dt><strong>sub</strong></dt>
    <dd>
      The dominant-baseline is shifted to the default position for
      subscripts. The offset to this position is determined using the
      font data for the nominal font. Because in most fonts the
      subscript position is normally given relative to the
      "alphabetic" baseline, the user agent may compute the effective
      position for subscripts for superscripts when some other
      baseline is dominant. The suggested computation is to subtract
      the difference between the position of the dominant baseline and
      the position of the "alphabetic" baseline from the position of
      the subscript. The resulting offset is determined by multiplying
      the effective subscript position by the dominant baseline-table
      font-size. If there is no applicable font data the user agent
      may use heuristics to determine the offset.
    </dd>

    <dt><strong>super</strong></dt>
    <dd>
      The dominant-baseline is shifted to the default position for
      superscripts. The offset to this position is determined using
      the font data for the nominal font. Because in most fonts the
      superscript position is normally given relative to the
      "alphabetic" baseline, the user agent may compute the effective
      position for superscripts when some other baseline is
      dominant. The suggested computation is to subtract the
      difference between the position of the dominant baseline and the
      position of the "alphabetic" baseline from the position of the
      superscript. The resulting offset is determined by multiplying
      the effective superscript position by the dominant
      baseline-table font-size. If there is no applicable font data
      the user agent may use heuristics to determine the offset.
    </dd>

    <dt><strong>&lt;percentage&gt;</strong></dt>
    <dd>
      The computed value of the property is this percentage multiplied
      by the computed "line-height" of the <a>'text'</a> element. The
      dominant-baseline is shifted in the
      <a href="text.html#ShiftDirection">shift direction</a> (positive
      value) or opposite to the
      <a href="text.html#ShiftDirection">shift direction</a>
      (negative value) of the parent <a>text content element</a> by
      the computed value. A value of "0%" is equivalent to
      "baseline".
    </dd>

    <dt><strong>&lt;length&gt;</strong></dt>
    <dd>
      The dominant-baseline is shifted in the
      <a href="text.html#ShiftDirection">shift direction</a> (positive
      value) or opposite to the
      <a href="text.html#ShiftDirection">shift direction</a> (negative
      value) of the parent <a>text content element</a> by the
      &lt;length&gt; value. A value of "0cm" is equivalent to
      "baseline".
    </dd>
  </dl>

<h2 id="TextLayoutPre">Pre-formatted text</h2>

  <p class="note">
    This option corresponds to basic SVG 1.1 text layout.
  </p>

  <p>
    This is the default text layout method and is used in the absence
    of an explicitly defined <a>content area</a>. It is also used as a
    first step in laying out <em>text on a path</em> (with slightly
    modified rules). In this layout method, no automatic line breaking
    or word wrapping is done. Nominally, the text is rendered as a
    single line inside a rectangular <a>content area</a> of infinite
    width and height. Multiple lines of text can be obtained by
    precomputing line breaks and using one of the following methods:
  </p>

  <ul>
    <li>
      Use a single <a>'text'</a> element with <a>'white-space'</a> set
      to <span class="prop-value">pre</span>
      or <span class="prop-value">pre-line</span>. Line spacing is set
      by <a>'line-height'</a>.

      <p class="note">New in SVG 2.</p>
      <p class="issue">In Firefox. Needs to be fully specified.</p>
    </li>

    <li>
      Use a single <a>'text'</a> element with one or more <a>'tspan'</a>
      child elements with appropriate values for attributes
      <a>'tspan/x'</a>, <a>'tspan/y'</a>,
      <a>'tspan/dx'</a> and <a>'tspan/dy'</a> to set new start positions
      for those characters which start new lines.
    </li>

    <li>
      Use multiple <a>'text'</a> elements, one for each line of
      text. (Not recommended as this prevents selection across multiple
      lines of text -- see
      <a href="text.html#TextSelection">Text selection and clipboard
        operations</a>.)
    </li>
  </ul>

  <p class="note">
    The following properties do not apply to <em>pre-formatted</em> text:
    <a>'text-align'</a>, <a>'text-align-last'</a>, <a>'line-break'</a>,
    <a>'word-break'</a>, <a>'hyphens'</a>, <a>'word-wrap'</a>,
    and <a>'overflow-wrap'</a>.
  </p>

<h3 id="TextLayoutPreMultiline">Multi-line text via 'white-space'</h3>

  <p>
    Multi-line pre-formatted text may be created by using the
    <a>'white-space'</a> values <span class="prop-value">pre</span>
    or <span class="prop-value">pre-line</span>. In these cases, a
    line-feed or carriage return is preserved as a <a>forced line
    break</a>. When a renderer encounters a <a>forced line break</a>,
    the <a>current text
    position</a> is set as follows:
  </p>
  <ul>
    <li>
      For horizontal text: <span class="val">x</span> is reset to
      the initial <a>current
      text position</a> while <span class="val">y</span> is
      incremented by the computed value of the <a>'line-height'</a>
      property.
    </li>
    <li>
      For vertical text: <span class="val">y</span> is reset to the
      initial value while <span class="val">x</span> is decremented
      (for right-to-left block-progression-direction) or incremented
      (for left-to-right block-progression-direction) by the computed
      value of <a>'line-height'</a>.
      <p class="issue">
        SVG 1.1 only has right-to-left vertical text but CSS Writing
        Modes Module Level 3 also has left-to-right. This is required
        for Mongolian.
      </p>
    </li>
  </ul>

<h3 id="TextLayoutPreAdjustments">Adjusting Text Chunks</h3>

  <p>
    After text is laid out according to the basic CSS text layout
    rules, glyphs can be repositioned using SVG specific rules. Two
    types of adjustments can be made. The first uses the
    <a>'tspan/x'</a>, <a>'tspan/y'</a>, <a>'tspan/dx'</a>,
    <a>'tspan/dy'</a>, <a>'tspan/rotate'</a> attributes to reposition
    glyphs with in a <a>'tspan'</a>, <a>'tref'</a>, or
    <a>'altGlyph'</a> element. The second uses the
    <a>'text-anchor'</a> property to realign lines of text.
  </p>

<h4 id="TextLayoutPreXY">Repositioning Glyphs</h4>

  <p class="issue">
    Expand on how 'x' and 'y' effect characters.
  </p>

<h4 id="TextAnchoringProperties">Text alignment, the <span class='property'>'text-anchor'</span> property</h4>

  <p>
    The <a>'text-anchor'</a> property is used to align (start-,
    middle- or end-alignment) a string of <em>pre-formatted</em> text
    relative to a given point. It is not applicable to
    <em>auto-wrapped text</em>, see instead <a>'text-align'</a>. For
    multi-line text, the alignment takes place for each line.
  </p>

  <p>
    <span class="issue">This is confusing, perhaps a figure would help:</span>
    The <a>'text-anchor'</a> property is applied to each individual
    <a href="text.html#TextChunks">text chunk</a> within a
    given <a>'text'</a> element. Each text chunk has an initial
    current text position, which represents the point in the user
    coordinate system resulting from (depending on context)
    application of the <a>'text/x'</a> and <a>'text/y'</a> attributes
    on the <a>'text'</a> element, any <a>'tspan/x'</a>
    or <a>'tspan/y'</a> attribute values on a <a>'tspan'</a>,
    <a>'tref'</a> or <a>'altGlyph'</a> element assigned explicitly to
    the first rendered character in a text chunk, or determination of
    the initial current text position for a <a>'textPath'</a> element.
  </p>

  <table class="propdef">
    <tr>
      <th>Name:</th>
      <td><dfn id="TextAnchorProperty">text-anchor</dfn></td>
    </tr>
    <tr>
      <th>Value:</th>
      <td>start | middle | end</td>
    </tr>
    <tr>
      <th>Initial:</th>
      <td>start</td>
    </tr>
    <tr>
      <th>Applies to:</th>
      <td><a>text content elements</a></td>
    </tr>
    <tr>
      <th>Inherited:</th>
      <td>yes</td>
    </tr>
    <tr>
      <th>Percentages:</th>
      <td>N/A</td>
    </tr>
    <tr>
      <th>Media:</th>
      <td>visual</td>
    </tr>
    <tr>
      <th>Computed&#160;value:</th>
      <td>as specified</td>
    </tr>
    <tr>
      <th><a>Animatable</a>:</th>
      <td>yes</td>
    </tr>
  </table>

  <p>
    Values have the following meanings:
  </p>

  <dl>
    <dt><span class="attr-value">start</span></dt>
    <dd>
      The rendered characters are aligned such that the start of the
      resulting rendered text is at the initial current text position.
      For an element with a <a>'direction'</a> property value
      of <span class="prop-value">"ltr"</span> (typical for most
      European languages), the left side of the text is rendered at
      the initial text position.  For an element with a
      <a>'direction'</a> property value of
      <span class="prop-value">"rtl"</span> (typical for Arabic and
      Hebrew), the right side of the text is rendered at the initial
      text position.  For an element with a vertical primary text
      direction (often typical for Asian text), the top side of the
      text is rendered at the initial text position.
    </dd>

    <dt><span class="attr-value">middle</span></dt>
    <dd>
      The rendered characters are aligned such that the geometric
      middle of the resulting rendered text is at the initial current
      text position.
    </dd>

    <dt><span class="attr-value">end</span></dt>
    <dd>
      The rendered characters are aligned such that the end of the
      resulting rendered text is at the initial current text position.
      For an element with a <a>'direction'</a> property value
      of <span class="prop-value">"ltr"</span> (typical for most
      European languages), the right side of the text is rendered at
      the initial text position.  For an element with
      a <a>'direction'</a> property value
      of <span class="prop-value">"rtl"</span> (typical for Arabic and
      Hebrew), the left side of the text is rendered at the initial
      text position.  For an element with a vertical primary text
      direction (often typical for Asian text), the bottom of the text
      is rendered at the initial text position.
    </dd>
  </dl>

  <div class="example">
    <p>An example of using <a>'text-anchor'</a> on multi-line text.</p>

    <pre><![CDATA[
<svg xmlns="http://www.w3.org/2000/svg"
     width="300" height="100" viewBox="0 0 300 100">

  <text x="150" y="30"
        font-family="sans-serif"
	font-size="20px"
	white-space="pre-line"
	text-anchor="middle">This multi-line text
        is anchored to the middle.</text>

</svg>
]]></pre>

    <div class="figure">
      <img class="bordered" src="images/text/text-anchor-middle.svg"
           alt="Image showing two lines of text centered via text-anchor."/>
      <p class="caption">
	Text anchoring is applied independently to each line of text.
      </p>
    </div>
  </div>

<h2 id="TextLayoutAuto">Auto-wrapped text</h2>

  <p>
    Text is automatically wrapped when a <a>content area</a> is
    specified in the <a>'text'</a> element. The <a>content area</a>
    defines the outermost container for wrapping text. A <a>wrapping
    context</a> (set of exclusion areas) may also be given. The
    actual <a>wrapping area</a> is defined by subtracting the
    <a>wrapping context</a> from the <a>content area</a>. The
    <a>wrapping context</a> may also be reduced by the value of the
    <a>'shape-padding'</a> property. The effective area of an
    exclusion may be enlarged by the value of the
    <a>'shape-margin'</a> property.
  </p>

  <p>
    In the case where the <a>content area</a> is defined by the by
    the <a>'text/height'</a> or <a>'text/width'</a> attributes,
    the <a>'tspan/x'</a> and <a>'tspan/y'</a> attributes
    corresponding to the first rendered glyph define the
    initial <a>current text position</a>.  When the <a>content
    area</a> is inside a <a>shape</a>, the initial <a>current text
    position</a> is determined by <span class="issue">FIX ME, FIND
    WHERE IN CSS THIS IS SPECED.</span>.
  </p>

  <p>
    Except when used to determine the initial <a>current text
    position</a>, all values <a>'tspan/x'</a> and <a>'tspan/y'</a>
    are ignored on <a>'text'</a>, <a>'tspan'</a>, and <a>'tref'</a>
    elements.
  </p>

  <p class="note">
    The attributes <a>'text/x'</a> and <a>'text/y'</a> can provide a
    natural fallback mechanism for SVG1.1 renderers for wrapped text.
    <span class="issue">Provide an example (actually, all the example
      SVG's displayed in this section do this).</span>.
  </p>

  <p class="issue">
    How does shape-padding effect text when the content area is defined
    by length or width. I am inclined to allow shape-padding only when
    the content area is defined by an SVG shape.
  </p>


<h3 id="Alignment">Alignment</h3>

<h4 id='TextAlignProperty'>Text alignment: the <span class="property">'text-align'</span> property</h4>

  <p class="note">
    See the CSS Text Module Level 3 specification for the definition
    of <a href="http://dev.w3.org/csswg/css-text/#text-align">'text-align'</a>.
    [<a href="refs.html#ref-CSS21">CSSXX</a>]
  </p>

<h4 id='TextAlignLastProperty'>Last line alignment: the <span class="property">'text-align-last'</span> property</h4>

  <p class="note">
    See the CSS Text Module Level 3 specification for the definition
    of <a href="http://dev.w3.org/csswg/css-text/#text-align-last">'text-align-last'</a>.
    [<a href="refs.html#ref-CSS21">CSSXX</a>]
  </p>

<h3 id="LineBreaking">Line Breaking</h3>

<h4 id="LineBreakProperty">Breaking Rules for Punctuation: the <span class="property">‘line-break’</span> property</h4>
  <p class="note">
    See the CSS Text Module Level 3 specification for the definition
    of <a href="http://dev.w3.org/csswg/css-text/#line-break">'line-break'</a>.
    [<a href="refs.html#ref-CSS21">CSSXX</a>]
  </p>

<h4 id="WordBreakProperty">Breaking Rules for Letters: the <span class="property">‘word-break’</span> property</h4> 
  <p class="note">
    See the CSS Text Module Level 3 specification for the definition
    of <a href="http://dev.w3.org/csswg/css-text/#word-break">'word-break'</a>.
    [<a href="refs.html#ref-CSS21">CSSXX</a>]
  </p>

<h4 id="HyphensProperty">Hyphenation Control: the <span class="property">‘hyphens’</span> property</h4>
  <p class="note">
    See the CSS Text Module Level 3 specification for the definition
    of <a href="http://dev.w3.org/csswg/css-text/#hyphens">'hyphens'</a>.
    [<a href="refs.html#ref-CSS21">CSSXX</a>]
  </p>

<h4 id="WordWrapProperty">Overflow Wrapping: the <span class="property">‘word-wrap’</span> and <span class="property">‘overflow-wrap’</span> properties</h4>
  <p class="note">
    See the CSS Text Module Level 3 specification for the definition
    of <a href="http://dev.w3.org/csswg/css-text/#word-wrap">'word-wrap'</a>.
    [<a href="refs.html#ref-CSS21">CSSXX</a>]
  </p>
  <p class="note" id="OverflowWrapProperty">
    See the CSS Text Module Level 3 specification for the definition
    of <a href="http://dev.w3.org/csswg/css-text/#overflow-wrap">'overflow-wrap'</a>.
    [<a href="refs.html#ref-CSS21">CSSXX</a>]
  </p>


<h3 id="EdgeEffects">Edge Effects</h3>

<h4 id="TextIndentProperty">First Line Indentation: the <span class="property">‘text-indent’</span> property</h4>
  <p class="note">
    See the CSS Text Module Level 3 specification for the definition
    of <a href="http://dev.w3.org/csswg/css-text/#text-indent">'text-indent'</a>.
    [<a href="refs.html#ref-CSS21">CSSXX</a>]
  </p>
  <p class="issue">
    This property might also be useful for preformatted text.
  </p>

<h4 id="HangingPunctuationProperty">Hanging Punctuation: the <span class="property">‘hanging-punctuation’</span> property</h4>
  <p class="note">
    See the CSS Text Module Level 3 specification for the definition
    of <a href="http://dev.w3.org/csswg/css-text/#hanging-punctuation-property">'hanging-punctuation'</a>.
    [<a href="refs.html#ref-CSS21">CSSXX</a>]
  </p>
  <p class="issue">
    This property might also be useful for preformatted text.
    It is marked in the CSS spec as at risk.
  </p>

<h2 id="TextLayoutPath">Text on a path</h2>

<edit:with element='textPath'>

  <p>
    In addition to text drawn in a straight line, SVG also includes
    the ability to place text so that it follows the path in
    a <a>'path'</a> element.  To specify that a block of text is to be
    rendered along the shape of a <a>'path'</a>, include the given
    text within a <a>'textPath'</a> element which includes
    an <a>'xlink:href'</a> attribute with an <a>IRI reference</a> to
    a <a>'path'</a> element, or a <a>'d'</a> attribute that specifies
    the path data directly.
  </p>

  <p>
    Text on a path is conceptional like a single line
    of <a href="text.html#TextLayoutPre">pre-formatted</a> text that
    is then transformed to follow the path. Except as indicated, all
    the properties that apply to pre-formatted text apply to text on a
    path.
  </p>

<h3 id="TextPathElement">The <span class="element-name">'textPath'</span> element</h3>

  <edit:elementsummary name='textPath'/>

  <div class="annotation svg2-requirement">
    <table>
      <tr>
	<th>SVG 2 Requirement:</th>
	<td>Have a more precise explanation of text path stretch methods.</td>
      </tr>
      <tr>
	<th>Resolution:</th>
	<td><a href="http://www.w3.org/2011/11/17-svg-irc#T22-23-10">We will clarify <span class='attr-value'>method="stretch"</span> on <span class="element-name">>'textPath'</span> elements.</a></td>
      </tr>
      <tr>
	<th>Purpose:</th>
	<td>Improve interoperability of the feature.</td>
      </tr>
      <tr>
	<th>Owner:</th>
	<td>Cameron (no action)</td>
      </tr>
    </table>
  </div>

<h3 id="TextPathAttributes">Attributes</h3>

  <dl class="attrdef-list-svg2">

    <dt id="TextPathElementStartOffsetAttribute"><span class="adef">startOffset</span></dt>
    <dd>
      <p>
        An offset from the start of the path for the initial current
        text position, calculated using the user agent's
	<a href="paths.html#DistanceAlongAPath">distance along the
        path</a> algorithm.
      </p>
      <p>
        If a <a href="types.html#DataTypeLength">&lt;length&gt;</a>
        other than a percentage is given, then the
	<a>'startOffset'</a> represents a distance along the path
        measured in the current user coordinate system.<br />  If a
        percentage is given, then the <a>'startOffset'</a> represents
        a percentage distance along the entire path. Thus,
	<span class="attr-value">startOffset="0%"</span> indicates the
        start point of the path and
        <span class="attr-value">startOffset="100%"</span> indicates
        the end point of the path.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="types.html#DataTypeLengths">&lt;length&gt;</a></dd>
	<dt><a>Lacuna value</a></dt>  <dd>0</dd>
	<dt><a>Animatable</a></dt>    <dd>yes</dd>
      </dl>

    </dd>

    <dt id="TextPathElementMethodAttribute"><span class="adef">method</span></dt>
    <dd>
      <p>
	Indicates the method by which text should be rendered
        along the path.
      </p>
      <p>
        A value of <span class="attr-value">align</span> indicates
        that the glyphs should be rendered using simple 2x3
        transformations such that there is no stretching/warping of
        the glyphs. Typically, supplemental rotation, scaling and
        translation transformations are done for each glyph to be
        rendered. As a result, with
        <span class="attr-value">align</span>, fonts where the glyphs
        are designed to be connected (e.g., cursive fonts), the
        connections may not align properly when text is rendered along
        a path.
      </p>
      <p>
        A value of <span class="attr-value">stretch</span> indicates
        that the glyph outlines will be converted into paths, and then
        all end points and control points will be adjusted to be along
        the perpendicular vectors from the path, thereby stretching
        and possibly warping the glyphs.  With this approach,
        connected glyphs, such as in cursive scripts, will maintain
        their connections.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd>align | stretch</dd>
	<dt><a>Lacuna value</a></dt>  <dd>align</dd>
	<dt><a>Animatable</a></dt>    <dd>yes</dd>
      </dl>

    </dd>

    <dt id="TextPathElementSpacingAttribute"><span class="adef">spacing</span></dt>
    <dd>
      <p>
        Indicates how the user agent should determine the
        spacing between glyphs that are to be rendered along a
        path.
      </p>
      <p>
        A value of <span class="attr-value">exact</span> indicates
        that the glyphs should be rendered exactly according to the
        spacing rules as specified in
        <a href="text.html#TextpathLayoutRules">Text on a path layout
        rules</a>.
      </p>
      <p>
        A value of <span class="attr-value">auto</span> indicates that
        the user agent should use text-on-a-path layout algorithms to
        adjust the spacing between glyphs in order to achieve visually
        appealing results.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd>auto | exact</dd>
	<dt><a>Lacuna value</a></dt>  <dd>align</dd>
	<dt><a>Animatable</a></dt>    <dd>yes</dd>
      </dl>

    </dd>

    <dt id="TextPathElementDAttribute"><span class="adef">d</span></dt>
    <dd>
      <p>
        The definition of the path onto which the glyphs will be
        rendered.  The handling of erroneous path data follows the
        behavior specified in the
        <a href="implnote.html#PathElementImplementationNotes"><span class="element-name">'path'</span>
        element implementation notes</a>.
      </p>
      <p>
        If both the <a>'d'</a> attribute and <a>'xlink:href'</a>
        attributes are specified, it is as if the <a>'xlink:href'</a>
        attribute were not specified for the purposes of rendering.
        In the <a>SVGTextPathElement</a> interface both values will
        still be reflected.  Furthermore, if a value
        for <a>'xlink:href'</a> is specified in markup and path data
        is subsequently specified via the
        <a>SVGAnimatedPathData::pathSegList</a> member of the
        <a>SVGTextPathElement</a>, then this is equivalent to specifying the
        <a>'d'</a> attribute&#x2014;the <a>'xlink:href'</a> will be disregarded
        for rendering and the path specified in the
        <a>SVGAnimatedPathData::pathSegList</a> will be used instead.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="paths.html#PathData"><em>path data</em></a></dd>
	<dt><a>Lacuna value</a></dt>  <dd>See above.</dd>
	<dt><a>Animatable</a></dt>    <dd>yes</dd>
      </dl>

    </dd>

    <dt id="TextPathElementHrefAttribute"><span class="adef">xlink:href</span></dt>
    <dd>
      <p>
        An <a href="linking.html#IRIReference">IRI reference</a> to
        the <a>'path'</a> element onto which the glyphs will be
        rendered. If &lt;iri&gt; is an invalid reference (e.g., no
        such element exists, or the referenced element is not
        a <a>'path'</a>), then the <a>'textPath'</a> element is in
        error and its entire contents shall not be rendered by the
        user agent.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="types.html#DataTypeIRI">&lt;iri&gt;</a></dd>
	<dt><a>Lacuna value</a></dt>  <dd>See above.</dd>
	<dt><a>Animatable</a></dt>    <dd>yes</dd>
      </dl>

    </dd>

  </dl>

  <p>
    The path data coordinates within the referenced <a>'path'</a>
    element are assumed to be in the same coordinate system as the
    current <a>'text'</a> element, not in the coordinate system where
    the <a>'path'</a> element is defined. The <a>'transform'</a>
    attribute on the referenced <a>'path'</a> element represents a
    supplemental transformation relative to the current user
    coordinate system for the current <a>'text'</a> element, including
    any adjustments to the current user coordinate system due to a
    possible <a>'transform'</a> property on the current <a>'text'</a>
    element.  For example, the following fragment of SVG content:
  </p>

  <pre>
&lt;svg xmlns="http://www.w3.org/2000/svg" 
     xmlns:xlink="http://www.w3.org/1999/xlink"&gt;
  &lt;g <span
style="font-weight:bold; color:red">transform="translate(25,25)"</span>&gt;
    &lt;defs&gt;
      &lt;path id="path1" <span
style="font-weight:bold; color:green">transform="scale(2)"</span> d="..." fill="none" stroke="red"/&gt;
    &lt;/defs&gt;
  &lt;/g&gt;
  &lt;text <span
style="font-weight:bold; color:blue">transform="rotate(45)"</span>&gt;
    &lt;textPath xlink:href="#path1"&gt;Text on a path1&lt;/textPath&gt;
  &lt;/text&gt;
&lt;/svg&gt;
  </pre>

  <p>
    should have the same effect as the following:
  </p>

  <pre>
&lt;svg xmlns="http://www.w3.org/2000/svg" 
     xmlns:xlink="http://www.w3.org/1999/xlink"&gt;
  &lt;g <span
style="font-weight:bold; color:blue">transform="rotate(45)"</span>&gt;
    &lt;defs&gt;
      &lt;path id="path1" <span
style="font-weight:bold; color:green">transform="scale(2)"</span> d="..." fill="none" stroke="red"/&gt;
    &lt;/defs&gt;
    &lt;text&gt;
      &lt;textPath xlink:href="#path1"&gt;Text on a path1&lt;/textPath&gt;
    &lt;/text&gt;
  &lt;/g&gt;
&lt;/svg&gt;
  </pre>

  <p>
    Note that the <code style="font-weight:bold;
    color:red">transform="translate(25,25)"</code> has no effect on
    the <a>'textPath'</a> element, whereas the
    <code style="font-weight:bold;
    color:blue">transform="rotate(45)"</code> applies to both
    the <a>'text'</a> and the use of the <a>'path'</a> element as the
    referenced shape for text on a path.
  </p>

  <p id="ExampleToap01">
    <span class="example-ref">Example toap01</span> provides a
    simple example of text on a path:
  </p>

  <edit:example href='images/text/toap01.svg' name='toap01' description="simple text on a path" image='yes' link='yes'/>

  <p id="ExampleToap02">
    <span class="example-ref">Example toap02</span> shows
    how <a>'tspan'</a> elements can be included
    within <a>'textPath'</a> elements to adjust styling attributes and
    adjust the current text position before rendering a particular
    glyph. The first occurrence of the word "up" is filled with the
    color red.  Attribute <a>'tspan/dy'</a> is used to lift the word
    "up" from the baseline.
  </p>

  <edit:example href='images/text/toap02.svg' name='toap02' description="tspan within textPath" image='yes' link='yes'/>

  <p id="ExampleToap03">
    <span class="example-ref">Example toap03</span> demonstrates the
    use of the <a>'startOffset'</a> attribute on the <a>'textPath'</a>
    element to specify the start position of the text string as a
    particular position along the path. Notice that glyphs that fall
    off the end of the path are not rendered
    (see <a href="text.html#TextpathLayoutRules">text on a path layout
    rules</a>).
  </p>

  <edit:example href='images/text/toap03.svg' name='toap03' description="text on a path with startOffset attribute" image='yes' link='yes'/>

<h3 id="TextpathLayoutRules">Text on a path layout rules</h3>

  <p>
    Conceptually, for text on a path the target path is stretched out
    into either a horizontal or vertical straight line segment. For
    horizontal text layout flows, the path is stretched out into a
    hypothetical horizontal line segment such that the start of the
    path is mapped to the left of the line segment. For vertical text
    layout flows, the path is stretched out into a hypothetical
    vertical line segment such that the start of the path is mapped to
    the top of the line segment. The standard
    <a href="text.html#TextLayout">text layout</a> rules are
    applied to the hypothetical straight line segment and the result
    is mapped back onto the target path. Vertical and
    bidirectional <a href="text.html#TextLayout">text layout</a> rules
    also apply to text on a path.
  </p>
  <p>
    The <a href="text.html#ReferenceOrientation">reference
    orientation</a> is determined individually for each glyph that is
    rendered along the path. For horizontal text layout flows, the
    reference orientation for a given glyph is the vector that starts
    at the intersection point on the path to which the glyph is
    attached and which points in the direction 90 degrees
    counter-clockwise from the angle of the curve at the intersection
    point. For vertical text layout flows, the reference orientation
    for a given glyph is the vector that starts at the intersection
    point on the path to which the glyph is attached and which points
    in the direction 180 degrees from the angle of the curve at the
    intersection point.
  </p>

  <p id="ExampleToap04">
    <span class="example-ref">Example toap04</span> will be used
    to illustrate the particular layout rules for text on a path
    that supplement the basic <a href="text.html#TextLayout">text
      layout</a> rules for straight line horizontal or vertical
    text.
  </p>

  <edit:example href='images/text/toap04.svg' name='toap04' description="text on a path layout rules" image='yes' link='yes'/>

  <p>
    The following picture does an initial zoom in on the first glyph
    in the <a>'text'</a> element.
  </p>

  <img alt="Image that shows text
	    on a path" src="images/text/toap05.png" width="288" height="91" />

  <p>
    The small dot above shows the point at which the glyph is attached
    to the path. The box around the glyph shows the glyph is rotated
    such that its horizontal axis is parallel to the tangent of the
    curve at the point at which the glyph is attached to the path. The
    box also shows the glyph's <dfn id="CharWidth">charwidth</dfn>
    (i.e., the amount which the current text position advances
    horizontally when the glyph is drawn using horizontal text
    layout).
  </p>

  <p>
    The next picture zooms in further to demonstrate the detailed
    layout rules.
  </p>

  <img alt="Image that shows text on a path"
       src="images/text/toap06.png" width="288" height="176" /> 

  <p>
    For left-to-right horizontal text layout along a path (i.e.,
    when the glyph orientation is perpendicular to the
    <a href="text.html#SettingInlineProgressionDirection">inline-progression-direction</a>),
    the layout rules are as follows:
  </p>

  <ul>
    <li>
      Determine the
      <dfn id="StartPointOnPath">startpoint-on-the-path</dfn> for the
      first glyph using attribute <a>'startOffset'</a> and property
      <a>'text-anchor'</a>. For <span class='prop-value'>text-anchor:start</span>,
      startpoint-on-the-path is the point on the path which represents
      the point on the path which is <a>'startOffset'</a> distance
      along the path from the start of the path, calculated using the
      user agent's <a href="paths.html#DistanceAlongAPath">distance
      along the path</a> algorithm.

      For <span class="prop-value">text-anchor:middle</span>,
      startpoint-on-the-path is the point on the path which represents
      the point on the path which is [ <a>'startOffset'</a> minus half
      of the total advance values for all of the glyphs in
      the <a>'textPath'</a> element ] distance along the path from the
      start of the path, calculated using the user
      agent's <a href="paths.html#DistanceAlongAPath">distance along
      the path</a> algorithm.

      For <span class="prop-value">text-anchor:end</span>,
      startpoint-on-the-path is the point on the path which represents
      the point on the path which is [ <a>'startOffset'</a> minus the
      total advance values for all of the glyphs in
      the <a>'textPath'</a> element ]. Before rendering the first
      glyph, the horizontal component of the startpoint-on-the-path is
      adjusted to take into account various horizontal alignment text
      properties and attributes, such as a <a>'tspan/dx'</a> attribute
      value on a <a>'tspan'</a> element. (In the picture above, the
      startpoint-on-the-path is the leftmost dot on the path.)
    </li>

    <li>
      Determine the glyph's charwidth (i.e., the amount which
      the current text position advances horizontally when the
      glyph is drawn using horizontal text layout). (In the picture
      above, the charwidth is the distance between the two dots at
      the side of the box.)
    </li>

    <li>
      Determine the point on the curve which is charwidth
      distance along the path from the startpoint-on-the-path for
      this glyph, calculated using the user agent's
      <a href="paths.html#DistanceAlongAPath">distance along the
      path</a> algorithm. This point is the
      <dfn id="EndPointOnPath">endpoint-on-the-path</dfn> for the
      glyph. (In the picture above, the endpoint-on-the-path for the
      glyph is the rightmost dot on the path.)
    </li>

    <li>
      Determine the
      <dfn id="MidPointOnPath">midpoint-on-the-path</dfn>, which is
      the point on the path which is "halfway" (user agents can choose
      either a distance calculation or a parametric calculation)
      between the startpoint-on-the-path and the
      endpoint-on-the-path. (In the picture above, the
      midpoint-on-the-path is shown as a white dot.)
    </li>

    <li>
      Determine the <dfn id="GlyphMidline">glyph-midline</dfn>, which
      is the vertical line in the glyph's coordinate system that goes
      through the glyph's x-axis midpoint. (In the picture above, the
      glyph-midline is shown as a dashed line.)
    </li>

    <li>
      Position the glyph such that the glyph-midline passes
      through the midpoint-on-the-path and is perpendicular to the
      line through the startpoint-on-the-path and the
      endpoint-on-the-path.
    </li>

    <li>
      Align the glyph vertically relative to the midpoint-on-the-path
      based on property <a>'alignment-baseline'</a> and any specified
      values for attribute <a>'tspan/dy'</a> on a <a>'tspan'</a>
      element. In the example above, the <a>'alignment-baseline'</a>
      property is unspecified, so the initial value
      of <span class="prop-value">alignment-baseline:baseline</span>
      will be used. There are no <a>'tspan'</a> elements; thus, the
      baseline of the glyph is aligned to the
      midpoint-on-the-path.
    </li>

    <li>
      For each subsequent glyph, set a new startpoint-on-the-path as
      the previous endpoint-on-the-path, but with appropriate
      adjustments taking into account horizontal kerning tables in the
      font and current values of various attributes and properties,
      including <a href="text.html#SpacingProperties">spacing
      properties</a> and <a>'tspan'</a> elements with values provided
      for attributes <a>'tspan/dx'</a> and <a>'tspan/dy'</a>. All
      adjustments are calculated as distance adjustments along the
      path, calculated using the user
      agent's <a href="paths.html#DistanceAlongAPath">distance along
      the path</a> algorithm.
    </li>

    <li>
      Glyphs whose midpoint-on-the-path are off either end of the path
      are not rendered.
    </li>

    <li>
      Continue rendering glyphs until there are no more glyphs.
    </li>
  </ul>

  <p>
    Comparable rules are used for top-to-bottom vertical text
    layout along a path (i.e., when the glyph orientation is
    parallel with the
    <a href="text.html#SettingInlineProgressionDirection">inline-progression-direction</a>),
    the layout rules are as follows:
  </p>

  <ul>
    <li>
      Determine the startpoint-on-the-path using the same method as
      for horizontal text layout along a path, except that before
      rendering the first glyph, the horizontal component of the
      startpoint-on-the-path is adjusted to take into account various
      vertical alignment text properties and attributes, such as
      a <a>'tspan/dy'</a> attribute value on a <a>'tspan'</a> element.
    </li>

    <li>
      Determine the glyph's charheight (i.e., the amount which
      the current text position advances vertically when the glyph
      is drawn using vertical text layout).
    </li>

    <li>
      Determine the point on the curve which is charheight
      distance along the path from the startpoint-on-the-path for
      this glyph, calculated using the user agent's
      <a href="paths.html#DistanceAlongAPath">distance along the
      path</a> algorithm. This point is the endpoint-on-the-path for
      the glyph.
    </li>

    <li>
      Determine the midpoint-on-the-path, which is the point on the
      path which is "halfway" (user agents can choose either a
      distance calculation or a parametric calculation) between the
      startpoint-on-the-path and the endpoint-on-the-path.
    </li>

    <li>
      Determine the glyph-midline, which is the horizontal line in the
      glyph's coordinate system that goes through the glyph's y-axis
      midpoint.
    </li>

    <li>
      Position the glyph such that the glyph-midline passes through
      the midpoint-on-the-path and is perpendicular to the line
      through the startpoint-on-the-path and the endpoint-on-the-path.
    </li>

    <li>
      Align the glyph horizontally (where horizontal is relative to
      the glyph's coordinate system) relative to the
      midpoint-on-the-path based on
      property <a>'alignment-baseline'</a> and any specified values
      for attribute <a>'tspan/dx'</a> on a <a>'tspan'</a> element.
    </li>

    <li>
      For each subsequent glyph, set a new startpoint-on-the-path as
      the previous endpoint-on-the-path, but with appropriate
      adjustments taking into account vertical kerning tables in the
      font and current values of various attributes and properties,
      including <a href="text.html#SpacingProperties">spacing
      properties</a> and <a>'tspan'</a> elements with values provided
      for attributes <a>'tspan/dx'</a> and <a>'tspan/dy'</a>. All
      adjustments are calculated as distance adjustments along the
      path, calculated using the user agent's
      <a href="paths.html#DistanceAlongAPath">distance along
      the path</a> algorithm.
    </li>

    <li>
      Glyphs whose midpoint-on-the-path are off either end of
      the path are not rendered.
    </li>

    <li>
      Continue rendering glyphs until there are no more
      glyphs.
    </li>
  </ul>

  <p>
    In the calculations above, if either the startpoint-on-the-path or
    the endpoint-on-the-path is off the end of the path, then extend
    the path beyond its end points with a straight line that is
    parallel to the tangent at the path at its end point so that the
    midpoint-on-the-path can still be calculated.
  </p>

  <p>
    When the
    <a href="text.html#SettingInlineProgressionDirection">inline-progression-direction</a>
    is horizontal, then any <span class="attr-name">'x'</span>
    attributes on <a>'text'</a>, <a>'tspan'</a>, <a>'tref'</a>
    or <a>'altGlyph'</a> elements represent new absolute offsets along
    the path, thus providing explicit new values for
    startpoint-on-the-path. Any <span class="attr-name">'y'</span>
    attributes on <a>'text'</a>, <a>'tspan'</a>, <a>'tref'</a>
    or <a>'altGlyph'</a> elements are ignored. When the
    <a href="text.html#SettingInlineProgressionDirection">inline-progression-direction</a>
    is vertical, then any <span class="attr-name">'y'</span>
    attributes on <a>'text'</a>, <a>'tspan'</a>, <a>'tref'</a>
    or <a>'altGlyph'</a> elements represent new absolute offsets along
    the path, thus providing explicit new values for
    startpoint-on-the-path. Any <span class="attr-name">'x'</span>
    attributes on <a>'text'</a>, <a>'tspan'</a>, <a>'tref'</a> or
    <a>'altGlyph'</a> elements are ignored.
  </p>

</edit:with>

<h2 id="TextRenderingOrder">Text rendering order</h2>

  <p>
    The glyphs associated with the characters within a <a>'text'</a>
    element are rendered in the logical order of the characters in the
    original document, independent of any re-ordering necessary to
    implement bidirectionality. Thus, for text that goes right-to-left
    visually, the glyphs associated with the rightmost character are
    rendered before the glyphs associated with the other characters.
  </p>

  <p>
    Additionally, each distinct glyph is rendered in its entirety
    (i.e., it is filled and stroked as specified by the <a>'fill'</a>
    and <a>'stroke'</a> properties) before the next glyph gets
    rendered.
  </p>

<h3 id='TextOverflowProcessing'>Text overflow processing:
  the <span class="property">'text-overflow'</span> property</h3>

  <div class="annotation svg2-requirement">
    <table>
      <tr>
	<th>SVG 2 Requirement:</th>
	<td>Add <a>'text-overflow'</a> functionality.</td>
      </tr>
      <tr>
	<th>Resolution:</th>
	<td><a href="http://www.w3.org/2011/03/03-svg-minutes.html#item04">We will add text-overflow in SVG 2.</a></td>
      </tr>
      <tr>
	<th>Purpose:</th>
	<td>To align with CSS, allow indicating that not all text is shown.</td>
      </tr>
      <tr>
	<th>Owner:</th>
	<td>Erik (<a href="http://www.w3.org/Graphics/SVG/WG/track/actions/3003">ACTION-3003</a>)</td>
      </tr>
    </table>
  </div>

  <p class="note">
    New in SVG 2.

    Added to allow user agents to handle text strings that overflow a
    predefined region in a more useful way.  Aligns SVG and HTML/CSS
    text processing.
  </p>

  <p class="note">
    See the CSS3 UI specification for the definition of
    of <a href="http://www.w3.org/TR/2012/WD-css3-ui-20120117/#text-overflow">'text-overflow'</a>.
    [<a href="refs.html#ref-CSS3UI">CSS3UI</a>]
  </p>

  <p>
    SVG uses the <a>'text-overflow'</a> property to control
    how <a>text content block elements</a> render when the text
    overflows a specified region. In the case of wrapped text, the
    region is the <a>wrapping area</a>. In the case of text on a path,
    a region is determined by the path length. Pre-formatted text does
    not create a region.
  </p>

  <p>
    When applied to a <a>text content block element</a>
    setting <a>'text-overflow'</a> to
    <span class="attr-value">ellipsis</span> then if the text that is
    to be rendered overflows the specified region an ellipsis is
    rendered such that it fits within the given region. For the
    purposes of rendering, the ellipsis is treated as if it replaced
    the characters at the point where it is inserted.

    <!--The text positioning attributes
    (<a>'text/x'</a>, <a>'text/y'</a>, <a>'text/dx'</a>, <a>'text/dy'</a>, <a>'text/rotate'</a>)
    apply to the ellipsis as if it was one character in the logical
    document order mapping to one glyph.-->

    In SVG <a>'text-overflow'</a> has an effect if there is a validly
    specified region, regardless of the computed value of
    the <a>'overflow'</a> property on the <a>text content block
    element</a>.
  </p>

  <p>
    Any other value for <a>'text-overflow'</a> is treated as if it
    wasn't specified.
  </p>

  <p class="issue">
    SVG could allow the keyword 'clip' to work too. It's already
    possible to do clipping with clip-path, but it's unconditional,
    where this would theoretically only clip if the text
    overflowed. It's mostly a convenient shorthand.
  </p>

  <p>
    Note that the effect of <a>'text-overflow'</a> is purely visual,
    the ellipsis itself does not become part of the DOM.  For all the
    DOM methods it's as if <a>'text-overflow'</a> wasn't applied, and
    as if <a>'text/width'</a> didn't constrain the text.
  </p>

  <p class="issue">Need updated example.</p>
  <div class="example">
    <p>
      The following example shows the use of <a>'text-overflow'</a>. 
      The top line shows text as it would normally be rendered, without any width restriction.
      The middle line shows text with text-overflow=clip specified, and the bottom line shows
      text with text-overflow=ellipsis.
    </p>

    <pre><![CDATA[
<svg xmlns="http://www.w3.org/2000/svg"
     width="180" height="120" viewBox="0 0 180 120">
  <style>
    text { font: 16px sans-serif; }
    rect { fill: none; stroke: black; vector-effect: non-scaling-stroke; stroke-width: 1; }
  </style>

  <g>
    <rect x="19.5" y="16.5" width="100" height="20"/>
    <text x="20" y="2em" width="100">SVG is awesome</text>
  </g>

  <g transform="translate(0,30)">
    <rect x="19.5" y="16.5" width="100" height="20"/>
    <text x="20" y="2em" width="100" text-overflow="clip">SVG is awesome</text>
  </g>

  <g transform="translate(0,60)">
    <rect x="19.5" y="16.5" width="100" height="20"/>
    <text x="20" y="2em" width="100" text-overflow="ellipsis">SVG is awesome</text>
  </g>
</svg>
]]></pre>

    <div class="figure">
      <img class="bordered" src="images/text/text-overflow-ref.svg"
           alt="Image showing the use of the text-overflow property."/>
      <p class="caption">The <a>'text-overflow'</a> property used on
      text elements, the bottom line showing text with an ellipsis
      applied.</p>
    </div>
  </div>

  <p class="issue">It has been argued that this property is useless. It
    would be of more use if coupled with a mechanism that would expose
    the hidden text (tool-tip on hovering over ellipses?).
  </p>

<h2 id="FontPropertiesUsedBySVG">Font selection properties</h2>

  <p>
    SVG uses the following font specification properties. Except for
    any additional information provided in this specification, the
    <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/fonts.html">normative
    definition of these properties</a> is in CSS 2.1
    ([<a href="refs.html#ref-CSS21">CSS21</a>], chapter 15).  Any
    SVG-specific notes about these properties are contained in the
    descriptions below.
  </p>
  <p class="issue">Update to <a "href=http://www.w3.org/TR/css3-fonts/#font-rend-props>"CSS
  Font Module Level 3</a>. Note that 'font-variant' is completely reworked.</p>

<h3 id="FontFamily">The <span class="property">'font-family'</span> property</h3>

  <table class="propdef">
    <tr>
      <th>Name:</th>
      <td><dfn id="FontFamilyProperty">font-family</dfn></td>
    </tr>
    <tr>
      <th>Value:</th>
      <td>[[ &lt;family-name&gt; |<br />
        &lt;generic-family&gt; ],]* [&lt;family-name&gt;
        |<br />
        &lt;generic-family&gt;]</td>
    </tr>
    <tr>
      <th>Initial:</th>
      <td>depends on user agent</td>
    </tr>
    <tr>
      <th>Applies to:</th>
      <td><a>text content elements</a></td>
    </tr>
    <tr>
      <th>Inherited:</th>
      <td>yes</td>
    </tr>
    <tr>
      <th>Percentages:</th>
      <td>N/A</td>
    </tr>
    <tr>
      <th>Media:</th>
      <td>visual</td>
    </tr>
    <tr>
      <th>Computed&#160;value:</th>
      <td></td>
    </tr>
    <tr>
      <th><a>Animatable</a>:</th>
      <td>yes</td>
    </tr>
  </table>

  <p>
    This property indicates which font family is to be used to render
    the text, specified as a prioritized list of font family names
    and/or generic family names.  Unless the family name corresponds
    to a CSS IDENT, it must be quoted.  Except for any additional
    information provided in this specification, the
    <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/fonts.html#propdef-font-family">normative
    definition of the property</a> is in CSS 2.1
    ([<a href="refs.html#ref-CSS21">CSS21</a>], section 15.3).
  </p>

<h3 id="FontStyle">The <span class="property">'font-style'</span>property</h3>

  <table class="propdef">
    <tr>
      <th>Name:</th>
      <td><dfn id="FontStyleProperty">font-style</dfn></td>
    </tr>
    <tr>
      <th>Value:</th>
      <td>normal | italic | oblique</td>
    </tr>
    <tr>
      <th>Initial:</th>
      <td>normal</td>
    </tr>
    <tr>
      <th>Applies to:</th>
      <td><a>text content elements</a></td>
    </tr>
    <tr>
      <th>Inherited:</th>
      <td>yes</td>
    </tr>
    <tr>
      <th>Percentages:</th>
      <td>N/A</td>
    </tr>
    <tr>
      <th>Media:</th>
      <td>visual</td>
    </tr>
    <tr>
      <th>Computed&#160;value:</th>
      <td></td>
    </tr>
    <tr>
      <th><a>Animatable</a>:</th>
      <td>yes</td>
    </tr>
  </table>

  <p>
    This property specifies whether the text is to be rendered using a
    normal, italic or oblique face. Except for any additional
    information provided in this specification, the
    <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/fonts.html#propdef-font-style">normative
    definition of the property</a> is in CSS 2.1
    ([<a href="refs.html#ref-CSS21">CSS21</a>], section 15.4).
  </p>

<h3 id="FontVariant">The <span class="property">'font-variant'</span> property</h3>

  <table class="propdef">
    <tr>
      <th>Name:</th>
      <td><dfn id="FontVariantProperty">font-variant</dfn></td>
    </tr>
    <tr>
      <th>Value:</th>
      <td>normal | small-caps</td>
    </tr>
    <tr>
      <th>Initial:</th>
      <td>normal</td>
    </tr>
    <tr>
      <th>Applies to:</th>
      <td><a>text content elements</a></td>
    </tr>
    <tr>
      <th>Inherited:</th>
      <td>yes</td>
    </tr>
    <tr>
      <th>Percentages:</th>
      <td>N/A</td>
    </tr>
    <tr>
      <th>Media:</th>
      <td>visual</td>
    </tr>
    <tr>
      <th>Computed&#160;value:</th>
      <td></td>
    </tr>
    <tr>
      <th><a>Animatable</a>:</th>
      <td>yes</td>
    </tr>
  </table>

  <p>
    This property indicates whether the text is to be rendered using
    the normal glyphs for lowercase characters or using small-caps
    glyphs for lowercase characters. Except for any additional
    information provided in this specification, the
    <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/fonts.html#propdef-font-variant">normative
    definition of the property</a> is in CSS 2.1
    ([<a href="refs.html#ref-CSS21">CSS21</a>], section 15.5).
  </p>

<h3 id="FontWeight">The <span class="property">'font-weight'</span> property</h3>

  <table class="propdef">
    <tr>
      <th>Name:</th>
      <td><dfn id="FontWeightProperty">font-weight</dfn></td>
    </tr>
    <tr>
      <th>Value:</th>
      <td>normal | bold | bolder | lighter | 100 | 200 |
        300<br />
        | 400 | 500 | 600 | 700 | 800 | 900</td>
    </tr>
    <tr>
      <th>Initial:</th>
      <td>normal</td>
    </tr>
    <tr>
      <th>Applies to:</th>
      <td><a>text content elements</a></td>
    </tr>
    <tr>
      <th>Inherited:</th>
      <td>yes</td>
    </tr>
    <tr>
      <th>Percentages:</th>
      <td>N/A</td>
    </tr>
    <tr>
      <th>Media:</th>
      <td>visual</td>
    </tr>
    <tr>
      <th>Computed&#160;value:</th>
      <td></td>
    </tr>
    <tr>
      <th><a>Animatable</a>:</th>
      <td>yes</td>
    </tr>
  </table>

  <p>
    This property refers to the boldness or lightness of the glyphs
    used to render the text, relative to other fonts in the same font
    family. Except for any additional information provided in this
    specification, the
    <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/fonts.html#propdef-font-weight">normative
    definition of the property</a> is in CSS 2.1
    ([<a href="refs.html#ref-CSS21">CSS21</a>], section 15.6).
  </p>

<h3 id="FontStretch">The <span class="property">'font-stretch'</span> property</h3>

  <table class="propdef">
    <tr>
      <th>Name:</th>
      <td><dfn id="FontStretchProperty">font-stretch</dfn></td>
    </tr>
    <tr>
      <th>Value:</th>
      <td>normal | wider | narrower |<br />
        ultra-condensed | extra-condensed |<br />
        condensed | semi-condensed |<br />
        semi-expanded | expanded |<br />
        extra-expanded | ultra-expanded</td>
    </tr>
    <tr>
      <th>Initial:</th>
      <td>normal</td>
    </tr>
    <tr>
      <th>Applies to:</th>
      <td><a>text content elements</a></td>
    </tr>
    <tr>
      <th>Inherited:</th>
      <td>yes</td>
    </tr>
    <tr>
      <th>Percentages:</th>
      <td>N/A</td>
    </tr>
    <tr>
      <th>Media:</th>
      <td>visual</td>
    </tr>
    <tr>
      <th>Computed&#160;value:</th>
      <td></td>
    </tr>
    <tr>
      <th><a>Animatable</a>:</th>
      <td>yes</td>
    </tr>
  </table>

  <p>
    This property indicates the desired amount of condensing or
    expansion in the glyphs used to render the text. Except for any
    additional information provided in this specification, the
    <a href="http://www.w3.org/TR/2011/WD-css3-fonts-20111004/#font-stretch-prop">normative
    definition of the property</a> is in CSS3 Fonts
    ([<a href="refs.html#ref-CSS3FONTS">CSS3FONTS</a>], section 3.3).
  </p>

<h3 id="FontSize">The <span class="property">'font-size'</span> property</h3>

  <table class="propdef">
    <tr>
      <th>Name:</th>
      <td><dfn id="FontSizeProperty">font-size</dfn></td>
    </tr>
    <tr>
      <th>Value:</th>
      <td>&lt;absolute-size&gt; | &lt;relative-size&gt;
        |<br />
        &lt;length&gt; | &lt;percentage&gt;</td>
    </tr>
    <tr>
      <th>Initial:</th>
      <td>medium</td>
    </tr>
    <tr>
      <th>Applies to:</th>
      <td><a>text content elements</a></td>
    </tr>
    <tr>
      <th>Inherited:</th>
      <td>yes, the computed value is inherited</td>
    </tr>
    <tr>
      <th>Percentages:</th>
      <td>refer to parent element's font size</td>
    </tr>
    <tr>
      <th>Media:</th>
      <td>visual</td>
    </tr>
    <tr>
      <th>Computed&#160;value:</th>
      <td></td>
    </tr>
    <tr>
      <th><a>Animatable</a>:</th>
      <td>yes</td>
    </tr>
  </table>

  <p>
    This property refers to the size of the font from baseline to
    baseline when multiple lines of text are set solid in a multi-line
    layout environment. For SVG, if a
    <span class="prop-value">&lt;length&gt;</span> is provided without
    a unit identifier (e.g., an unqualified number such as
    <span class="attr-value">128</span>), the SVG user agent processes
    the <span class="prop-value">&lt;length&gt;</span> as a height
    value in the current user coordinate system.
  </p>

  <p>
    If a <span class="prop-value">&lt;length&gt;</span> is provided
    with one of the <a href="coords.html#Units">unit identifiers</a>
    (e.g., <span class="attr-value">12pt</span>
    or <span class="attr-value">10%</span>), then the SVG user agent
    converts the <span class="prop-value">&lt;length&gt;</span> into a
    corresponding value in the current user coordinate system by
    applying the rules described in
    <a href="coords.html#Units">Units</a>.
  </p>

  <p>
    Except for any additional information provided in this
    specification, the
    <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/fonts.html#propdef-font-size">normative
    definition of the property</a> is in CSS 2.1
    ([<a href="refs.html#ref-CSS21">CSS21</a>], section 15.7).
  </p>

<h3 id="FontSizeAdjust">The <span class="property">'font-size-adjust'</span> property</h3>

  <table class="propdef">
    <tr>
      <th>Name:</th>
      <td><dfn id="FontSizeAdjustProperty">font-size-adjust</dfn></td>
    </tr>
    <tr>
      <th>Value:</th>
      <td>&lt;number&gt; | none</td>
    </tr>
    <tr>
      <th>Initial:</th>
      <td>none</td>
    </tr>
    <tr>
      <th>Applies to:</th>
      <td><a>text content elements</a></td>
    </tr>
    <tr>
      <th>Inherited:</th>
      <td>yes</td>
    </tr>
    <tr>
      <th>Percentages:</th>
      <td>N/A</td>
    </tr>
    <tr>
      <th>Media:</th>
      <td>visual</td>
    </tr>
    <tr>
      <th>Computed&#160;value:</th>
      <td></td>
    </tr>
    <tr>
      <th><a>Animatable</a>:</th>
      <td>yes</td>
    </tr>
  </table>

  <p>
    This property allows authors to specify an aspect value for an
    element that will preserve the x-height of the first choice font
    in a substitute font. Except for any additional information
    provided in this specification, the
    <a href="http://www.w3.org/TR/2011/WD-css3-fonts-20111004/#propdef-font-size-adjust">normative
    definition of the property</a> is in CSS3 Fonts
    ([<a href="refs.html#ref-CSS3FONTS">CSS3FONTS</a>], section 3.6).
  </p>

<h3 id="FontShorthand">The <span class="property">'font'</span> property</h3>

  <table class="propdef">
    <tr>
      <th>Name:</th>
      <td><dfn id="FontProperty">font</dfn></td>
    </tr>
    <tr>
      <th>Value:</th>
      <td>[ [ <span
		 class="propinst-font-style">&lt;'font-style'&gt;</span>
        || <span
              class="propinst-font-variant">&lt;'font-variant'&gt;</span>
        || <span
              class="propinst-font-weight">&lt;'font-weight'&gt;</span>
        ]?<br />
        &lt;'font-size'&gt; [ / &lt;'line-height'&gt; ]?
        &lt;'font-family'&gt; ] |<br />
        caption | icon | menu | message-box |<br />
        small-caption | status-bar</td>
    </tr>
    <tr>
      <th>Initial:</th>
      <td>see individual properties</td>
    </tr>
    <tr>
      <th>Applies to:</th>
      <td><a>text content elements</a></td>
    </tr>
    <tr>
      <th>Inherited:</th>
      <td>yes</td>
    </tr>
    <tr>
      <th>Percentages:</th>
      <td>allowed on 'font-size' and 'line-height' (Note:
        for the purposes of processing the <a>'font property'</a> property in
        SVG, 'line-height' is assumed to be equal the value
        for property <a>'font-size'</a>)</td>
    </tr>
    <tr>
      <th>Media:</th>
      <td>visual</td>
    </tr>
    <tr>
      <th>Computed&#160;value:</th>
      <td></td>
    </tr>
    <tr>
      <th><a>Animatable</a>:</th>
      <td>yes (non-additive)</td>
    </tr>
  </table>

  <p>
    Shorthand property for setting <a>'font-style'</a>,
    <a>'font-variant'</a>, <a>'font-weight'</a>, <a>'font-size'</a>,
    <span class='property'>'line-height'</span> and
    <a>'font-family'</a>. The <span class='property'>'line-height'</span>
    property has no effect on text layout in SVG.  For the purposes of
    the <a>'font property'</a> property,
    <span class='property'>'line-height'</span> is assumed to be equal
    to the value of the <a>'font-size'</a> property.
    <a href="conform.html#ConformingSVGViewers">Conforming SVG
    Viewers</a> are not required to support the various system font
    options (caption, icon, menu, message-box, small-caption and
    status-bar) and can use a system font or one of the generic fonts
    instead.
  </p>

  <p>
    Except for any additional information provided in this
    specification, the
    <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/fonts.html#propdef-font">normative
    definition of the property</a> is in CSS 2.1
    ([<a href="refs.html#ref-CSS21">CSS21</a>], section 15.8).
  </p>

<h2 id="TextDecorationProperties">Text decoration</h2>

<h3 id="TextDecoration">The <span class="property">'text-decoration'</span> property</h3>

  <p class="issue">Do we align with CSS Text Decoration Module Level 3?</p>

  <table class="propdef">
    <tr>
      <th>Name:</th>
      <td><dfn id="TextDecorationProperty">text-decoration</dfn></td>
    </tr>
    <tr>
      <th>Value:</th>
      <td>none | [ underline || overline || line-through ||
        blink ]</td>
    </tr>
    <tr>
      <th>Initial:</th>
      <td>none</td>
    </tr>
    <tr>
      <th>Applies to:</th>
      <td><a>text content elements</a></td>
    </tr>
    <tr>
      <th>Inherited:</th>
      <td>no (see prose)</td>
    </tr>
    <tr>
      <th>Percentages:</th>
      <td>N/A</td>
    </tr>
    <tr>
      <th>Media:</th>
      <td>visual</td>
    </tr>
    <tr>
      <th>Computed&#160;value:</th>
      <td></td>
    </tr>
    <tr>
      <th><a>Animatable</a>:</th>
      <td>yes</td>
    </tr>
  </table>

  <p>
    This property describes decorations that are added to the text of
    an element. <a href="conform.html#ConformingSVGViewers">Conforming
    SVG Viewers</a> are not required to support the
    <strong>blink</strong> value.
  </p>

  <p>
    Except for any additional information provided in this
    specification, the
    <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/text.html#propdef-text-decoration">normative
    definition of the property</a> is in CSS 2.1
    ([<a href="refs.html#ref-CSS21">CSS21</a>], section 16.3.1).
  </p>

  <p>
    The CSS 2.1 specification defines the behavior of
    the <a>'text-decoration'</a> property using the terminology
    "block-level elements" and "inline elements". For the purposes of
    the <a>'text-decoration'</a> property and SVG, a
    <a>'text'</a> element represents a block-level element and any of
    the potential children of a <a>'text'</a> element (e.g., a
    <a>'tspan'</a>) represent inline elements.
  </p>

  <p>
    Also, the CSS 2.1 definition of <a>'text-decoration'</a> specifies
    that the "color of the decorations" remain the same on descendant
    elements. Since SVG offers a painting model consisting of the
    ability to apply various types of paint
    (see <a href="painting.html">Painting: Filling, Stroking and
    Marker Symbols</a>) to both the interior (i.e., the "fill") and
    the outline (i.e., the "stroke") of text, for SVG
    the <a>'text-decoration'</a> property is defined such that, for an
    element which has a specified value for the
    <a>'text-decoration'</a> property, all decorations on its content
    and that of its descendants are rendered using the same fill and
    stroke properties as are present on the given element. If
    the <a>'text-decoration'</a> property is specified on a
    descendant, then that overrides the ancestor.
  </p>

  <p>
    Because SVG allows text to be both filled and stroked,
    drawing order matters in some circumstances with text
    decorations. Text decoration drawing order should be as
    follows:
  </p>
  <ul>
    <li>
      All text decorations except line-through should be drawn
      before the text is filled and stroked; thus, the text is
      rendered on top of these decorations.
    </li>
    <li>
      Line-through should be drawn after the text is filled and
      stroked; thus, the line-through is rendered on top of the
      text.
    </li>
  </ul>

  <p id="ExampleTextDecoration01">
    <span class="example-ref">Example textdecoration01</span> provides
    examples for <a>'text-decoration'</a>. The first line of text has
    no value for <a>'text-decoration'</a>, so the initial value
    of <span class="prop-value">text-decoration:none</span> is
    used. The second line shows
    <span class="prop-value">text-decoration:line-through</span>. The
    third line shows
    <span class="prop-value">text-decoration:underline</span>. The
    fourth line illustrates the rule whereby decorations are rendered
    using the same fill and stroke properties as are present on the
    element for which the <a>'text-decoration'</a> is specified. Since
    <a>'text-decoration'</a> is specified on the <a>'text'</a>
    element, all text within the <a>'text'</a> element has its
    underline rendered with the same fill and stroke properties as
    exist on the <a>'text'</a> element (i.e., blue fill, red stroke),
    even though the various words have different fill and stroke
    property values. However, the word "different" explicitly
    specifies a value for <a>'text-decoration'</a>; thus, its
    underline is rendered using the fill and stroke properties as
    the <a>'tspan'</a> element that surrounds the word "different"
    (i.e., yellow fill, darkgreen stroke):
  </p>

  <edit:example href='images/text/textdecoration01.svg' name='textdecoration01' description="behavior of 'text-decoration' property" image='yes' link='yes'/>

<h2 id="AlternateGlyphs">Alternate glyphs</h2>

  <p>
    There are situations such as ligatures, special-purpose fonts
    (e.g., a font for music symbols) or alternate glyphs for Asian
    text strings where it is required that a different set of glyphs
    is used than the glyph(s) which normally corresponds to the given
    character data.
  </p>

<h3 id="AltGlyphElement">The <span class="element-name">'altGlyph'</span> element</h3>

<edit:with element='altGlyph'>

  <p>
    The <a>'altGlyph'</a> element provides control over the glyphs
    used to render particular character data.
  </p>

  <edit:elementsummary name='altGlyph'/>

<h4 id="AltGlyphAttributes">Attributes</h4>

  <dl class="attrdef-list-svg2">
    <dt id="AltGlyphElementHrefAttribute"><span class="adef">xlink:href</span></dt>
    <dd>

      <p>
	An <a href="linking.html#IRIReference">IRI reference</a>
        to an <a>'altGlyphDef'</a> element.
      </p>
      <p>
        If an appropriate set of alternate glyphs is located from
        processing the <a>'altGlyphDef'</a> element, then those
        alternate glyphs are rendered instead of the character(s) that
        are inside of the <a>'altGlyph'</a> element.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="types.html#DataTypeIRI">&lt;iri&gt;</a></dd>
	<dt><a>Lacuna value</a></dt>  <dd></dd>
	<dt><a>Animatable</a></dt>    <dd>no</dd>
      </dl>

    </dd>

    <dt id="AltGlyphElementGlyphRefAttribute"><span class="adef">glyphRef</span></dt>
    <dd>
      <p>
	The glyph identifier, the format of which is dependent on
	the <a>'format'</a> of the given font. (Same meaning as
	the <a>'glyphRef/glyphRef'</a> attribute on the
	<a>'glyphRef element'</a> element.)
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd>&lt;string&gt;</dd>
	<dt><a>Lacuna value</a></dt>  <dd></dd>
	<dt><a>Animatable</a></dt>    <dd>no</dd>
      </dl>

    </dd>

    <dt id="AltGlyphElementFormatAttribute"><span class="adef">format</span></dt>
    <dd>
      <p>
	The format of the given font. If the font is
	in <a href="http://www.w3.org/TR/2008/REC-CSS2-20080411/fonts.html#referencing">one
	of the formats listed in CSS2</a>, such as <em>TrueDoc™
	Portable Font Resource</em> or <em>Embedded OpenType</em>,
	then the &lt;string&gt; must contain the corresponding font
	format string, such as <em>truedoc-pfr</em> or
	<em>embedded-opentype</em>. (This attribute has the same meaning
	as the <a>'glyphRef/format'</a> attribute on the <a>'glyphRef
	  element'</a> element.)
	<span class="issue">This refers to CSS 2; it needs to be
	  reviewed against the formats described by CSS3 Fonts.</span>
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd>&lt;string&gt;</dd>
	<dt><a>Lacuna value</a></dt>  <dd>undefined</dd>
	<dt><a>Animatable</a></dt>    <dd>no</dd>
      </dl>

    </dd>

    <dt id="AltGlyphElementXAttribute"><span class="adef">x</span></dt>
    <dd>
      <p>
	The <a href="types.html#DataTypeLength">&lt;length&gt;</a>
	values are processed in the same manner as
	the <a>'tspan/x'</a> attribute on the <a>'tspan'</a> element,
	with the following exception: If the referenced alternate
	glyphs are rendered instead of the Unicode characters inside
	the <a>'altGlyph'</a> element, then any absolute X coordinates
	specified via an <a>'x'</a> attribute on this element or any
	ancestor <a>'text'</a> or <a>'tspan'</a> elements for Unicode
	characters 2 through <var>n</var> within the <a>'altGlyph'</a>
	element are ignored.  Any absolute X coordinate specified via
	an <a>'x'</a> attribute on this element or any
	ancestor <a>'text'</a> or <a>'tspan'</a> elements for the
	first Unicode character within the <a>'altGlyph'</a> element
	sets a new absolute X coordinate for the <a >current text
	position</a> before rendering the first alternate glyph.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="types.html#DataTypeLengths">&lt;list-of-coordinates&gt;</a></dd>
	<dt><a>Lacuna value</a></dt>  <dd>0</dd>
	<dt><a>Animatable</a></dt>    <dd>yes</dd>
      </dl>

    </dd>

    <dt id="AltGlyphElementYAttribute"><span class="adef">y</span></dt>
    <dd>
      <p>
	The corresponding absolute Y coordinates for rendering
	the <a>'altGlyph'</a> element.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="types.html#DataTypeLengths">&lt;list-of-coordinates&gt;</a></dd>
	<dt><a>Lacuna value</a></dt>  <dd>0</dd>
	<dt><a>Animatable</a></dt>    <dd>yes</dd>
      </dl>

    </dd>

    <dt id="AltGlyphElementDXAttribute"><span class="adef">dx</span></dt>
    <dd>
      <p>
	The <a href="types.html#DataTypeLength">&lt;length&gt;</a>
	values are processed in the same manner as the <a>'tspan/dx'</a>
	attribute on the <a>'tspan'</a> element, with the following
	exception: If the referenced alternate glyphs are rendered
	instead of the Unicode characters inside the <a>'altGlyph'</a>
	element, then any relative X coordinates specified via
	an <a>'dx'</a> attribute on this element or any ancestor
	<a>'text'</a> or <a>'tspan'</a> elements for Unicode characters
	2 through <var>n</var> within the <a>'altGlyph'</a> element are
	ignored.  Any relative X coordinate specified via an <a>'dx'</a>
	attribute on this element or any ancestor <a>'text'</a>
	or <a>'tspan'</a> elements for the first Unicode character
	within the <a>'altGlyph'</a> element sets a new relative X
	coordinate for the <a >current text position</a> before
	rendering the first alternate glyph.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="types.html#DataTypeLengths">&lt;list-of-lengths&gt;</a></dd>
	<dt><a>Lacuna value</a></dt>  <dd>See above.</dd>
	<dt><a>Animatable</a></dt>    <dd>yes</dd>
      </dl>

    </dd>

    <dt id="AltGlyphElementDYAttribute"><span class="adef">dy</span></dt>
    <dd>
      <p>
	The corresponding relative Y coordinates for rendering
	the <a>'altGlyph'</a> element.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="types.html#DataTypeLengths">&lt;list-of-lengths&gt;</a></dd>
	<dt><a>Lacuna value</a></dt>  <dd>See above.</dd>
	<dt><a>Animatable</a></dt>    <dd>yes</dd>
      </dl>

    </dd>

    <dt id="AltGlyphElementRotateAttribute"><span class="adef">rotate</span> = "<span class="attr-value"></span>"</dt>
    <dd>
      <p>
	The <a href="types.html#DataTypeNumber">&lt;number&gt;</a>
	values are processed in the same manner as
	the <a>'tspan/rotate'</a> attribute on the <a>'tspan'</a>
	element, with the following exception: If the referenced
	alternate glyphs are rendered instead of the Unicode characters
	inside the <a>'altGlyph'</a> element, then any supplemental
	rotation values specified via an
	<a>'rotate'</a> attribute on this element or any ancestor
	<a>'text'</a> or <a>'tspan'</a> elements for Unicode characters
	2 through <var>n</var> within the <a>'altGlyph'</a> element are
	ignored.  Supplemental rotation values specified via
	an <a>'rotate'</a> attribute on this element or any
	ancestor <a>'text'</a> or <a>'tspan'</a> elements for the first
	Unicode character within the <a>'altGlyph'</a> element sets a
	new supplemental rotation angle before rendering the alternate
	glyphs.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="types.html#DataTypeNumbers">&lt;list-of-numbers&gt;</a></dd>
	<dt><a>Lacuna value</a></dt>  <dd>See above.</dd>
	<dt><a>Animatable</a></dt>    <dd>yes (non-additive)</dd>
      </dl>

    </dd>

  </dl>

  <p>
    If the references to alternate glyphs do not result in successful
    identification of alternate glyphs to use, then the character(s)
    that are inside of the <a>'altGlyph'</a> element are rendered as
    if the <a>'altGlyph'</a> element were a <a>'tspan'</a> element
    instead.</p> <p>An <a>'altGlyph'</a> element references
    an <a>'altGlyphDef'</a> element via its
    <a>'xlink:href'</a> attribute or identifies a glyph by means of
    <a href="text.html#FontPropertiesUsedBySVG">font selection
    properties</a>, a glyph identifier and a font format. If
    the <a>'xlink:href'</a> attribute is specified, it takes
    precedence, and the other glyph identification attributes and
    properties are ignored.</p>

</edit:with>

<h3 id="AlternateGlyphDefinitions">The <span class="element-name">'altGlyphDef'</span>,
<span class="element-name">'altGlyphItem'</span> and
<span class="element-name">'glyphRef'</span> elements</h3>

  <p id="AltGlyphDefElement">
    The <a>'altGlyphDef'</a> element defines a set of possible glyph
    substitutions.
  </p>

  <edit:elementsummary name='altGlyphDef'/>

  <p>
    An <a>'altGlyphDef'</a> can contain either of the following:
  </p>

  <ul>
    <li>
      In the simplest case, an <a>'altGlyphDef'</a> contains one or
      more <a>'glyphRef'</a> elements. Each <a>'glyphRef'</a> element
      references a single glyph within a particular font. If all of
      the referenced glyphs are available, then these glyphs are
      rendered instead of the character(s) inside of the referencing
      <a>'altGlyph'</a> element. If any of the referenced glyphs are
      unavailable, then the character(s) that are inside of the
      <a>'altGlyph'</a> element are rendered as if there were not
      an <a>'altGlyph'</a> element surrounding those characters.
    </li>

    <li>
      In the more complex case, an <a>'altGlyphDef'</a> contains one
      or more <a>'altGlyphItem'</a> elements. Each
      <a>'altGlyphItem'</a> represents a candidate set of substitute
      glyphs. Each <a>'altGlyphItem'</a> contains one or more
      <a>'glyphRef'</a> elements. Each <a>'glyphRef'</a> element
      references a single glyph within a particular font. The
      first <a>'altGlyphItem'</a> in which all referenced glyphs are
      available is chosen. The glyphs referenced from
      this <a>'altGlyphItem'</a> are rendered instead of the
      character(s) that are inside of the referencing
      <a>'altGlyph'</a> element. If none of the <a>'altGlyphItem'</a>
      elements result in a successful match (i.e., none of
      the <a>'altGlyphItem'</a> elements has all of its referenced
      glyphs available), then the character(s) that are inside of
      the <a>'altGlyph'</a> element are rendered as if there were not
      an <a>'altGlyph'</a> element surrounding those characters.
    </li>
  </ul>

  <p id="AltGlyphItemElement">
    The <a>'altGlyphItem'</a> element defines a candidate set of
    possible glyph substitutions. The first <a>'altGlyphItem'</a>
    element whose referenced glyphs are all available is chosen. Its
    glyphs are rendered instead of the character(s) that are inside of
    the referencing <a>'altGlyph'</a> element.
  </p>

  <edit:elementsummary name='altGlyphItem'/>

<edit:with element='glyphRef'>

  <p id="GlyphRefElement">
    The <a>'glyphRef element'</a> element defines a possible glyph to
    use.
  </p>

  <edit:elementsummary name='glyphRef'/>

<h4 id="GlyphRefAttributes">Attributes</h4>

  <dl class="attrdef-list-svg2">
    <dt id="GlyphRefElementGlyphRefAttribute"><span class="adef">glyphRef</span></dt>
    <dd>
      <p>
	The glyph identifier, the format of which is dependent on
        the <a>'format'</a> of the given font.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd>&lt;string&gt;</dd>
	<dt><a>Lacuna value</a></dt>  <dd></dd>
	<dt><a>Animatable</a></dt>    <dd>no</dd>
      </dl>

    </dd>

    <dt id="GlyphRefElementFormatAttribute"><span class="adef">format</span></dt>
    <dd>
      <p>
	The format of the given font. If the font is in
        <a href="http://www.w3.org/TR/2008/REC-CSS2-20080411/fonts.html#referencing">one
        of the formats listed in CSS2</a>, such as <em>TrueDoc™
        Portable Font Resource</em> or <em>Embedded OpenType</em>,
        then the &lt;string&gt; must contain the corresponding font
        format string, such as <em>truedoc-pfr</em> or
        <em>embedded-opentype</em>. <span class="issue">This refers to
	CSS 2; it needs to be reviewed against the formats described
	by CSS3 Fonts.</span>
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd>&lt;string&gt;</dd>
	<dt><a>Lacuna value</a></dt>  <dd>undefined</dd>
	<dt><a>Animatable</a></dt>    <dd>no</dd>
      </dl>

    </dd>

    <dt id="GlyphRefElementXAttribute"><span class="adef">x</span></dt>
    <dd>
      <p>
	This value represents the new absolute X coordinate within the
        font's coordinate system for this glyph.
      </p>
      <p>
        The font coordinate system is based on the <em>em square</em>
        model described in the
        <a href="http://www.w3.org/TR/2008/REC-CSS2-20080411/fonts.html">Fonts
        chapter</a> of CSS2. <span class='issue'>CSS3 Fonts doesn't
        talk about the em square much.</span>
      </p>
      <p>
        If the attribute is not specified, for the first <a>'glyphRef
        element'</a> child element, the effect is as if the attribute
        were set to "0", whereas for subsequent <a>'glyphRef
        element'</a> child elements, the effect is as if the attribute
        were set to the end X coordinate from the previous
	<a>'glyphRef element'</a> element.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="types.html#DataTypeNumber">&lt;number&gt;</a></dd>
	<dt><a>Lacuna value</a></dt>  <dd>See above.</dd>
	<dt><a>Animatable</a></dt>    <dd>No</dd>
      </dl>

    </dd>

    <dt id="GlyphRefElementYAttribute"><span class="adef">y</span></dt>
    <dd>
      <p>
	The corresponding new absolute Y coordinate within the font's
        coordinate system for this glyph.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="types.html#DataTypeNumber">&lt;number&gt;</a></dd>
	<dt><a>Lacuna value</a></dt>  <dd>See above.</dd>
	<dt><a>Animatable</a></dt>    <dd>No</dd>
      </dl>

    </dd>

    <dt id="GlyphRefElementDXAttribute"><span class="adef">dx</span></dt>
    <dd>
      <p>
	This value represents the relative X coordinate within the
	font's coordinate system for this glyph. The glyph is thus
	shifted by <span class="attr-value">&lt;number&gt;</span>
	units along the positive X axis within the font's coordinate
	system supplemental to the absolute X coordinate established
	by the <a>'x'</a> attribute (either due to an
	explicit <a>'x'</a> attribute or due to default value
	processing for the <a>'x'</a> attribute).
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="types.html#DataTypeNumber">&lt;number&gt;</a></dd>
	<dt><a>Lacuna value</a></dt>  <dd>0</dd>
	<dt><a>Animatable</a></dt>    <dd>No</dd>
      </dl>

    </dd>

    <dt id="GlyphRefElementDYAttribute"><span class="adef">dy</span></dt>
    <dd>
      <p>
	The corresponding number of units within the font's coordinate
	system to shift the glyph along the positive Y axis relative
	to the absolute Y coordinate established by the <a>'y'</a>
	attribute.
      </p>

      <dl class="attrdef-svg2">
	<dt>Value</dt>                <dd><a href="types.html#DataTypeNumber">&lt;number&gt;</a></dd>
	<dt><a>Lacuna value</a></dt>  <dd>0</dd>
	<dt><a>Animatable</a></dt>    <dd>No</dd>
      </dl>

    </dd>
  </dl>

  <p>
    A <a>'glyphRef element'</a> identifies a glyph by means
    of <a href="text.html#FontPropertiesUsedBySVG">font selection
    properties</a>, a glyph identifier and a font format. If
    insufficient attributes and properties have been specified to
    identify a glyph, then the <a>'glyphRef element'</a> is processed
    in the same manner as when a glyph reference is fully specified,
    but the given glyph is not available. If the <a>'xlink:href'</a>
    attribute is specified, it takes precedence, and the other glyph
    identification attributes and properties are ignored.
  </p>

</edit:with>

<h2 id="TextSelection">Text selection and clipboard operations</h2>

  <p>
    <a href="conform.html#ConformingSVGViewers">Conforming SVG
    viewers</a> on systems which have the capacity for text selection (e.g.,
    systems which are equipped with a pointer device such as a mouse) and
    which have system clipboards for copy/paste operations are required to
    support:
  </p>

  <ul>
    <li>user selection of text strings in SVG content</li>
    <li>the ability to copy selected text strings to the system clipboard</li>
  </ul>

  <p>
    A text selection operation starts when all of the following occur:
  </p>

  <ul>
    <li>
      the user positions the pointing device over a glyph that has
      been rendered as part of a <a>'text'</a> element, initiates a
      <em>select</em> operation (e.g., pressing the standard system
      mouse button for select operations) and then moves the pointing
      device while continuing the <em>select</em> operation (e.g.,
      continuing to press the standard system mouse button for select
      operations)
    </li>

    <li>
      no other visible graphics element has been painted above the glyph
      at the point at which the pointing device was clicked
    </li>

    <li>
      no <a href="linking.html#Links">links</a> or
      <a href="script.html#EventHandling">events</a> have been
      assigned to the <a>'text'</a>, <a>'tspan'</a> or
      <a>'textPath'</a> element(s) (or their ancestors) associated
      with the given glyph.
    </li>
  </ul>

  <p>
    As the text selection operation proceeds (e.g., the user continues
    to press the given mouse button), all associated events with other
    graphics elements are ignored (i.e., the text selection operation
    is modal) and the SVG user agent shall dynamically indicate which
    characters are selected by an appropriate highlighting technique,
    such as redrawing the selected glyphs with inverse colors. As the
    pointer is moved during the text selection process, the end glyph
    for the text selection operation is the glyph within the
    same <a>'text'</a> element whose glyph cell is closest to the
    pointer. All characters within the <a>'text'</a> element whose
    position within the <a>'text'</a> element is between the start of
    selection and end of selection shall be highlighted, regardless of
    position on the canvas and regardless of any graphics elements
    that might be above the end of selection point.
  </p>

  <p>
    Once the text selection operation ends (e.g., the user releases
    the given mouse button), the selected text will stay highlighted
    until an event occurs which cancels text selection, such as a
    pointer device activation event (e.g., pressing a mouse button).
  </p>

  <p>
    Detailed rules for determining which characters to highlight
    during a text selection operation are provided in
    <a href="implnote.html#TextSelectionImplementationNotes">Text
      selection implementation notes</a>.
  </p>

  <p>
    For systems which have system clipboards, the SVG user agent is
    required to provide a user interface for initiating a copy of the
    currently selected text to the system clipboard. It is sufficient
    for the SVG user agent to post the selected text string in the
    system's appropriate clipboard format for plain text, but it is
    preferable if the SVG user agent also posts a rich text
    alternative which captures the various
    <a href="text.html#FontPropertiesUsedBySVG">font
    properties</a> associated with the given text string.
  </p>

  <p>
    For bidirectional text, the user agent must support text selection
    in logical order, which will result in discontinuous highlighting
    of glyphs due to the bidirectional reordering of characters. User
    agents can provide an alternative ability to select bidirectional
    text in visual rendering order (i.e., after
    <a href="text.html#RelationshipWithBiDirectionality">bidirectional</a>
    text layout algorithms have been applied), with the result that
    selected character data might be discontinuous logically. In this
    case, if the user requests that bidirectional text be copied to
    the clipboard, then the user agent is required to make appropriate
    adjustments to copy only the visually selected characters to the
    clipboard.
  </p>

  <p>
    When feasible, it is recommended that generators of SVG attempt to
    order their text strings to facilitate properly ordered text
    selection within SVG viewing applications such as Web browsers.
  </p>

<h2 id="DOMInterfaces">DOM interfaces</h2>

  <div class="annotation svg2-requirement">
    <table>
      <tr>
	<th>SVG 2 Requirement:</th>
	<td>Have a DOM method to convert a <a>'text'</a> element to outline path data.</td>
      </tr>
      <tr>
	<th>Resolution:</th>
	<td><a href="http://www.w3.org/2012/01/13-svg-irc#T05-07-07">We will add a DOM method to convert a <span class='element-name'>'text'</span> element to outline path data, possibly moving the functionality to the FXTF.</a></td>
      </tr>
      <tr>
	<th>Purpose:</th>
	<td>To allow manipualtion of text as a path.</td>
      </tr>
      <tr>
	<th>Owner:</th>
	<td>Cameron (<a href="http://www.w3.org/Graphics/SVG/WG/track/actions/3076">ACTION-3076</a>)</td>
      </tr>
    </table>
  </div>

<h3 id="InterfaceSVGTextContentElement">Interface SVGTextContentElement</h3>

  <p>
    The <a>SVGTextContentElement</a> is inherited by various
    text-related interfaces, such as <a>SVGTextElement</a>,
    <a>SVGTSpanElement</a>, <a>SVGTRefElement</a>, <a>SVGAltGlyphElement</a>
    and <a>SVGTextPathElement</a>.
  </p>

  <p>
    For the methods on this interface that refer to an index to a
    character or a number of characters, these references are to be
    interpreted as an index to a UTF-16 code unit or a number of
    UTF-16 code units, respectively.  This is for consistency with DOM
    Level 2 Core, where methods on the <a>CharacterData</a> interface
    use UTF-16 code units as indexes and counts within the character
    data. Thus for example, if the text content of a <a>'text'</a>
    element is a single non-BMP character, such as U+10000, then
    invoking <a>SVGTextContentElement::getNumberOfChars</a> on that
    element will return 2 since there are two UTF-16 code units (the
    surrogate pair) used to represent that one character.
  </p>

<pre class="idl">interface <b>SVGTextContentElement</b> : <a>SVGGraphicsElement</a> {

  // lengthAdjust Types
  const unsigned short <a href="text.html#__svg__SVGTextContentElement__LENGTHADJUST_UNKNOWN">LENGTHADJUST_UNKNOWN</a> = 0;
  const unsigned short <a href="text.html#__svg__SVGTextContentElement__LENGTHADJUST_SPACING">LENGTHADJUST_SPACING</a> = 1;
  const unsigned short <a href="text.html#__svg__SVGTextContentElement__LENGTHADJUST_SPACINGANDGLYPHS">LENGTHADJUST_SPACINGANDGLYPHS</a> = 2;

  readonly attribute <a class="idlinterface" href="types.html#InterfaceSVGAnimatedLength">SVGAnimatedLength</a> <a href="text.html#__svg__SVGTextContentElement__textLength">textLength</a>;
  readonly attribute <a class="idlinterface" href="types.html#InterfaceSVGAnimatedEnumeration">SVGAnimatedEnumeration</a> <a href="text.html#__svg__SVGTextContentElement__lengthAdjust">lengthAdjust</a>;

  long <a href="text.html#__svg__SVGTextContentElement__getNumberOfChars">getNumberOfChars</a>();
  float <a href="text.html#__svg__SVGTextContentElement__getComputedTextLength">getComputedTextLength</a>();
  float <a href="text.html#__svg__SVGTextContentElement__getSubStringLength">getSubStringLength</a>(unsigned long charnum, unsigned long nchars);
  <a>DOMPoint</a> <a href="text.html#__svg__SVGTextContentElement__getStartPositionOfChar">getStartPositionOfChar</a>(unsigned long charnum);
  <a>DOMPoint</a> <a href="text.html#__svg__SVGTextContentElement__getEndPositionOfChar">getEndPositionOfChar</a>(unsigned long charnum);
  <a class="idlinterface" href="types.html#InterfaceSVGRect">SVGRect</a> <a href="text.html#__svg__SVGTextContentElement__getExtentOfChar">getExtentOfChar</a>(unsigned long charnum);
  float <a href="text.html#__svg__SVGTextContentElement__getRotationOfChar">getRotationOfChar</a>(unsigned long charnum);
  long <a href="text.html#__svg__SVGTextContentElement__getCharNumAtPosition">getCharNumAtPosition</a>(<a>DOMPoint</a> point);
  void <a href="text.html#__svg__SVGTextContentElement__selectSubString">selectSubString</a>(unsigned long charnum, unsigned long nchars);
};</pre>

<dl class="interface">
<dt class="constants-header">Constants in group “lengthAdjust Types”:</dt>
<dd>
<dl class="constants">

<dt id="__svg__SVGTextContentElement__LENGTHADJUST_UNKNOWN"
    class="constant first-child"><b>LENGTHADJUST_UNKNOWN</b><span class="idl-type-parenthetical"> (unsigned short)</span></dt>
<dd class="constant">
<div>
The enumeration was set to a value that is not one of predefined types.
It is invalid to attempt to define a new value of this type or to
attempt to switch an existing value to this type.


</div>
</dd>

<dt id="__svg__SVGTextContentElement__LENGTHADJUST_SPACING" class="constant"><b>LENGTHADJUST_SPACING</b><span class="idl-type-parenthetical"> (unsigned short)</span></dt>
<dd class="constant">
<div>
Corresponds to value <span class="attr-value">'spacing'</span>.


</div>
</dd>

<dt id="__svg__SVGTextContentElement__LENGTHADJUST_SPACINGANDGLYPHS"
    class="constant"><b>LENGTHADJUST_SPACINGANDGLYPHS</b><span class="idl-type-parenthetical"> (unsigned short)</span></dt>
<dd class="constant">
<div>
Corresponds to value <span class="attr-value">'spacingAndGlyphs'</span>.


</div>
</dd>
</dl>
</dd>
<dt class="attributes-header">Attributes:</dt>
<dd>
<dl class="attributes">

<dt id="__svg__SVGTextContentElement__textLength" class="attribute first-child"><b>textLength</b><span class="idl-type-parenthetical"> (readonly <a class="idlinterface" href="types.html#InterfaceSVGAnimatedLength">SVGAnimatedLength</a>)</span></dt>
<dd class="attribute">
<div>
Corresponds to attribute <span class="attr-name">'textLength'</span> on
the given element.

</div>
</dd>

<dt id="__svg__SVGTextContentElement__lengthAdjust" class="attribute"><b>lengthAdjust</b><span class="idl-type-parenthetical"> (readonly <a class="idlinterface" href="types.html#InterfaceSVGAnimatedEnumeration">SVGAnimatedEnumeration</a>)</span></dt>
<dd class="attribute">
<div>
Corresponds to attribute <span class="attr-name">'lengthAdjust'</span> on
the given element.  The value must be one of the length adjust constants
defined on this interface.

</div>
</dd>
</dl>
</dd>
<dt class="operations-header">Operations:</dt>
<dd>
<dl class="attributes">

<dt id="__svg__SVGTextContentElement__getNumberOfChars"
    class="operation first-child">long <b>getNumberOfChars</b>()
</dt>
<dd class="operation">
<div>
Returns the total number of characters available for rendering within
the current element, which includes referenced characters from
<a>'tref'</a> reference, regardless of whether they will be rendered.
Effectively, this is equivalent to the length of the
<a href="http://www.w3.org/TR/dom/#dom-node-textcontent">Node::textContent</a>
attribute from DOM4 ([<a href="refs.html#ref-DOM4">DOM4</a>],
section 5.4), if that attribute also expanded <a>'tref'</a>
elements.


</div>
<dl class="operation">
<dt class="returns-header">Returns</dt>
<dd>
<div> Total number of characters.

</div>
</dd>
</dl>
</dd>

<dt id="__svg__SVGTextContentElement__getComputedTextLength" class="operation">float <b>getComputedTextLength</b>()
</dt>
<dd class="operation">
<div>
The total sum of all of the advance values from rendering all of the
characters within this element, including the advance value on the
glyphs (horizontal or vertical), the effect of properties
<a>'letter-spacing'</a> and <a>'word-spacing'</a> and
adjustments due to attributes <a>'tspan/dx'</a> and <a>'tspan/dy'</a> on
<a>'tspan'</a> elements. For non-rendering environments, the user agent
shall make reasonable assumptions about glyph metrics. 


</div>
<dl class="operation">
<dt class="returns-header">Returns</dt>
<dd>
<div> The text advance distance.

</div>
</dd>
</dl>
</dd>

<dt id="__svg__SVGTextContentElement__getSubStringLength" class="operation">float <b>getSubStringLength</b>(unsigned long <var>charnum</var>, unsigned long <var>nchars</var>)
</dt>
<dd class="operation">
<div>
The total sum of all of the advance values from rendering the specified 
substring of the characters, including the advance value on the glyphs 
(horizontal or vertical), the effect of properties
<a>'letter-spacing'</a> and <a>'word-spacing'</a> and adjustments due to 
attributes <a>'tspan/dx'</a> and <a>'tspan/dy'</a> on <a>'tspan'</a> elements. For 
non-rendering environments, the user agent shall make reasonable 
assumptions about glyph metrics.  If multiple consecutive characters are 
rendered inseparably (e.g., as a single glyph or a sequence of glyphs, 
or because the range encompasses half of a surrogate pair), and nchars 
is greater than 0 then the measured range shall be expanded so that each 
of the inseparable characters are included. 


</div>
<dl class="operation">
<dt class="parameters-header">Parameters</dt>
<dd>
<ol class="parameters">
<li class="parameter first-child">
<div>unsigned long <var>charnum</var></div> 
<div> The index of the first character in the substring, where
the first character has an index of 0.

</div>
</li>
<li class="parameter">
<div>unsigned long <var>nchars</var></div> 
<div> The number of characters in the substring. If nchars 
specifies more characters than are available, then the substring will 
consist of all characters starting with charnum until the end of the 
list of characters.

</div>
</li>
</ol>
</dd>
<dt class="returns-header">Returns</dt>
<dd>
<div> The text advance distance.

</div>
</dd>
<dt class="exceptions-header">Exceptions</dt>
<dd>
<dl class="exceptions">
<dt class="exception first-child"><a class="idlinterface"
   href="http://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-17189187">DOMException</a>, code INDEX_SIZE_ERR
</dt>
<dd class="exception"> Raised if <var>charnum</var> or 
<var>nchars</var> is negative or if <var>charnum</var> is greater than 
or equal to the number of characters at this node.

</dd>
</dl>
</dd>
</dl>
</dd>

<dt id="__svg__SVGTextContentElement__getStartPositionOfChar" class="operation"><a>DOMPoint</a> <b>getStartPositionOfChar</b>(unsigned long <var>charnum</var>)
</dt>
<dd class="operation">
<div>
Returns the current text position before rendering the character in the
user coordinate system for rendering the glyph(s) that correspond to
the specified character. The current text position has already taken
into account the effects of any inter-character adjustments due to
properties <a>'letter-spacing'</a> and
<a>'word-spacing'</a> and adjustments due to attributes
<span class="attr-name">'x'</span>, <span class="attr-name">'y'</span>,
<span class="attr-name">'dx'</span> and
<span class="attr-name">'dy'</span>. If multiple consecutive characters
are rendered inseparably (e.g., as a single glyph or a sequence of
glyphs), then each of the inseparable characters will return the start
position for the first glyph. 


</div>
<dl class="operation">
<dt class="parameters-header">Parameters</dt>
<dd>
<ol class="parameters">
<li class="parameter first-child">
<div>unsigned long <var>charnum</var></div> 
<div> The index of the character, where the first character has
an index of 0.

</div>
</li>
</ol>
</dd>
<dt class="returns-header">Returns</dt>
<dd>
<div> The character's start position.

</div>
</dd>
<dt class="exceptions-header">Exceptions</dt>
<dd>
<dl class="exceptions">
<dt class="exception first-child"><a class="idlinterface"
   href="http://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-17189187">DOMException</a>, code INDEX_SIZE_ERR
</dt>
<dd class="exception"> Raised if the <var>charnum</var> is
negative or if <var>charnum</var> is greater than or equal to the
number of characters at this node.

</dd>
</dl>
</dd>
</dl>
</dd>

<dt id="__svg__SVGTextContentElement__getEndPositionOfChar" class="operation"><a>DOMPoint</a> <b>getEndPositionOfChar</b>(unsigned long <var>charnum</var>)
</dt>
<dd class="operation">
<div>
Returns the current text position after rendering the character in the
user coordinate system for rendering the glyph(s) that correspond to
the specified character. This current text position does <em>not</em> take into
account the effects of any inter-character adjustments to prepare for
the next character, such as properties
<a>'letter-spacing'</a> and <a>'word-spacing'</a> and adjustments due to
attributes <span class="attr-name">'x'</span>,
<span class="attr-name">'y'</span>, <span class="attr-name">'dx'</span>
and <span class="attr-name">'dy'</span>. If multiple consecutive
characters are rendered inseparably (e.g., as a single glyph or a
sequence of glyphs), then each of the inseparable characters will
return the end position for the last glyph. 


</div>
<dl class="operation">
<dt class="parameters-header">Parameters</dt>
<dd>
<ol class="parameters">
<li class="parameter first-child">
<div>unsigned long <var>charnum</var></div> 
<div> The index of the character, where the first character has
an index of 0.

</div>
</li>
</ol>
</dd>
<dt class="returns-header">Returns</dt>
<dd>
<div> The character's end position.

</div>
</dd>
<dt class="exceptions-header">Exceptions</dt>
<dd>
<dl class="exceptions">
<dt class="exception first-child"><a class="idlinterface"
   href="http://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-17189187">DOMException</a>, code INDEX_SIZE_ERR
</dt>
<dd class="exception"> Raised if the <var>charnum</var> is
negative or if <var>charnum</var> is greater than or equal to the
number of characters at this node.

</dd>
</dl>
</dd>
</dl>
</dd>

<dt id="__svg__SVGTextContentElement__getExtentOfChar" class="operation"><a class="idlinterface" href="types.html#InterfaceSVGRect">SVGRect</a> <b>getExtentOfChar</b>(unsigned long <var>charnum</var>)
</dt>
<dd class="operation">
<div>
Returns a tightest rectangle which defines the minimum and maximum X and
Y values in the user coordinate system for rendering the glyph(s) that
correspond to the specified character. The calculations assume that all
glyphs occupy the full standard glyph cell for the font. If multiple
consecutive characters are rendered inseparably (e.g., as a single glyph
or a sequence of glyphs), then each of the inseparable characters will
return the same extent.


</div>
<dl class="operation">
<dt class="parameters-header">Parameters</dt>
<dd>
<ol class="parameters">
<li class="parameter first-child">
<div>unsigned long <var>charnum</var></div> 
<div> The index of the character, where the first character has
an index of 0.

</div>
</li>
</ol>
</dd>
<dt class="returns-header">Returns</dt>
<dd>
<div> The rectangle which encloses all of the rendered glyph(s).

</div>
</dd>
<dt class="exceptions-header">Exceptions</dt>
<dd>
<dl class="exceptions">
<dt class="exception first-child"><a class="idlinterface"
   href="http://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-17189187">DOMException</a>, code INDEX_SIZE_ERR
</dt>
<dd class="exception"> Raised if the <var>charnum</var> is
negative or if <var>charnum</var> is greater than or equal to the
number of characters at this node.

</dd>
</dl>
</dd>
</dl>
</dd>

<dt id="__svg__SVGTextContentElement__getRotationOfChar" class="operation">float <b>getRotationOfChar</b>(unsigned long <var>charnum</var>)
</dt>
<dd class="operation">
<div>
Returns the rotation value relative to the current user coordinate
system used to render the glyph(s) corresponding to the specified
character. If multiple glyph(s) are used to render the given character
and the glyphs each have different rotations (e.g., due to
text-on-a-path), the user agent shall return an average value (e.g., the
rotation angle at the midpoint along the path for all glyphs used to
render this character). The rotation value represents the rotation that
is supplemental to any rotation due to properties
<a>'glyph-orientation-horizontal'</a> and
<a>'glyph-orientation-vertical'</a>; thus, any glyph rotations due to
these properties are not included into the returned rotation value. If
multiple consecutive characters are rendered inseparably (e.g., as a
single glyph or a sequence of glyphs), then each of the inseparable
characters will return the same rotation value. 


</div>
<dl class="operation">
<dt class="parameters-header">Parameters</dt>
<dd>
<ol class="parameters">
<li class="parameter first-child">
<div>unsigned long <var>charnum</var></div> 
<div> The index of the character, where the first character has
an index of 0.

</div>
</li>
</ol>
</dd>
<dt class="returns-header">Returns</dt>
<dd>
<div> The rotation angle.

</div>
</dd>
<dt class="exceptions-header">Exceptions</dt>
<dd>
<dl class="exceptions">
<dt class="exception first-child"><a class="idlinterface"
   href="http://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-17189187">DOMException</a>, code INDEX_SIZE_ERR
</dt>
<dd class="exception"> Raised if the <var>charnum</var> is
negative or if <var>charnum</var> is greater than or equal to the
number of characters at this node.

</dd>
</dl>
</dd>
</dl>
</dd>

<dt id="__svg__SVGTextContentElement__getCharNumAtPosition" class="operation">long <b>getCharNumAtPosition</b>(<a>DOMPoint</a> <var>point</var>)
</dt>
<dd class="operation">
<div>
Returns the index of the character whose corresponding glyph cell
bounding box contains the specified point. The calculations assume that
all glyphs occupy the full standard glyph cell for the font. If no such
character exists, a value of -1 is returned. If multiple such
characters exist, the character within the element whose glyphs were
rendered last (i.e., take into account any reordering such as for
bidirectional text) is used. If multiple consecutive characters are
rendered inseparably (e.g., as a single glyph or a sequence of glyphs),
then the user agent shall allocate an equal percentage of the text
advance amount to each of the contributing characters in determining
which of the characters is chosen. 


</div>
<dl class="operation">
<dt class="parameters-header">Parameters</dt>
<dd>
<ol class="parameters">
<li class="parameter first-child">
<div><a>DOMPoint</a> <var>point</var></div> 
<div> A point in user space.

</div>
</li>
</ol>
</dd>
<dt class="returns-header">Returns</dt>
<dd>
<div> The index of the character which is at the given point, where
the first character has an index of 0.

</div>
</dd>
</dl>
</dd>

<dt id="__svg__SVGTextContentElement__selectSubString" class="operation">void <b>selectSubString</b>(unsigned long <var>charnum</var>, unsigned long <var>nchars</var>)
</dt>
<dd class="operation">
<div>
Causes the specified substring to be selected just as if the user 
selected the substring interactively. 


</div>
<dl class="operation">
<dt class="parameters-header">Parameters</dt>
<dd>
<ol class="parameters">
<li class="parameter first-child">
<div>unsigned long <var>charnum</var></div> 
<div> The index of the start character which is at the given 
point, where the first character has an index of 0.

</div>
</li>
<li class="parameter">
<div>unsigned long <var>nchars</var></div> 
<div> The number of characters in the substring. If nchars 
specifies more characters than are available, then the substring 
will consist of all characters starting with charnum until the end 
of the list of characters.

</div>
</li>
</ol>
</dd>
<dt class="exceptions-header">Exceptions</dt>
<dd>
<dl class="exceptions">
<dt class="exception first-child"><a class="idlinterface"
   href="http://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-17189187">DOMException</a>, code INDEX_SIZE_ERR
</dt>
<dd class="exception"> Raised if <var>charnum</var> or 
<var>nchars</var> is negative or if <var>charnum</var> is greater 
than or equal to the number of characters at this node. 

</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>


<h3 id="InterfaceSVGTextPositioningElement">Interface SVGTextPositioningElement</h3>


The <a>SVGTextPositioningElement</a> interface is inherited by text-related
interfaces: <a>SVGTextElement</a>, <a>SVGTSpanElement</a>,
<a>SVGTRefElement</a> and <a>SVGAltGlyphElement</a>.
<pre class="idl">interface <b>SVGTextPositioningElement</b> : <a>SVGTextContentElement</a> {
  readonly attribute <a class="idlinterface" href="types.html#InterfaceSVGAnimatedLengthList">SVGAnimatedLengthList</a> <a href="text.html#__svg__SVGTextPositioningElement__x">x</a>;
  readonly attribute <a class="idlinterface" href="types.html#InterfaceSVGAnimatedLengthList">SVGAnimatedLengthList</a> <a href="text.html#__svg__SVGTextPositioningElement__y">y</a>;
  readonly attribute <a class="idlinterface" href="types.html#InterfaceSVGAnimatedLengthList">SVGAnimatedLengthList</a> <a href="text.html#__svg__SVGTextPositioningElement__dx">dx</a>;
  readonly attribute <a class="idlinterface" href="types.html#InterfaceSVGAnimatedLengthList">SVGAnimatedLengthList</a> <a href="text.html#__svg__SVGTextPositioningElement__dy">dy</a>;
  readonly attribute <a class="idlinterface" href="types.html#InterfaceSVGAnimatedNumberList">SVGAnimatedNumberList</a> <a href="text.html#__svg__SVGTextPositioningElement__rotate">rotate</a>;
};</pre><dl class="interface">
<dt class="attributes-header">Attributes:</dt>
<dd>
<dl class="attributes">

<dt id="__svg__SVGTextPositioningElement__x" class="attribute first-child"><b>x</b><span class="idl-type-parenthetical"> (readonly <a class="idlinterface" href="types.html#InterfaceSVGAnimatedLengthList">SVGAnimatedLengthList</a>)</span></dt>
<dd class="attribute">
<div>
Corresponds to attribute <span class="attr-name">'x'</span> on the
given element.

</div>
</dd>

<dt id="__svg__SVGTextPositioningElement__y" class="attribute"><b>y</b><span class="idl-type-parenthetical"> (readonly <a class="idlinterface" href="types.html#InterfaceSVGAnimatedLengthList">SVGAnimatedLengthList</a>)</span></dt>
<dd class="attribute">
<div>
Corresponds to attribute <span class="attr-name">'y'</span> on the
given element.

</div>
</dd>

<dt id="__svg__SVGTextPositioningElement__dx" class="attribute"><b>dx</b><span class="idl-type-parenthetical"> (readonly <a class="idlinterface" href="types.html#InterfaceSVGAnimatedLengthList">SVGAnimatedLengthList</a>)</span></dt>
<dd class="attribute">
<div>
Corresponds to attribute <span class="attr-name">'dx'</span> on the
given element.

</div>
</dd>

<dt id="__svg__SVGTextPositioningElement__dy" class="attribute"><b>dy</b><span class="idl-type-parenthetical"> (readonly <a class="idlinterface" href="types.html#InterfaceSVGAnimatedLengthList">SVGAnimatedLengthList</a>)</span></dt>
<dd class="attribute">
<div>
Corresponds to attribute <span class="attr-name">'dy'</span> on the
given element.

</div>
</dd>

<dt id="__svg__SVGTextPositioningElement__rotate" class="attribute"><b>rotate</b><span class="idl-type-parenthetical"> (readonly <a class="idlinterface" href="types.html#InterfaceSVGAnimatedNumberList">SVGAnimatedNumberList</a>)</span></dt>
<dd class="attribute">
<div>
Corresponds to attribute <span class="attr-name">'rotate'</span> on the
given element.

</div>
</dd>
</dl>
</dd>
</dl>


<h3 id="InterfaceSVGTextElement">Interface SVGTextElement</h3>


<edit:with element='text'>

The <a>SVGTextElement</a> interface corresponds to the <a>'text'</a>
element.
<pre class="idl">interface <b>SVGTextElement</b> : <a>SVGTextPositioningElement</a> {
};</pre>

</edit:with>

<h3 id="InterfaceSVGTSpanElement">Interface SVGTSpanElement</h3>


<edit:with element='tspan'>

The <a>SVGTSpanElement</a> interface corresponds to the <a>'tspan'</a>
element.
<pre class="idl">interface <b>SVGTSpanElement</b> : <a>SVGTextPositioningElement</a> {
};</pre>

</edit:with>

<h3 id="InterfaceSVGTRefElement">Interface SVGTRefElement</h3>


<edit:with element='tref'>

The <a>SVGTRefElement</a> interface corresponds to the <a>'tref'</a>
element.
<pre class="idl">interface <b>SVGTRefElement</b> : <a>SVGTextPositioningElement</a> {
};

<a>SVGTRefElement</a> implements <a>SVGURIReference</a>;</pre>

</edit:with>

<h3 id="InterfaceSVGTextPathElement">Interface SVGTextPathElement</h3>


<edit:with element='textPath'>

The <a>SVGTextPathElement</a> interface corresponds to the <a>'textPath'</a>
element.
<pre class="idl">interface <b>SVGTextPathElement</b> : <a>SVGTextContentElement</a> {

  // textPath Method Types
  const unsigned short <a href="text.html#__svg__SVGTextPathElement__TEXTPATH_METHODTYPE_UNKNOWN">TEXTPATH_METHODTYPE_UNKNOWN</a> = 0;
  const unsigned short <a href="text.html#__svg__SVGTextPathElement__TEXTPATH_METHODTYPE_ALIGN">TEXTPATH_METHODTYPE_ALIGN</a> = 1;
  const unsigned short <a href="text.html#__svg__SVGTextPathElement__TEXTPATH_METHODTYPE_STRETCH">TEXTPATH_METHODTYPE_STRETCH</a> = 2;

  // textPath Spacing Types
  const unsigned short <a href="text.html#__svg__SVGTextPathElement__TEXTPATH_SPACINGTYPE_UNKNOWN">TEXTPATH_SPACINGTYPE_UNKNOWN</a> = 0;
  const unsigned short <a href="text.html#__svg__SVGTextPathElement__TEXTPATH_SPACINGTYPE_AUTO">TEXTPATH_SPACINGTYPE_AUTO</a> = 1;
  const unsigned short <a href="text.html#__svg__SVGTextPathElement__TEXTPATH_SPACINGTYPE_EXACT">TEXTPATH_SPACINGTYPE_EXACT</a> = 2;

  readonly attribute <a class="idlinterface" href="types.html#InterfaceSVGAnimatedLength">SVGAnimatedLength</a> <a href="text.html#__svg__SVGTextPathElement__startOffset">startOffset</a>;
  readonly attribute <a class="idlinterface" href="types.html#InterfaceSVGAnimatedEnumeration">SVGAnimatedEnumeration</a> <a href="text.html#__svg__SVGTextPathElement__method">method</a>;
  readonly attribute <a class="idlinterface" href="types.html#InterfaceSVGAnimatedEnumeration">SVGAnimatedEnumeration</a> <a href="text.html#__svg__SVGTextPathElement__spacing">spacing</a>;
};

<a>SVGTextPathElement</a> implements <a>SVGURIReference</a>;
<a>SVGTextPathElement</a> implements <a>SVGAnimatedPathData</a>;</pre>

<dl class="interface">
<dt class="constants-header">Constants in group “textPath Method Types”:</dt>
<dd>
<dl class="constants">

<dt id="__svg__SVGTextPathElement__TEXTPATH_METHODTYPE_UNKNOWN"
    class="constant first-child"><b>TEXTPATH_METHODTYPE_UNKNOWN</b><span class="idl-type-parenthetical"> (unsigned short)</span></dt>
<dd class="constant">
<div>
The enumeration was set to a value that is not one of predefined types.
It is invalid to attempt to define a new value of this type or to
attempt to switch an existing value to this type.


</div>
</dd>

<dt id="__svg__SVGTextPathElement__TEXTPATH_METHODTYPE_ALIGN" class="constant"><b>TEXTPATH_METHODTYPE_ALIGN</b><span class="idl-type-parenthetical"> (unsigned short)</span></dt>
<dd class="constant">
<div>
Corresponds to value <span class="attr-value">'align'</span>.


</div>
</dd>

<dt id="__svg__SVGTextPathElement__TEXTPATH_METHODTYPE_STRETCH" class="constant"><b>TEXTPATH_METHODTYPE_STRETCH</b><span class="idl-type-parenthetical"> (unsigned short)</span></dt>
<dd class="constant">
<div>
Corresponds to value <span class="attr-value">'stretch'</span>.


</div>
</dd>
</dl>
</dd>
<dt class="constants-header">Constants in group “textPath Spacing Types”:</dt>
<dd>
<dl class="constants">

<dt id="__svg__SVGTextPathElement__TEXTPATH_SPACINGTYPE_UNKNOWN"
    class="constant first-child"><b>TEXTPATH_SPACINGTYPE_UNKNOWN</b><span class="idl-type-parenthetical"> (unsigned short)</span></dt>
<dd class="constant">
<div>
The enumeration was set to a value that is not one of predefined types.
It is invalid to attempt to define a new value of this type or to
attempt to switch an existing value to this type.


</div>
</dd>

<dt id="__svg__SVGTextPathElement__TEXTPATH_SPACINGTYPE_AUTO" class="constant"><b>TEXTPATH_SPACINGTYPE_AUTO</b><span class="idl-type-parenthetical"> (unsigned short)</span></dt>
<dd class="constant">
<div>
Corresponds to value <span class="attr-value">'auto'</span>.


</div>
</dd>

<dt id="__svg__SVGTextPathElement__TEXTPATH_SPACINGTYPE_EXACT" class="constant"><b>TEXTPATH_SPACINGTYPE_EXACT</b><span class="idl-type-parenthetical"> (unsigned short)</span></dt>
<dd class="constant">
<div>
Corresponds to value <span class="attr-value">'exact'</span>.


</div>
</dd>
</dl>
</dd>
<dt class="attributes-header">Attributes:</dt>
<dd>
<dl class="attributes">

<dt id="__svg__SVGTextPathElement__startOffset" class="attribute first-child"><b>startOffset</b><span class="idl-type-parenthetical"> (readonly <a class="idlinterface" href="types.html#InterfaceSVGAnimatedLength">SVGAnimatedLength</a>)</span></dt>
<dd class="attribute">
<div>
Corresponds to attribute <a>'startOffset'</a> on the given
<a>'textPath'</a> element.

</div>
</dd>

<dt id="__svg__SVGTextPathElement__method" class="attribute"><b>method</b><span class="idl-type-parenthetical"> (readonly <a class="idlinterface" href="types.html#InterfaceSVGAnimatedEnumeration">SVGAnimatedEnumeration</a>)</span></dt>
<dd class="attribute">
<div>
Corresponds to attribute <a>'method'</a> on the given
<a>'textPath'</a> element.

</div>
</dd>

<dt id="__svg__SVGTextPathElement__spacing" class="attribute"><b>spacing</b><span class="idl-type-parenthetical"> (readonly <a class="idlinterface" href="types.html#InterfaceSVGAnimatedEnumeration">SVGAnimatedEnumeration</a>)</span></dt>
<dd class="attribute">
<div>
Corresponds to attribute <a>'spacing'</a> on the given
<a>'textPath'</a> element.

</div>
</dd>
</dl>
</dd>
</dl>

</edit:with>


<h3 id="InterfaceSVGAltGlyphElement">Interface SVGAltGlyphElement</h3>


<edit:with element='altGlyph'>

<p>The <a>SVGAltGlyphElement</a> interface corresponds to the <a>'altGlyph'</a> element.</p>

<pre class="idl">interface <b>SVGAltGlyphElement</b> : <a>SVGTextPositioningElement</a> {
  attribute DOMString <a href="text.html#__svg__SVGAltGlyphElement__glyphRef">glyphRef</a>;
  attribute DOMString <a href="text.html#__svg__SVGAltGlyphElement__format">format</a>;
};

<a>SVGAltGlyphElement</a> implements <a>SVGURIReference</a>;</pre>

<dl class="interface">
<dt class="attributes-header">Attributes:</dt>
<dd>
<dl class="attributes">

<dt id="__svg__SVGAltGlyphElement__glyphRef" class="attribute first-child"><b>glyphRef</b><span class="idl-type-parenthetical"> (DOMString)</span></dt>
<dd class="attribute">
<div>
Corresponds to attribute <a>'glyphRef attribute'</a> on the given
element.


</div>
</dd>

<dt id="__svg__SVGAltGlyphElement__format" class="attribute"><b>format</b><span class="idl-type-parenthetical"> (DOMString)</span></dt>
<dd class="attribute">
<div>
Corresponds to attribute <a>'format'</a> on the given element.


</div>
</dd>
</dl>
</dd>
</dl>

</edit:with>


<h3 id="InterfaceSVGAltGlyphDefElement">Interface SVGAltGlyphDefElement</h3>


<edit:with element='altGlyphDef'>

The <a>SVGAltGlyphDefElement</a> interface corresponds to the
<a>'altGlyphDef'</a> element.
<pre class="idl">interface <b>SVGAltGlyphDefElement</b> : <a>SVGElement</a> {
};</pre>

</edit:with>

<h3 id="InterfaceSVGAltGlyphItemElement">Interface SVGAltGlyphItemElement</h3>


<edit:with element='altGlyphItem'>

The <a>SVGAltGlyphItemElement</a> interface corresponds to the
<a>'altGlyphItem'</a> element.
<pre class="idl">interface <b>SVGAltGlyphItemElement</b> : <a>SVGElement</a> {
};</pre>

</edit:with>

<h3 id="InterfaceSVGGlyphRefElement">Interface SVGGlyphRefElement</h3>


<edit:with element='glyphRef'>

<p>The <a>SVGGlyphRefElement</a> interface corresponds to the <a>'glyphRef element'</a> element.</p>

<pre class="idl">interface <b>SVGGlyphRefElement</b> : <a>SVGElement</a> {
  attribute DOMString <a href="text.html#__svg__SVGGlyphRefElement__glyphRef">glyphRef</a>;
  attribute DOMString <a href="text.html#__svg__SVGGlyphRefElement__format">format</a>;
  attribute float <a href="text.html#__svg__SVGGlyphRefElement__x">x</a>;
  attribute float <a href="text.html#__svg__SVGGlyphRefElement__y">y</a>;
  attribute float <a href="text.html#__svg__SVGGlyphRefElement__dx">dx</a>;
  attribute float <a href="text.html#__svg__SVGGlyphRefElement__dy">dy</a>;
};</pre>

<dl class="interface">
<dt class="attributes-header">Attributes:</dt>
<dd>
<dl class="attributes">

<dt id="__svg__SVGGlyphRefElement__glyphRef" class="attribute first-child"><b>glyphRef</b><span class="idl-type-parenthetical"> (DOMString)</span></dt>
<dd class="attribute">
<div>
Corresponds to attribute <a>'glyphRef attribute'</a> on the given
element.


</div>
</dd>

<dt id="__svg__SVGGlyphRefElement__format" class="attribute"><b>format</b><span class="idl-type-parenthetical"> (DOMString)</span></dt>
<dd class="attribute">
<div>
Corresponds to attribute <a>'format'</a> on the given element.


</div>
</dd>

<dt id="__svg__SVGGlyphRefElement__x" class="attribute"><b>x</b><span class="idl-type-parenthetical"> (float)</span></dt>
<dd class="attribute">
<div>
Corresponds to attribute <a>'x'</a> on the given element.


</div>
</dd>

<dt id="__svg__SVGGlyphRefElement__y" class="attribute"><b>y</b><span class="idl-type-parenthetical"> (float)</span></dt>
<dd class="attribute">
<div>
Corresponds to attribute <a>'y'</a> on the given element.


</div>
</dd>

<dt id="__svg__SVGGlyphRefElement__dx" class="attribute"><b>dx</b><span class="idl-type-parenthetical"> (float)</span></dt>
<dd class="attribute">
<div>
Corresponds to attribute <a>'dx'</a> on the given element.


</div>
</dd>

<dt id="__svg__SVGGlyphRefElement__dy" class="attribute"><b>dy</b><span class="idl-type-parenthetical"> (float)</span></dt>
<dd class="attribute">
<div>
Corresponds to attribute <a>'dy'</a> on the given element.


</div>
</dd>
</dl>
</dd>
</dl>

</edit:with>

</body>
</html>
